/*! dynamics-web-api v1.1.3 (c) 2017 Aleksandr Rogov */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.DynamicsWebApi=t():e.DynamicsWebApi=t()}(this,function(){return function(e){function t(a){if(r[a])return r[a].exports;var n=r[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,a){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=9)}([function(e,t){var r={Types:{ResponseBase:function(){this.oDataContext=""},Response:function(){r.Types.ResponseBase.call(this),this.value={}},ReferenceResponse:function(){r.Types.ResponseBase.call(this),this.id="",this.collection=""},MultipleResponse:function(){r.Types.ResponseBase.call(this),this.oDataNextLink="",this.oDataCount=0,this.value=[]},FetchXmlResponse:function(){r.Types.ResponseBase.call(this),this.value=[],this.PagingInfo={cookie:"",page:0,nextPage:1}}},Prefer:{ReturnRepresentation:"return=representation",Annotations:{AssociatedNavigationProperty:"Microsoft.Dynamics.CRM.associatednavigationproperty",LookupLogicalName:"Microsoft.Dynamics.CRM.lookuplogicalname",All:"*",FormattedValue:"OData.Community.Display.V1.FormattedValue",FetchXmlPagingCookie:"Microsoft.Dynamics.CRM.fetchxmlpagingcookie"}}};e.exports=r},function(e,t){function r(e,t,r){throw new Error(r?e+" requires the "+t+" parameter is a "+r:e+" requires the "+t+" parameter.")}var a={errorHandler:function(e){return new Error("Error : "+e.status+": "+e.message)},parameterCheck:function(e,t,a,n){void 0!==e&&null!==e&&""!=e||r(t,a,n)},stringParameterCheck:function(e,t,a){"string"!=typeof e&&r(t,a,"String")},arrayParameterCheck:function(e,t,a){e.constructor!==Array&&r(t,a,"Array")},numberParameterCheck:function(e,t,a){"number"!=typeof e&&r(t,a,"Number")},boolParameterCheck:function(e,t,a){"boolean"!=typeof e&&r(t,a,"Boolean")},guidParameterCheck:function(e,t,a){try{return/[0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12}/i.exec(e)[0]}catch(e){r(t,a,"GUID String")}},callbackParameterCheck:function(e,t,a){"function"!=typeof e&&r(t,a,"Function")}};e.exports=a},function(e,t){String.prototype.endsWith=function(e,t){var r=this.toString();("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>r.length)&&(t=r.length),t-=e.length;var a=r.lastIndexOf(e,t);return a!==-1&&a===t},String.prototype.startsWith=function(e,t){return t=t||0,this.substr(t,e.length)===e}},function(e,t,r){var a=r(6),n=r(7),i=function(e,t,r,i,s,c){var o=new XMLHttpRequest;if(o.open(e,encodeURI(t),!0),o.setRequestHeader("OData-MaxVersion","4.0"),o.setRequestHeader("OData-Version","4.0"),o.setRequestHeader("Accept","application/json"),o.setRequestHeader("Content-Type","application/json; charset=utf-8"),null!=i)for(var u in i)o.setRequestHeader(u,i[u]);o.onreadystatechange=function(){if(4===o.readyState){switch(o.status){case 200:case 201:case 204:case 304:var e=null;o.responseText&&(e=JSON.parse(o.responseText,a));s({data:e,headers:n(o.getAllResponseHeaders()),status:o.status});break;default:var t;try{t=JSON.parse(o.response).error}catch(e){t=new Error("Unexpected Error")}t.status=o.status,c(t)}o=null}},o.onerror=function(){c({message:"Network Error"}),o=null},o.ontimeout=function(e){c({message:"Request Timed Out"}),o=null},r?o.send(r):o.send()};e.exports=i},function(e,t,r){function a(e,t,r,n){var c={},o=[];if(n=null!=n?n:"&",e){if(e.navigationProperty&&(s.stringParameterCheck(e.navigationProperty,"DynamicsWebApi."+t,"request.navigationProperty"),r+="/"+e.navigationProperty),null!=e.select&&e.select.length&&(s.arrayParameterCheck(e.select,"DynamicsWebApi."+t,"request.select"),"retrieve"==t&&1==e.select.length&&e.select[0].endsWith("/$ref")?r+="/"+e.select[0]:(e.select[0].startsWith("/")&&"retrieve"==t&&(null==e.navigationProperty?r+=e.select.shift():e.select.shift()),e.select.length&&o.push("$select="+e.select.join(",")))),e.filter&&(s.stringParameterCheck(e.filter,"DynamicsWebApi."+t,"request.filter"),o.push("$filter="+e.filter)),e.savedQuery&&o.push("savedQuery="+s.guidParameterCheck(e.savedQuery,"DynamicsWebApi."+t,"request.savedQuery")),e.userQuery&&o.push("userQuery="+s.guidParameterCheck(e.userQuery,"DynamicsWebApi."+t,"request.userQuery")),e.maxPageSize&&e.maxPageSize>0&&(s.numberParameterCheck(e.maxPageSize,"DynamicsWebApi."+t,"request.maxPageSize"),c.Prefer="odata.maxpagesize="+e.maxPageSize),e.count&&(s.boolParameterCheck(e.count,"DynamicsWebApi."+t,"request.count"),o.push("$count="+e.count)),e.top&&e.top>0&&(s.numberParameterCheck(e.top,"DynamicsWebApi."+t,"request.top"),o.push("$top="+e.top)),null!=e.orderBy&&e.orderBy.length&&(s.arrayParameterCheck(e.orderBy,"DynamicsWebApi."+t,"request.orderBy"),o.push("$orderby="+e.orderBy.join(","))),e.returnRepresentation&&(s.boolParameterCheck(e.returnRepresentation,"DynamicsWebApi."+t,"request.returnRepresentation"),c.Prefer=i.Prefer.ReturnRepresentation),e.includeAnnotations&&(s.stringParameterCheck(e.includeAnnotations,"DynamicsWebApi."+t,"request.includeAnnotations"),c.Prefer='odata.include-annotations="'+e.includeAnnotations+'"'),null!=e.ifmatch&&null!=e.ifnonematch)throw Error("DynamicsWebApi."+t+". Either one of request.ifmatch or request.ifnonematch parameters shoud be used in a call, not both.");if(e.ifmatch&&(s.stringParameterCheck(e.ifmatch,"DynamicsWebApi."+t,"request.ifmatch"),c["If-Match"]=e.ifmatch),e.ifnonematch&&(s.stringParameterCheck(e.ifnonematch,"DynamicsWebApi."+t,"request.ifnonematch"),c["If-None-Match"]=e.ifnonematch),e.impersonate&&(s.stringParameterCheck(e.impersonate,"DynamicsWebApi."+t,"request.impersonate"),c.MSCRMCallerID=s.guidParameterCheck(e.impersonate,"DynamicsWebApi."+t,"request.impersonate")),null!=e.expand&&e.expand.length){s.arrayParameterCheck(e.expand,"DynamicsWebApi."+t,"request.expand");for(var u=[],l=0;l<e.expand.length;l++)if(e.expand[l].property){var p=a(e.expand[l],t+" $expand",null,";"),d=p.query;d&&d.length&&(d="("+d+")"),u.push(e.expand[l].property+d)}u.length&&o.push("$expand="+encodeURI(u.join(",")))}}return{url:r,query:o.join(n),headers:c}}function n(e,t){e.collection?s.stringParameterCheck(e.collection,"DynamicsWebApi."+t,"request.collection"):s.parameterCheck(e.collection,"DynamicsWebApi."+t,"request.collection");var r=e.collection.toLowerCase();e.id&&(e.id=s.guidParameterCheck(e.id,"DynamicsWebApi."+t,"request.id"),r+="("+e.id+")");var n=a(e,t,r);return n.query&&(n.url+="?"+n.query),{url:n.url,headers:n.headers}}var i=r(0),s=r(1),c={convertRequestOptions:a,convertRequest:n};e.exports=c},function(e,t,r){var a={buildFunctionParameters:r(8)};e.exports=a},function(e,t){e.exports=function(e,t){return"string"==typeof t&&/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}Z$/.exec(t)?new Date(t):t}},function(e,t){e.exports=function(e){var t={};if(!e)return t;for(var r=e.split("\r\n"),a=0,n=r.length;a<n;a++){var i=r[a],s=i.indexOf(": ");s>0&&(t[i.substring(0,s)]=i.substring(s+2))}return t}},function(e,t){e.exports=function(e){if(e){for(var t=Object.keys(e),r="",a="",n=1;n<=t.length;n++){var i=t[n-1],s=e[i];n>1&&(r+=",",a+="&"),r+=i+"=@p"+n,a+="@p"+n+"="+("string"==typeof s?"'"+s+"'":s)}return"("+r+")?"+a}return"()"}},function(e,t,r){function a(e){var t=function(){if("undefined"!=typeof Xrm){var e=Xrm.Page.context.getClientUrl();return e.match(/\/$/)&&(e=e.substring(0,e.length-1)),e}return""},c="8.0",o=null,u=function(){return t()+"/api/data/v"+c+"/"},l=u(),p=function(e,t){return"string"==typeof e&&e.endsWith("@odata.bind")&&"string"==typeof t&&!t.startsWith(l)&&(t=l+t),t},d=function(e,t,a,n){o&&(!n||n&&!n.MSCRMCallerID)&&(n||(n={}),n.MSCRMCallerID=o);var i;a&&(i=JSON.stringify(a,p));var s;return"undefined"!=typeof XMLHttpRequest&&(s=r(3)),new Promise(function(r,a){s(e,l+t,i,n,r,a)})};this.setConfig=function(e){e.webApiVersion&&(s.stringParameterCheck(e.webApiVersion,"DynamicsWebApi.setConfig","config.webApiVersion"),c=e.webApiVersion,l=u()),e.webApiUrl&&(s.stringParameterCheck(e.webApiUrl,"DynamicsWebApi.setConfig","config.webApiUrl"),l=e.webApiUrl),e.impersonate&&(o=s.guidParameterCheck(e.impersonate,"DynamicsWebApi.setConfig","config.impersonate"))},null!=e&&this.setConfig(e);var h=function(e){var t=/\/(\w+)\(([0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12})/i.exec(e["@odata.id"]);return{id:t[2],collection:t[1],oDataContext:e["@odata.context"]}};this.create=function(e,t,r){s.parameterCheck(e,"DynamicsWebApi.create","object"),s.stringParameterCheck(t,"DynamicsWebApi.create","collection");var a={};return null!=r&&(s.stringParameterCheck(r,"DynamicsWebApi.create","prefer"),a.Prefer=r),d("POST",t.toLowerCase(),e,a).then(function(e){if(e.data)return e.data;var t=e.headers["OData-EntityId"]?e.headers["OData-EntityId"]:e.headers["odata-entityid"];return/[0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12}/i.exec(t)[0]})},this.retrieveRequest=function(e){s.parameterCheck(e,"DynamicsWebApi.retrieve","request");var t=i.convertRequest(e,"retrieve"),r=e.select;return d("GET",t.url,null,t.headers).then(function(e){return null!=r&&1==r.length&&r[0].endsWith("/$ref")&&null!=e.data["@odata.id"]?h(e.data):e.data})},this.retrieve=function(e,t,r,a){s.stringParameterCheck(e,"DynamicsWebApi.retrieve","id"),e=s.guidParameterCheck(e,"DynamicsWebApi.retrieve","id"),s.stringParameterCheck(t,"DynamicsWebApi.retrieve","collection");var n=t.toLowerCase()+"("+e+")",i=[];return null!=r&&r.length&&(s.arrayParameterCheck(r,"DynamicsWebApi.retrieve","select"),1==r.length&&r[0].endsWith("/$ref")&&r[0].endsWith("/$ref")?n+="/"+r[0]:(r[0].startsWith("/")&&(n+=r.shift()),r.length&&i.push("$select="+r.join(",")))),null!=a&&(s.stringParameterCheck(a,"DynamicsWebApi.retrieve","expand"),i.push("$expand="+a)),i.length&&(n+="?"+i.join("&")),d("GET",n).then(function(e){return null!=r&&1==r.length&&r[0].endsWith("/$ref")&&null!=e.data["@odata.id"]?h(e.data):e.data})},this.updateRequest=function(e){s.parameterCheck(e,"DynamicsWebApi.update","request"),s.parameterCheck(e.entity,"DynamicsWebApi.update","request.entity");var t=i.convertRequest(e,"update");null==e.ifmatch&&(t.headers["If-Match"]="*");var r=e.ifmatch;return d("PATCH",t.url,e.entity,t.headers).then(function(e){return!e.data||e.data}).catch(function(e){if(r&&412==e.status)return!1;throw e})},this.update=function(e,t,r,a,n){s.stringParameterCheck(e,"DynamicsWebApi.update","id"),e=s.guidParameterCheck(e,"DynamicsWebApi.update","id"),s.parameterCheck(r,"DynamicsWebApi.update","object"),s.stringParameterCheck(t,"DynamicsWebApi.update","collection");var i={"If-Match":"*"};null!=a&&(s.stringParameterCheck(a,"DynamicsWebApi.update","prefer"),i.Prefer=a);var c="";return null!=n&&(s.arrayParameterCheck(n,"DynamicsWebApi.update","select"),n.length>0&&(c="?$select="+n.join(","))),d("PATCH",t.toLowerCase()+"("+e+")"+c,r,i).then(function(e){if(e.data)return e.data})},this.updateSingleProperty=function(e,t,r,a){s.stringParameterCheck(e,"DynamicsWebApi.updateSingleProperty","id"),e=s.guidParameterCheck(e,"DynamicsWebApi.updateSingleProperty","id"),s.parameterCheck(r,"DynamicsWebApi.updateSingleProperty","keyValuePair"),s.stringParameterCheck(t,"DynamicsWebApi.updateSingleProperty","collection");var n=Object.keys(r)[0],i=r[n],c={};return null!=a&&(s.stringParameterCheck(a,"DynamicsWebApi.updateSingleProperty","prefer"),c.Prefer=a),d("PUT",t.toLowerCase()+"("+e+")/"+n,{value:i},c).then(function(e){if(e.data)return e.data})},this.deleteRequest=function(e){s.parameterCheck(e,"DynamicsWebApi.delete","request");var t=i.convertRequest(e,"delete"),r=e.ifmatch;return d("DELETE",t.url,null,t.headers).then(function(){return!0}).catch(function(e){if(r&&412==e.status)return!1;throw e})},this.deleteRecord=function(e,t,r){s.stringParameterCheck(e,"DynamicsWebApi.deleteRequest","id"),e=s.guidParameterCheck(e,"DynamicsWebApi.deleteRequest","id"),s.stringParameterCheck(t,"DynamicsWebApi.deleteRequest","collection"),null!=r&&s.stringParameterCheck(r,"DynamicsWebApi.deleteRequest","propertyName");var a=t.toLowerCase()+"("+e+")";return null!=r&&(a+="/"+r),d("DELETE",a).then(function(){})},this.upsertRequest=function(e){s.parameterCheck(e,"DynamicsWebApi.upsert","request"),s.parameterCheck(e.entity,"DynamicsWebApi.upsert","request.entity");var t=i.convertRequest(e,"upsert"),r=e.ifnonematch,a=e.ifmatch;return d("PATCH",t.url,e.entity,t.headers).then(function(e){if(e.headers["OData-EntityId"]||e.headers["odata-entityid"]){var t=e.headers["OData-EntityId"]?e.headers["OData-EntityId"]:e.headers["odata-entityid"];return/[0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12}/i.exec(t)[0]}if(e.data)return e.data}).catch(function(e){if(!(r&&412==e.status||a&&404==e.status))throw e})},this.upsert=function(e,t,r,a,n){s.stringParameterCheck(e,"DynamicsWebApi.upsert","id"),e=s.guidParameterCheck(e,"DynamicsWebApi.upsert","id"),s.parameterCheck(r,"DynamicsWebApi.upsert","object"),s.stringParameterCheck(t,"DynamicsWebApi.upsert","collection");var i={};null!=a&&(s.stringParameterCheck(a,"DynamicsWebApi.upsert","prefer"),i.Prefer=a);var c="";return null!=n&&(s.arrayParameterCheck(n,"DynamicsWebApi.upsert","select"),n.length>0&&(c="?$select="+n.join(","))),d("PATCH",t.toLowerCase()+"("+e+")"+c,r,i).then(function(e){if(e.headers["OData-EntityId"]||e.headers["odata-entityid"]){var t=e.headers["OData-EntityId"]?e.headers["OData-EntityId"]:e.headers["odata-entityid"];return/[0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12}/i.exec(t)[0]}if(e.data)return e.data})};var m=function(e,t){t&&!e.collection&&(e.collection="any");var r=i.convertRequest(e,"retrieveMultiple");t&&(s.stringParameterCheck(t,"DynamicsWebApi.retrieveMultiple","nextPageLink"),r.url=t.replace(l,""));var a=e.count;return d("GET",r.url,null,r.headers).then(function(e){return null!=e.data["@odata.nextLink"]&&(e.data.oDataNextLink=e.data["@odata.nextLink"]),a&&(e.data.oDataCount=null!=e.data["@odata.count"]?parseInt(e.data["@odata.count"]):0),null!=e.data["@odata.context"]&&(e.data.oDataContext=e.data["@odata.context"]),e.data})};this.retrieveMultipleRequest=m;this.count=function(e,t){return null==t||null!=t&&!t.length?(s.stringParameterCheck(e,"DynamicsWebApi.count","collection"),d("GET",e.toLowerCase()+"/$count").then(function(e){return e.data?parseInt(e.data):0})):this.retrieveMultipleRequest({collection:e,filter:t,count:!0},null).then(function(e){return e.oDataCount?e.oDataCount:0})},this.retrieveMultiple=function(e,t,r,a){return this.retrieveMultipleRequest({collection:e,select:t,filter:r},a)};var f=function(e,t){try{e=unescape(unescape(e));var r=/pagingcookie="(<cookie page="(\d+)".+<\/cookie>)/.exec(e);if(null!=r){var a=parseInt(r[2]);return{cookie:r[1].replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"'").replace(/\'/g,"&quot;"),page:a,nextPage:a+1}}return{cookie:"",page:t,nextPage:t+1}}catch(e){throw new Error(e)}};this.executeFetchXml=function(e,t,r,a,n,i){s.stringParameterCheck(e,"DynamicsWebApi.executeFetchXml","type"),s.stringParameterCheck(t,"DynamicsWebApi.executeFetchXml","fetchXml"),null==a&&(a=1),s.numberParameterCheck(a,"DynamicsWebApi.executeFetchXml","pageNumber");var c="$1 page='"+a+"'";null!=n&&(s.stringParameterCheck(n,"DynamicsWebApi.executeFetchXml","pagingCookie"),c+=" paging-cookie='"+n+"'"),t=t.replace(/^(<fetch[\w\d\s'"=]+)/,c);var o={};null!=r&&(s.stringParameterCheck(r,"DynamicsWebApi.executeFetchXml","includeAnnotations"),o.Prefer='odata.include-annotations="'+r+'"'),null!=i&&(i=s.guidParameterCheck(i,"DynamicsWebApi.executeFetchXml","impersonateUserId"),header.MSCRMCallerID=i);var u=escape(t);return d("GET",e.toLowerCase()+"?fetchXml="+u,null,o).then(function(e){return null!=e.data["@Microsoft.Dynamics.CRM.fetchxmlpagingcookie"]&&(e.data.PagingInfo=f(e.data["@Microsoft.Dynamics.CRM.fetchxmlpagingcookie"],a)),null!=e.data["@odata.context"]&&(e.data.oDataContext=e.data["@odata.context"]),e.data})},this.associate=function(e,t,r,a,n,i){s.stringParameterCheck(e,"DynamicsWebApi.associate","primarycollection"),s.stringParameterCheck(a,"DynamicsWebApi.associate","relatedcollection"),s.stringParameterCheck(r,"DynamicsWebApi.associate","relationshipName"),t=s.guidParameterCheck(t,"DynamicsWebApi.associate","primaryId"),n=s.guidParameterCheck(n,"DynamicsWebApi.associate","relatedId");var c={};return null!=i&&(i=s.guidParameterCheck(i,"DynamicsWebApi.associate","impersonateUserId"),c.MSCRMCallerID=i),d("POST",e+"("+t+")/"+r+"/$ref",{"@odata.id":l+a+"("+n+")"},c).then(function(){})},this.disassociate=function(e,t,r,a,n){s.stringParameterCheck(e,"DynamicsWebApi.disassociate","primarycollection"),s.stringParameterCheck(r,"DynamicsWebApi.disassociate","relationshipName"),t=s.guidParameterCheck(t,"DynamicsWebApi.disassociate","primaryId"),a=s.guidParameterCheck(a,"DynamicsWebApi.disassociate","relatedId");var i={};return null!=n&&(n=s.guidParameterCheck(n,"DynamicsWebApi.associate","impersonateUserId"),i.MSCRMCallerID=n),d("DELETE",e+"("+t+")/"+r+"("+a+")/$ref",null,i).then(function(){})},this.associateSingleValued=function(e,t,r,a,n,i){s.stringParameterCheck(e,"DynamicsWebApi.associateSingleValued","collection"),t=s.guidParameterCheck(t,"DynamicsWebApi.associateSingleValued","id"),n=s.guidParameterCheck(n,"DynamicsWebApi.associateSingleValued","relatedId"),s.stringParameterCheck(r,"DynamicsWebApi.associateSingleValued","singleValuedNavigationPropertyName"),s.stringParameterCheck(a,"DynamicsWebApi.associateSingleValued","relatedcollection");var c={};return null!=i&&(i=s.guidParameterCheck(i,"DynamicsWebApi.associate","impersonateUserId"),c.MSCRMCallerID=i),d("PUT",e+"("+t+")/"+r+"/$ref",{"@odata.id":l+a+"("+n+")"},c).then(function(){})},this.disassociateSingleValued=function(e,t,r,a){s.stringParameterCheck(e,"DynamicsWebApi.disassociateSingleValued","collection"),t=s.guidParameterCheck(t,"DynamicsWebApi.disassociateSingleValued","id"),s.stringParameterCheck(r,"DynamicsWebApi.disassociateSingleValued","singleValuedNavigationPropertyName");var n={};return null!=a&&(a=s.guidParameterCheck(a,"DynamicsWebApi.associate","impersonateUserId"),n.MSCRMCallerID=a),d("DELETE",e+"("+t+")/"+r+"/$ref",null,n).then(function(){})},this.executeUnboundFunction=function(e,t,r){return y(e,t,null,null,r)},this.executeBoundFunction=function(e,t,r,a,n){return y(r,a,t,e,n)};var y=function(e,t,r,a,i){s.stringParameterCheck(e,"DynamicsWebApi.executeFunction","functionName");var c=e+n.buildFunctionParameters(t);null!=r&&(s.stringParameterCheck(r,"DynamicsWebApi.executeFunction","collection"),a=s.guidParameterCheck(a,"DynamicsWebApi.executeFunction","id"),c=r+"("+a+")/"+c);var o={};return null!=i&&(o.MSCRMCallerID=s.guidParameterCheck(i,"DynamicsWebApi.associate","impersonateUserId")),d("GET",c,null,o).then(function(e){if(e.data)return e.data})};this.executeUnboundAction=function(e,t,r){return g(e,t,null,null,r)},this.executeBoundAction=function(e,t,r,a,n){return g(r,a,t,e,n)};var g=function(e,t,r,a,n){s.stringParameterCheck(e,"DynamicsWebApi.executeAction","actionName");var i=e;null!=r&&(s.stringParameterCheck(r,"DynamicsWebApi.executeAction","collection"),a=s.guidParameterCheck(a,"DynamicsWebApi.executeAction","id"),i=r+"("+a+")/"+i);var c={};return null!=n&&(n=s.guidParameterCheck(n,"DynamicsWebApi.executeAction","impersonateUserId"),c.MSCRMCallerID=n),d("POST",i,t,c).then(function(e){if(e.data)return e.data})};this.initializeInstance=function(e){return e||(e={impersonate:o,webApiUrl:l,webApiVersion:c}),new a(e)}}var n=(r(0),r(5)),i=r(4),s=r(1);String.prototype.endsWith&&String.prototype.startsWith||r(2),e.exports=a}])});