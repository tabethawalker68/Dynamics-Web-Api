/*! dynamics-web-api v1.2.1 (c) 2017 Aleksandr Rogov */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.DynamicsWebApi=t():e.DynamicsWebApi=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var a=n[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=12)}([function(e,t){var n={Types:{ResponseBase:function(){this.oDataContext=""},Response:function(){n.Types.ResponseBase.call(this),this.value={}},ReferenceResponse:function(){n.Types.ResponseBase.call(this),this.id="",this.collection=""},MultipleResponse:function(){n.Types.ResponseBase.call(this),this.oDataNextLink="",this.oDataCount=0,this.value=[]},FetchXmlResponse:function(){n.Types.ResponseBase.call(this),this.value=[],this.PagingInfo={cookie:"",page:0,nextPage:1}}},Prefer:{ReturnRepresentation:"return=representation",Annotations:{AssociatedNavigationProperty:"Microsoft.Dynamics.CRM.associatednavigationproperty",LookupLogicalName:"Microsoft.Dynamics.CRM.lookuplogicalname",All:"*",FormattedValue:"OData.Community.Display.V1.FormattedValue",FetchXmlPagingCookie:"Microsoft.Dynamics.CRM.fetchxmlpagingcookie"}}};e.exports=n},function(e,t){function n(e,t,n){throw new Error(n?e+" requires the "+t+" parameter to be of type "+n:e+" requires the "+t+" parameter.")}var r={handleErrorResponse:function(e){throw new Error("Error: "+e.status+": "+e.message)},parameterCheck:function(e,t,r,a){void 0!==e&&null!==e&&""!=e||n(t,r,a)},stringParameterCheck:function(e,t,r){"string"!=typeof e&&n(t,r,"String")},arrayParameterCheck:function(e,t,r){e.constructor!==Array&&n(t,r,"Array")},stringOrArrayParameterCheck:function(e,t,r){e.constructor!==Array&&"string"!=typeof e&&n(t,r,"String or Array")},numberParameterCheck:function(e,t,r){if("number"!=typeof e){if("string"==typeof e&&e&&!isNaN(parseInt(e)))return;n(t,r,"Number")}},boolParameterCheck:function(e,t,r){"boolean"!=typeof e&&n(t,r,"Boolean")},guidParameterCheck:function(e,t,r){try{return/[0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12}/i.exec(e)[0]}catch(e){n(t,r,"GUID String")}},callbackParameterCheck:function(e,t,r){"function"!=typeof e&&n(t,r,"Function")}};e.exports=r},function(e,t){String.prototype.endsWith=function(e,t){var n=this.toString();("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>n.length)&&(t=n.length),t-=e.length;var r=n.lastIndexOf(e,t);return r!==-1&&r===t},String.prototype.startsWith=function(e,t){return t=t||0,this.substr(t,e.length)===e}},function(e,t,n){var r=n(0);e.exports=function(e,t,a,i,o,s,c){a.impersonate&&(!o||o&&!o.MSCRMCallerID)&&(o||(o={}),o.MSCRMCallerID=a.impersonate),(!o||o&&!o.Prefer)&&(o||(o={}),a.maxPageSize&&a.maxPageSize>0&&(o.Prefer="odata.maxpagesize="+a.maxPageSize),a.returnRepresentation&&!o.hasOwnProperty("Prefer")&&(o.Prefer=r.Prefer.ReturnRepresentation),a.includeAnnotations&&(o.Prefer='odata.include-annotations="'+a.includeAnnotations+'"'),o.hasOwnProperty("Prefer")&&!o.Prefer&&delete o.Prefer);var u;i&&(u=JSON.stringify(i,function(e,t){return e.endsWith("@odata.bind")&&"string"==typeof t&&!t.startsWith(a.webApiUrl)&&(t=a.webApiUrl+t),t}));var l;"undefined"!=typeof XMLHttpRequest&&(l=n(8));var p=function(n){n&&(o||(o={}),o.Authorization="Bearer: "+n),l(e,a.webApiUrl+t,u,o,s,c)};a.onTokenRefresh&&(!o||o&&!o.Authorization)?a.onTokenRefresh(p):p()}},function(e,t,n){function r(e,t,n,a){var s={},c=[];if(a=null!=a?a:"&",e){if(e.navigationProperty&&(o.stringParameterCheck(e.navigationProperty,"DynamicsWebApi."+t,"request.navigationProperty"),n+="/"+e.navigationProperty),null!=e.select&&e.select.length&&(o.arrayParameterCheck(e.select,"DynamicsWebApi."+t,"request.select"),"retrieve"==t&&1==e.select.length&&e.select[0].endsWith("/$ref")?n+="/"+e.select[0]:(e.select[0].startsWith("/")&&"retrieve"==t&&(null==e.navigationProperty?n+=e.select.shift():e.select.shift()),e.select.length&&c.push("$select="+e.select.join(",")))),e.filter&&(o.stringParameterCheck(e.filter,"DynamicsWebApi."+t,"request.filter"),c.push("$filter="+e.filter)),e.savedQuery&&c.push("savedQuery="+o.guidParameterCheck(e.savedQuery,"DynamicsWebApi."+t,"request.savedQuery")),e.userQuery&&c.push("userQuery="+o.guidParameterCheck(e.userQuery,"DynamicsWebApi."+t,"request.userQuery")),e.maxPageSize&&e.maxPageSize>0&&(o.numberParameterCheck(e.maxPageSize,"DynamicsWebApi."+t,"request.maxPageSize"),s.Prefer="odata.maxpagesize="+e.maxPageSize),e.count&&(o.boolParameterCheck(e.count,"DynamicsWebApi."+t,"request.count"),c.push("$count="+e.count)),e.top&&e.top>0&&(o.numberParameterCheck(e.top,"DynamicsWebApi."+t,"request.top"),c.push("$top="+e.top)),null!=e.orderBy&&e.orderBy.length&&(o.arrayParameterCheck(e.orderBy,"DynamicsWebApi."+t,"request.orderBy"),c.push("$orderby="+e.orderBy.join(","))),null!=e.returnRepresentation&&(o.boolParameterCheck(e.returnRepresentation,"DynamicsWebApi."+t,"request.returnRepresentation"),s.Prefer=e.returnRepresentation?i.Prefer.ReturnRepresentation:""),e.includeAnnotations&&(o.stringParameterCheck(e.includeAnnotations,"DynamicsWebApi."+t,"request.includeAnnotations"),s.Prefer='odata.include-annotations="'+e.includeAnnotations+'"'),null!=e.ifmatch&&null!=e.ifnonematch)throw new Error("DynamicsWebApi."+t+". Either one of request.ifmatch or request.ifnonematch parameters should be used in a call, not both.");if(e.ifmatch&&(o.stringParameterCheck(e.ifmatch,"DynamicsWebApi."+t,"request.ifmatch"),s["If-Match"]=e.ifmatch),e.ifnonematch&&(o.stringParameterCheck(e.ifnonematch,"DynamicsWebApi."+t,"request.ifnonematch"),s["If-None-Match"]=e.ifnonematch),e.impersonate&&(o.stringParameterCheck(e.impersonate,"DynamicsWebApi."+t,"request.impersonate"),s.MSCRMCallerID=o.guidParameterCheck(e.impersonate,"DynamicsWebApi."+t,"request.impersonate")),e.token&&(o.stringParameterCheck(e.token,"DynamicsWebApi."+t,"request.token"),s.Authorization="Bearer: "+e.token),null!=e.expand&&e.expand.length){o.arrayParameterCheck(e.expand,"DynamicsWebApi."+t,"request.expand");for(var u=[],l=0;l<e.expand.length;l++)if(e.expand[l].property){var p=r(e.expand[l],t+" $expand",null,";"),m=p.query;m&&m.length&&(m="("+m+")"),u.push(e.expand[l].property+m)}u.length&&c.push("$expand="+encodeURI(u.join(",")))}}return{url:n,query:c.join(a),headers:s}}function a(e,t){e.collection?o.stringParameterCheck(e.collection,"DynamicsWebApi."+t,"request.collection"):o.parameterCheck(e.collection,"DynamicsWebApi."+t,"request.collection");var n=e.collection.toLowerCase();e.id&&(e.id=o.guidParameterCheck(e.id,"DynamicsWebApi."+t,"request.id"),n+="("+e.id+")");var a=r(e,t,n);return a.query&&(a.url+="?"+encodeURI(a.query)),{url:a.url,headers:a.headers}}var i=n(0),o=n(1),s={convertRequestOptions:r,convertRequest:a};e.exports=s},function(e,t,n){var r={buildFunctionParameters:n(9),getFetchXmlPagingCookie:n(11),convertToReferenceObject:n(10)};e.exports=r},function(e,t){e.exports=function(e,t){return"string"==typeof t&&/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}Z$/.exec(t)?new Date(t):t}},function(e,t){e.exports=function(e){var t={};if(!e)return t;for(var n=e.split("\r\n"),r=0,a=n.length;r<a;r++){var i=n[r],o=i.indexOf(": ");o>0&&(t[i.substring(0,o)]=i.substring(o+2))}return t}},function(e,t,n){var r=n(6),a=n(7),i=function(e,t,n,i,o,s){var c=new XMLHttpRequest;if(c.open(e,t,!0),c.setRequestHeader("OData-MaxVersion","4.0"),c.setRequestHeader("OData-Version","4.0"),c.setRequestHeader("Accept","application/json"),c.setRequestHeader("Content-Type","application/json; charset=utf-8"),null!=i)for(var u in i)c.setRequestHeader(u,i[u]);c.onreadystatechange=function(){if(4===c.readyState){switch(c.status){case 200:case 201:case 204:case 304:var e=null;c.responseText&&(e=JSON.parse(c.responseText,r));o({data:e,headers:a(c.getAllResponseHeaders()),status:c.status});break;default:var t;try{t=JSON.parse(c.response).error}catch(e){t=new Error("Unexpected Error")}t.status=c.status,s(t)}c=null}},c.onerror=function(){s({message:"Network Error"}),c=null},c.ontimeout=function(e){s({message:"Request Timed Out"}),c=null},n?c.send(n):c.send()};e.exports=i},function(e,t){e.exports=function(e){if(e){for(var t=Object.keys(e),n="",r="",a=1;a<=t.length;a++){var i=t[a-1],o=e[i];a>1&&(n+=",",r+="&"),n+=i+"=@p"+a,r+="@p"+a+"="+("string"==typeof o?"'"+o+"'":o)}return"("+n+")?"+r}return"()"}},function(e,t){e.exports=function(e){var t=/\/(\w+)\(([0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12})/i.exec(e["@odata.id"]);return{id:t[2],collection:t[1],oDataContext:e["@odata.context"]}}},function(e,t){e.exports=function(e,t){e=e?e:"",t=t?t:1,e=unescape(unescape(e));var n=/pagingcookie="(<cookie page="(\d+)".+<\/cookie>)/.exec(e);if(null!=n){var r=parseInt(n[2]);return{cookie:n[1].replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"'").replace(/\'/g,"&quot;"),page:r,nextPage:r+1}}return{cookie:"",page:t,nextPage:t+1}}},function(e,t,n){function r(e){var t={webApiVersion:"8.0",webApiUrl:null,impersonate:null,onTokenRefresh:null,includeAnnotations:null,maxPageSize:null,returnRepresentation:null};e||(e=t);var s=function(){if("undefined"!=typeof GetGlobalContext)return GetGlobalContext();if("undefined"!=typeof Xrm)return Xrm.Page.context;throw new Error("Xrm Context is not available.")},c=function(){var e=s();if(e){var t=e.getClientUrl();return t.match(/\/$/)&&(t=t.substring(0,t.length-1)),t}return""},u=function(){return c()+"/api/data/v"+t.webApiVersion+"/"};this.setConfig=function(e){e.webApiVersion&&(o.stringParameterCheck(e.webApiVersion,"DynamicsWebApi.setConfig","config.webApiVersion"),t.webApiVersion=e.webApiVersion),e.webApiUrl?(o.stringParameterCheck(e.webApiUrl,"DynamicsWebApi.setConfig","config.webApiUrl"),t.webApiUrl=e.webApiUrl):t.webApiUrl=u(),e.impersonate&&(t.impersonate=o.guidParameterCheck(e.impersonate,"DynamicsWebApi.setConfig","config.impersonate")),e.onTokenRefresh&&(o.callbackParameterCheck(e.onTokenRefresh,"DynamicsWebApi.setConfig","config.onTokenRefresh"),t.onTokenRefresh=e.onTokenRefresh),e.includeAnnotations&&(o.stringParameterCheck(e.includeAnnotations,"DynamicsWebApi.setConfig","config.includeAnnotations"),t.includeAnnotations=e.includeAnnotations),e.maxPageSize&&(o.numberParameterCheck(e.maxPageSize,"DynamicsWebApi.setConfig","config.maxPageSize"),t.maxPageSize=e.maxPageSize),e.returnRepresentation&&(o.boolParameterCheck(e.returnRepresentation,"DynamicsWebApi.setConfig","config.returnRepresentation"),t.returnRepresentation=e.returnRepresentation)},this.setConfig(e);var l=function(e,r,a,i){return new Promise(function(o,s){n(3)(e,r,t,a,i,o,s)})};this.create=function(e,t,n){o.parameterCheck(e,"DynamicsWebApi.create","object"),o.stringParameterCheck(t,"DynamicsWebApi.create","collection");var r={};return null!=n&&(o.stringParameterCheck(n,"DynamicsWebApi.create","prefer"),r.Prefer=n),l("POST",t.toLowerCase(),e,r).then(function(e){if(e.data)return e.data;var t=e.headers["OData-EntityId"]?e.headers["OData-EntityId"]:e.headers["odata-entityid"];return/[0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12}/i.exec(t)[0]})},this.retrieveRequest=function(e){o.parameterCheck(e,"DynamicsWebApi.retrieve","request");var t=i.convertRequest(e,"retrieve"),n=e.select;return l("GET",t.url,null,t.headers).then(function(e){return null!=n&&1==n.length&&n[0].endsWith("/$ref")&&null!=e.data["@odata.id"]?a.convertToReferenceObject(e.data):e.data})},this.retrieve=function(e,t,n,r){o.stringParameterCheck(e,"DynamicsWebApi.retrieve","id"),e=o.guidParameterCheck(e,"DynamicsWebApi.retrieve","id"),o.stringParameterCheck(t,"DynamicsWebApi.retrieve","collection");var i=t.toLowerCase()+"("+e+")",s=[];return null!=n&&n.length&&(o.arrayParameterCheck(n,"DynamicsWebApi.retrieve","select"),1==n.length&&n[0].endsWith("/$ref")&&n[0].endsWith("/$ref")?i+="/"+n[0]:(n[0].startsWith("/")&&(i+=n.shift()),n.length&&s.push("$select="+n.join(",")))),null!=r&&(o.stringParameterCheck(r,"DynamicsWebApi.retrieve","expand"),s.push("$expand="+r)),s.length&&(i+="?"+s.join("&")),l("GET",i).then(function(e){return null!=n&&1==n.length&&n[0].endsWith("/$ref")&&null!=e.data["@odata.id"]?a.convertToReferenceObject(e.data):e.data})},this.updateRequest=function(e){o.parameterCheck(e,"DynamicsWebApi.update","request"),o.parameterCheck(e.entity,"DynamicsWebApi.update","request.entity");var t=i.convertRequest(e,"update");null==e.ifmatch&&(t.headers["If-Match"]="*");var n=e.ifmatch;return l("PATCH",t.url,e.entity,t.headers).then(function(e){return!e.data||e.data}).catch(function(e){if(n&&412==e.status)return!1;throw e})},this.update=function(e,t,n,r,a){o.stringParameterCheck(e,"DynamicsWebApi.update","id"),e=o.guidParameterCheck(e,"DynamicsWebApi.update","id"),o.parameterCheck(n,"DynamicsWebApi.update","object"),o.stringParameterCheck(t,"DynamicsWebApi.update","collection");var i={"If-Match":"*"};null!=r&&(o.stringParameterCheck(r,"DynamicsWebApi.update","prefer"),i.Prefer=r);var s="";return null!=a&&(o.arrayParameterCheck(a,"DynamicsWebApi.update","select"),a.length>0&&(s="?$select="+a.join(","))),l("PATCH",t.toLowerCase()+"("+e+")"+s,n,i).then(function(e){if(e.data)return e.data})},this.updateSingleProperty=function(e,t,n,r){o.stringParameterCheck(e,"DynamicsWebApi.updateSingleProperty","id"),e=o.guidParameterCheck(e,"DynamicsWebApi.updateSingleProperty","id"),o.parameterCheck(n,"DynamicsWebApi.updateSingleProperty","keyValuePair"),o.stringParameterCheck(t,"DynamicsWebApi.updateSingleProperty","collection");var a=Object.keys(n)[0],i=n[a],s={};return null!=r&&(o.stringParameterCheck(r,"DynamicsWebApi.updateSingleProperty","prefer"),s.Prefer=r),l("PUT",t.toLowerCase()+"("+e+")/"+a,{value:i},s).then(function(e){if(e.data)return e.data})},this.deleteRequest=function(e){o.parameterCheck(e,"DynamicsWebApi.delete","request");var t=i.convertRequest(e,"delete"),n=e.ifmatch;return l("DELETE",t.url,null,t.headers).then(function(){return!0}).catch(function(e){if(n&&412==e.status)return!1;throw e})},this.deleteRecord=function(e,t,n){o.stringParameterCheck(e,"DynamicsWebApi.deleteRequest","id"),e=o.guidParameterCheck(e,"DynamicsWebApi.deleteRequest","id"),o.stringParameterCheck(t,"DynamicsWebApi.deleteRequest","collection"),null!=n&&o.stringParameterCheck(n,"DynamicsWebApi.deleteRequest","propertyName");var r=t.toLowerCase()+"("+e+")";return null!=n&&(r+="/"+n),l("DELETE",r).then(function(){})},this.upsertRequest=function(e){o.parameterCheck(e,"DynamicsWebApi.upsert","request"),o.parameterCheck(e.entity,"DynamicsWebApi.upsert","request.entity");var t=i.convertRequest(e,"upsert"),n=e.ifnonematch,r=e.ifmatch;return l("PATCH",t.url,e.entity,t.headers).then(function(e){if(e.headers["OData-EntityId"]||e.headers["odata-entityid"]){var t=e.headers["OData-EntityId"]?e.headers["OData-EntityId"]:e.headers["odata-entityid"];return/[0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12}/i.exec(t)[0]}if(e.data)return e.data}).catch(function(e){if(!(n&&412==e.status||r&&404==e.status))throw e})},this.upsert=function(e,t,n,r,a){o.stringParameterCheck(e,"DynamicsWebApi.upsert","id"),e=o.guidParameterCheck(e,"DynamicsWebApi.upsert","id"),o.parameterCheck(n,"DynamicsWebApi.upsert","object"),o.stringParameterCheck(t,"DynamicsWebApi.upsert","collection");var i={};null!=r&&(o.stringParameterCheck(r,"DynamicsWebApi.upsert","prefer"),i.Prefer=r);var s="";return null!=a&&(o.arrayParameterCheck(a,"DynamicsWebApi.upsert","select"),a.length>0&&(s="?$select="+a.join(","))),l("PATCH",t.toLowerCase()+"("+e+")"+s,n,i).then(function(e){if(e.headers["OData-EntityId"]||e.headers["odata-entityid"]){var t=e.headers["OData-EntityId"]?e.headers["OData-EntityId"]:e.headers["odata-entityid"];return/[0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12}/i.exec(t)[0]}if(e.data)return e.data})};var p=function(e,n){n&&!e.collection&&(e.collection="any");var r=i.convertRequest(e,"retrieveMultiple");n&&(o.stringParameterCheck(n,"DynamicsWebApi.retrieveMultiple","nextPageLink"),r.url=n.replace(t.webApiUrl,""));var a=e.count;return l("GET",r.url,null,r.headers).then(function(e){return null!=e.data["@odata.nextLink"]&&(e.data.oDataNextLink=e.data["@odata.nextLink"]),a&&(e.data.oDataCount=null!=e.data["@odata.count"]?parseInt(e.data["@odata.count"]):0),null!=e.data["@odata.context"]&&(e.data.oDataContext=e.data["@odata.context"]),e.data})};this.retrieveMultipleRequest=p,this.count=function(e,t){return null==t||null!=t&&!t.length?(o.stringParameterCheck(e,"DynamicsWebApi.count","collection"),l("GET",e.toLowerCase()+"/$count").then(function(e){return e.data?parseInt(e.data):0})):this.retrieveMultipleRequest({collection:e,filter:t,count:!0},null).then(function(e){return e.oDataCount?e.oDataCount:0})},this.retrieveMultiple=function(e,t,n,r){return this.retrieveMultipleRequest({collection:e,select:t,filter:n},r)},this.executeFetchXml=function(e,t,n,r,i,s){o.stringParameterCheck(e,"DynamicsWebApi.executeFetchXml","type"),o.stringParameterCheck(t,"DynamicsWebApi.executeFetchXml","fetchXml"),null==r&&(r=1),o.numberParameterCheck(r,"DynamicsWebApi.executeFetchXml","pageNumber");var c='$1 page="'+r+'"';null!=i&&(o.stringParameterCheck(i,"DynamicsWebApi.executeFetchXml","pagingCookie"),c+=' paging-cookie="'+i+'"'),t=t.replace(/^(<fetch[\w\d\s'"=]+)/,c);var u={};null!=n&&(o.stringParameterCheck(n,"DynamicsWebApi.executeFetchXml","includeAnnotations"),u.Prefer='odata.include-annotations="'+n+'"'),null!=s&&(s=o.guidParameterCheck(s,"DynamicsWebApi.executeFetchXml","impersonateUserId"),header.MSCRMCallerID=s);var p=encodeURIComponent(t);return l("GET",e.toLowerCase()+"?fetchXml="+p,null,u).then(function(e){return null!=e.data["@Microsoft.Dynamics.CRM.fetchxmlpagingcookie"]&&(e.data.PagingInfo=a.getFetchXmlPagingCookie(e.data["@Microsoft.Dynamics.CRM.fetchxmlpagingcookie"],r)),null!=e.data["@odata.context"]&&(e.data.oDataContext=e.data["@odata.context"]),e.data})},this.associate=function(e,n,r,a,i,s){o.stringParameterCheck(e,"DynamicsWebApi.associate","primarycollection"),o.stringParameterCheck(a,"DynamicsWebApi.associate","relatedcollection"),o.stringParameterCheck(r,"DynamicsWebApi.associate","relationshipName"),n=o.guidParameterCheck(n,"DynamicsWebApi.associate","primaryId"),i=o.guidParameterCheck(i,"DynamicsWebApi.associate","relatedId");var c={};return null!=s&&(s=o.guidParameterCheck(s,"DynamicsWebApi.associate","impersonateUserId"),c.MSCRMCallerID=s),l("POST",e+"("+n+")/"+r+"/$ref",{"@odata.id":t.webApiUrl+a+"("+i+")"},c).then(function(){})},this.disassociate=function(e,t,n,r,a){o.stringParameterCheck(e,"DynamicsWebApi.disassociate","primarycollection"),o.stringParameterCheck(n,"DynamicsWebApi.disassociate","relationshipName"),t=o.guidParameterCheck(t,"DynamicsWebApi.disassociate","primaryId"),r=o.guidParameterCheck(r,"DynamicsWebApi.disassociate","relatedId");var i={};return null!=a&&(a=o.guidParameterCheck(a,"DynamicsWebApi.associate","impersonateUserId"),i.MSCRMCallerID=a),l("DELETE",e+"("+t+")/"+n+"("+r+")/$ref",null,i).then(function(){})},this.associateSingleValued=function(e,n,r,a,i,s){o.stringParameterCheck(e,"DynamicsWebApi.associateSingleValued","collection"),n=o.guidParameterCheck(n,"DynamicsWebApi.associateSingleValued","id"),i=o.guidParameterCheck(i,"DynamicsWebApi.associateSingleValued","relatedId"),o.stringParameterCheck(r,"DynamicsWebApi.associateSingleValued","singleValuedNavigationPropertyName"),o.stringParameterCheck(a,"DynamicsWebApi.associateSingleValued","relatedcollection");var c={};return null!=s&&(s=o.guidParameterCheck(s,"DynamicsWebApi.associate","impersonateUserId"),c.MSCRMCallerID=s),l("PUT",e+"("+n+")/"+r+"/$ref",{"@odata.id":t.webApiUrl+a+"("+i+")"},c).then(function(){})},this.disassociateSingleValued=function(e,t,n,r){o.stringParameterCheck(e,"DynamicsWebApi.disassociateSingleValued","collection"),t=o.guidParameterCheck(t,"DynamicsWebApi.disassociateSingleValued","id"),o.stringParameterCheck(n,"DynamicsWebApi.disassociateSingleValued","singleValuedNavigationPropertyName");var a={};return null!=r&&(r=o.guidParameterCheck(r,"DynamicsWebApi.associate","impersonateUserId"),a.MSCRMCallerID=r),l("DELETE",e+"("+t+")/"+n+"/$ref",null,a).then(function(){})},this.executeUnboundFunction=function(e,t,n){return m(e,t,null,null,n)},this.executeBoundFunction=function(e,t,n,r,a){return m(n,r,t,e,a)};var m=function(e,t,n,r,i){o.stringParameterCheck(e,"DynamicsWebApi.executeFunction","functionName");var s=e+a.buildFunctionParameters(t);null!=n&&(o.stringParameterCheck(n,"DynamicsWebApi.executeFunction","collection"),r=o.guidParameterCheck(r,"DynamicsWebApi.executeFunction","id"),s=n+"("+r+")/"+s);var c={};return null!=i&&(c.MSCRMCallerID=o.guidParameterCheck(i,"DynamicsWebApi.associate","impersonateUserId")),l("GET",s,null,c).then(function(e){if(e.data)return e.data})};this.executeUnboundAction=function(e,t,n){return d(e,t,null,null,n)},this.executeBoundAction=function(e,t,n,r,a){return d(n,r,t,e,a)};var d=function(e,t,n,r,a){o.stringParameterCheck(e,"DynamicsWebApi.executeAction","actionName");var i=e;null!=n&&(o.stringParameterCheck(n,"DynamicsWebApi.executeAction","collection"),r=o.guidParameterCheck(r,"DynamicsWebApi.executeAction","id"),i=n+"("+r+")/"+i);var s={};return null!=a&&(a=o.guidParameterCheck(a,"DynamicsWebApi.executeAction","impersonateUserId"),s.MSCRMCallerID=a),l("POST",i,t,s).then(function(e){if(e.data)return e.data})};this.initializeInstance=function(e){return e||(e=t),new r(e)}}var a=(n(0),n(5)),i=n(4),o=n(1);String.prototype.endsWith&&String.prototype.startsWith||n(2),e.exports=r}])});