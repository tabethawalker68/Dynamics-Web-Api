/*! dynamics-web-api v1.6.15 (c) 2020 Aleksandr Rogov */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("DynamicsWebApi",[],t):"object"==typeof exports?exports.DynamicsWebApi=t():e.DynamicsWebApi=t()}(self,(function(){return e={923:e=>{var t={Types:{ResponseBase:function(){this.oDataContext=""},Response:function(){t.Types.ResponseBase.call(this),this.value={}},ReferenceResponse:function(){t.Types.ResponseBase.call(this),this.id="",this.collection=""},MultipleResponse:function(){t.Types.ResponseBase.call(this),this.oDataNextLink="",this.oDataCount=0,this.value=[]},FetchXmlResponse:function(){t.Types.ResponseBase.call(this),this.value=[],this.PagingInfo={cookie:"",page:0,nextPage:1}}},Prefer:{ReturnRepresentation:"return=representation",Annotations:{AssociatedNavigationProperty:"Microsoft.Dynamics.CRM.associatednavigationproperty",LookupLogicalName:"Microsoft.Dynamics.CRM.lookuplogicalname",All:"*",FormattedValue:"OData.Community.Display.V1.FormattedValue",FetchXmlPagingCookie:"Microsoft.Dynamics.CRM.fetchxmlpagingcookie"}}};e.exports=t},530:(e,t,n)=>{"use strict";n(923);var r=n(389),i=n(535),a=n(67);function o(e){var t,n={webApiVersion:"8.0",webApiUrl:null,impersonate:null,impersonateAAD:null,onTokenRefresh:null,includeAnnotations:null,maxPageSize:null,returnRepresentation:null},s=!1;e||(e=n),this.setConfig=function(e){var t=(e.webApiVersion||n.webApiVersion)!==n.webApiVersion;e.webApiVersion&&(i.stringParameterCheck(e.webApiVersion,"DynamicsWebApi.setConfig","config.webApiVersion"),n.webApiVersion=e.webApiVersion),e.webApiUrl?(i.stringParameterCheck(e.webApiUrl,"DynamicsWebApi.setConfig","config.webApiUrl"),n.webApiUrl=e.webApiUrl):n.webApiUrl&&!t||(n.webApiUrl=r.initWebApiUrl(n.webApiVersion)),e.impersonate&&(n.impersonate=i.guidParameterCheck(e.impersonate,"DynamicsWebApi.setConfig","config.impersonate")),e.impersonateAAD&&(n.impersonateAAD=i.guidParameterCheck(e.impersonateAAD,"DynamicsWebApi.setConfig","config.impersonateAAD")),e.onTokenRefresh&&(i.callbackParameterCheck(e.onTokenRefresh,"DynamicsWebApi.setConfig","config.onTokenRefresh"),n.onTokenRefresh=e.onTokenRefresh),e.includeAnnotations&&(i.stringParameterCheck(e.includeAnnotations,"DynamicsWebApi.setConfig","config.includeAnnotations"),n.includeAnnotations=e.includeAnnotations),e.timeout&&(i.numberParameterCheck(e.timeout,"DynamicsWebApi.setConfig","config.timeout"),n.timeout=e.timeout),e.maxPageSize&&(i.numberParameterCheck(e.maxPageSize,"DynamicsWebApi.setConfig","config.maxPageSize"),n.maxPageSize=e.maxPageSize),e.returnRepresentation&&(i.boolParameterCheck(e.returnRepresentation,"DynamicsWebApi.setConfig","config.returnRepresentation"),n.returnRepresentation=e.returnRepresentation),e.useEntityNames&&(i.boolParameterCheck(e.useEntityNames,"DynamicsWebApi.setConfig","config.useEntityNames"),n.useEntityNames=e.useEntityNames)},this.setConfig(e);var c=function(e,r,i,o){return r.isBatch=s,r.requestId=t,new Promise((function(t,s){a.makeRequest(e,r,i,n,o,t,s)}))};this.createRequest=function(e){return i.parameterCheck(e,"DynamicsWebApi.create","request"),c("POST",e,"create").then((function(e){return e.data}))},this.create=function(e,t,n,r){i.parameterCheck(e,"DynamicsWebApi.create","object"),i.stringParameterCheck(t,"DynamicsWebApi.create","collection"),n&&i.stringOrArrayParameterCheck(n,"DynamicsWebApi.create","prefer"),r&&i.arrayParameterCheck(r,"DynamicsWebApi.create","select");var a={collection:t,select:r,prefer:n,entity:e};return this.createRequest(a)},this.retrieveRequest=function(e){i.parameterCheck(e,"DynamicsWebApi.retrieve","request");var t=null!=e.select&&1===e.select.length&&e.select[0].endsWith("/$ref");return c("GET",e,"retrieve",{isRef:t}).then((function(e){return e.data}))},this.retrieve=function(e,t,n,r){i.stringParameterCheck(e,"DynamicsWebApi.retrieve","key"),e=i.keyParameterCheck(e,"DynamicsWebApi.retrieve","key"),i.stringParameterCheck(t,"DynamicsWebApi.retrieve","collection"),n&&n.length&&i.arrayParameterCheck(n,"DynamicsWebApi.retrieve","select"),r&&r.length&&i.stringOrArrayParameterCheck(r,"DynamicsWebApi.retrieve","expand");var a={collection:t,key:e,select:n,expand:r};return this.retrieveRequest(a)},this.updateRequest=function(e){i.parameterCheck(e,"DynamicsWebApi.update","request"),null==e.ifmatch&&(e.ifmatch="*");var t=/EntityDefinitions|RelationshipDefinitions|GlobalOptionSetDefinitions/.test(e.collection)?"PUT":"PATCH",n=e.ifmatch;return c(t,e,"update",{valueIfEmpty:!0}).then((function(e){return e.data})).catch((function(e){if(n&&412===e.status)return!1;throw e}))},this.update=function(e,t,n,r,a){i.stringParameterCheck(e,"DynamicsWebApi.update","key"),e=i.keyParameterCheck(e,"DynamicsWebApi.update","key"),i.parameterCheck(n,"DynamicsWebApi.update","object"),i.stringParameterCheck(t,"DynamicsWebApi.update","collection"),r&&i.stringOrArrayParameterCheck(r,"DynamicsWebApi.update","prefer"),a&&i.arrayParameterCheck(a,"DynamicsWebApi.update","select");var o={collection:t,key:e,select:a,prefer:r,entity:n};return this.updateRequest(o)},this.updateSingleProperty=function(e,t,n,r,a){i.stringParameterCheck(e,"DynamicsWebApi.updateSingleProperty","key"),e=i.keyParameterCheck(e,"DynamicsWebApi.updateSingleProperty","key"),i.parameterCheck(n,"DynamicsWebApi.updateSingleProperty","keyValuePair"),i.stringParameterCheck(t,"DynamicsWebApi.updateSingleProperty","collection");var o=Object.keys(n)[0],s=n[o];return r&&i.stringOrArrayParameterCheck(r,"DynamicsWebApi.updateSingleProperty","prefer"),a&&i.arrayParameterCheck(a,"DynamicsWebApi.updateSingleProperty","select"),c("PUT",{collection:t,key:e,select:a,prefer:r,navigationProperty:o,data:{value:s}},"updateSingleProperty").then((function(e){return e.data}))},this.deleteRequest=function(e){i.parameterCheck(e,"DynamicsWebApi.delete","request");var t=e.ifmatch;return c("DELETE",e,"delete",{valueIfEmpty:!0}).then((function(e){return e.data})).catch((function(e){if(t&&412===e.status)return!1;throw e}))},this.deleteRecord=function(e,t,n){return i.stringParameterCheck(t,"DynamicsWebApi.deleteRecord","collection"),null!=n&&i.stringParameterCheck(n,"DynamicsWebApi.deleteRecord","propertyName"),c("DELETE",{navigationProperty:n,collection:t,key:e},"deleteRecord").then((function(){}))},this.upsertRequest=function(e){i.parameterCheck(e,"DynamicsWebApi.upsert","request");var t=e.ifnonematch,n=e.ifmatch;return c("PATCH",e,"upsert").then((function(e){return e.data})).catch((function(e){if(!(t&&412===e.status||n&&404===e.status))throw e}))},this.upsert=function(e,t,n,r,a){i.stringParameterCheck(e,"DynamicsWebApi.upsert","key"),e=i.keyParameterCheck(e,"DynamicsWebApi.upsert","key"),i.parameterCheck(n,"DynamicsWebApi.upsert","object"),i.stringParameterCheck(t,"DynamicsWebApi.upsert","collection"),r&&i.stringOrArrayParameterCheck(r,"DynamicsWebApi.upsert","prefer"),a&&i.arrayParameterCheck(a,"DynamicsWebApi.upsert","select");var o={collection:t,key:e,select:a,prefer:r,entity:n};return this.upsertRequest(o)};var u=function(e,t,n,i){return i=i||0,r.setFileChunk(e,t,n,i),c("PATCH",e,"uploadFile").then((function(r){if((i+=n)<=t.length)return u(e,t,n,i)}))};this.uploadFile=function(e){i.batchIncompatible("DynamicsWebApi.uploadFile",s),i.parameterCheck(e,"DynamicsWebApi.uploadFile","request");var t=e.data;delete e.data;var n=r.copyObject(e);return n.transferMode="chunked",e.data=t,c("PATCH",n,"uploadFile").then((function(t){return n.url=t.data.location,delete n.transferMode,delete n.fieldName,u(n,e.data,t.data.chunkSize)}))};var l=4194304,p=function(e,t,n,i){return t=t||0,n=n||0,i=i||"",e.range="bytes="+t+"-"+(t+l-1),e.downloadSize="full",c("GET",e,"downloadFile",{parse:!0}).then((function(n){return e.url=n.data.location,i+=n.data.value,(t+=l)<=n.data.fileSize?p(e,t,n.data.fileSize,i):{fileName:n.data.fileName,fileSize:n.data.fileSize,data:r.convertToFileBuffer(i)}}))};this.downloadFile=function(e){i.batchIncompatible("DynamicsWebApi.downloadFile",s),i.parameterCheck(e,"DynamicsWebApi.downloadFile","request");var t=r.copyObject(e);return p(t)};var h=function(e,t){return t&&(i.stringParameterCheck(t,"DynamicsWebApi.retrieveMultiple","nextPageLink"),e.url=t),c("GET",e,"retrieveMultiple").then((function(e){return e.data}))};this.retrieveMultipleRequest=h;var m=function(e,t,n){return n=n||[],h(e,t).then((function(t){n=n.concat(t.value);var r=t.oDataNextLink;if(r)return m(e,r,n);var i={value:n};return t.oDataDeltaLink&&(i["@odata.deltaLink"]=t.oDataDeltaLink,i.oDataDeltaLink=t.oDataDeltaLink),i}))};this.retrieveAllRequest=function(e){return i.batchIncompatible("DynamicsWebApi.retrieveAllRequest",s),m(e)},this.count=function(e,t){var n={collection:e};return null==t||null!=t&&!t.length?n.navigationProperty="$count":(n.filter=t,n.count=!0),c("GET",n,"count",{toCount:n.count}).then((function(e){return e.data}))},this.countAll=function(e,t,n){return i.batchIncompatible("DynamicsWebApi.countAll",s),m({collection:e,filter:t,select:n}).then((function(e){return e&&e.value?e.value.length:0}))},this.retrieveMultiple=function(e,t,n,r){return this.retrieveMultipleRequest({collection:e,select:t,filter:n},r)},this.retrieveAll=function(e,t,n){return i.batchIncompatible("DynamicsWebApi.retrieveAll",s),m({collection:e,select:t,filter:n})};var y=function(e,t,n,r,a,o){i.stringParameterCheck(t,"DynamicsWebApi.executeFetchXml","fetchXml"),r=r||1,i.numberParameterCheck(r,"DynamicsWebApi.executeFetchXml","pageNumber");var s='$1 page="'+r+'"';return null!=a&&(i.stringParameterCheck(a,"DynamicsWebApi.executeFetchXml","pagingCookie"),s+=' paging-cookie="'+a+'"'),t=t.replace(/^(<fetch)/,s),c("GET",{collection:e,includeAnnotations:n,impersonate:o,fetchXml:t},"executeFetchXml",{pageNumber:r}).then((function(e){return e.data}))};this.fetch=y,this.executeFetchXml=y;var f=function(e,t,n,r,i,a,o){return o=o||[],y(e,t,n,r,i,a).then((function(r){return o=o.concat(r.value),r.PagingInfo?f(e,t,n,r.PagingInfo.nextPage,r.PagingInfo.cookie,a,o):{value:o}}))},d=function(e,t,n,r){return i.batchIncompatible("DynamicsWebApi.executeFetchXmlAll",s),f(e,t,n,null,null,r)};this.fetchAll=d,this.executeFetchXmlAll=d,this.associate=function(e,t,n,r,a,o){return i.stringParameterCheck(r,"DynamicsWebApi.associate","relatedcollection"),i.stringParameterCheck(n,"DynamicsWebApi.associate","relationshipName"),t=i.keyParameterCheck(t,"DynamicsWebApi.associate","primaryKey"),a=i.keyParameterCheck(a,"DynamicsWebApi.associate","relatedKey"),c("POST",{_additionalUrl:n+"/$ref",collection:e,key:t,impersonate:o,data:{"@odata.id":r+"("+a+")"}},"associate").then((function(){}))},this.disassociate=function(e,t,n,r,a){return i.stringParameterCheck(n,"DynamicsWebApi.disassociate","relationshipName"),r=i.keyParameterCheck(r,"DynamicsWebApi.disassociate","relatedId"),c("DELETE",{_additionalUrl:n+"("+r+")/$ref",collection:e,key:t,impersonate:a},"disassociate").then((function(){}))},this.associateSingleValued=function(e,t,n,r,a,o){return a=i.keyParameterCheck(a,"DynamicsWebApi.associateSingleValued","relatedKey"),i.stringParameterCheck(n,"DynamicsWebApi.associateSingleValued","singleValuedNavigationPropertyName"),i.stringParameterCheck(r,"DynamicsWebApi.associateSingleValued","relatedcollection"),c("PUT",{_additionalUrl:n+"/$ref",collection:e,key:t,impersonate:o,data:{"@odata.id":r+"("+a+")"}},"associateSingleValued").then((function(){}))},this.disassociateSingleValued=function(e,t,n,r){return i.stringParameterCheck(n,"DynamicsWebApi.disassociateSingleValued","singleValuedNavigationPropertyName"),c("DELETE",{_additionalUrl:n+"/$ref",key:t,collection:e,impersonate:r},"disassociateSingleValued").then((function(){}))},this.executeUnboundFunction=function(e,t,n){return b(e,t,null,null,n,!0)},this.executeBoundFunction=function(e,t,n,r,i){return b(n,r,t,e,i)};var b=function(e,t,n,a,o,s){i.stringParameterCheck(e,"DynamicsWebApi.executeFunction","functionName");var u={_additionalUrl:e+r.buildFunctionParameters(t),_unboundRequest:s,key:a,collection:n,impersonate:o};return c("GET",u,"executeFunction").then((function(e){return e.data}))};this.executeUnboundAction=function(e,t,n){return g(e,t,null,null,n,!0)},this.executeBoundAction=function(e,t,n,r,i){return g(n,r,t,e,i)};var g=function(e,t,n,r,a,o){return i.stringParameterCheck(e,"DynamicsWebApi.executeAction","actionName"),c("POST",{_additionalUrl:e,_unboundRequest:o,collection:n,key:r,impersonate:a,data:t},"executeAction").then((function(e){return e.data}))};this.createEntity=function(e){i.parameterCheck(e,"DynamicsWebApi.createEntity","entityDefinition");var t={collection:"EntityDefinitions",entity:e};return this.createRequest(t)},this.updateEntity=function(e,t){i.parameterCheck(e,"DynamicsWebApi.updateEntity","entityDefinition"),i.guidParameterCheck(e.MetadataId,"DynamicsWebApi.updateEntity","entityDefinition.MetadataId");var n={collection:"EntityDefinitions",mergeLabels:t,key:e.MetadataId,entity:e};return this.updateRequest(n)},this.retrieveEntity=function(e,t,n){i.keyParameterCheck(e,"DynamicsWebApi.retrieveEntity","entityKey");var r={collection:"EntityDefinitions",key:e,select:t,expand:n};return this.retrieveRequest(r)},this.retrieveEntities=function(e,t){var n={collection:"EntityDefinitions",select:e,filter:t};return this.retrieveRequest(n)},this.createAttribute=function(e,t){i.keyParameterCheck(e,"DynamicsWebApi.createAttribute","entityKey"),i.parameterCheck(t,"DynamicsWebApi.createAttribute","attributeDefinition");var n={collection:"EntityDefinitions",key:e,entity:t,navigationProperty:"Attributes"};return this.createRequest(n)},this.updateAttribute=function(e,t,n,r){i.keyParameterCheck(e,"DynamicsWebApi.updateAttribute","entityKey"),i.parameterCheck(t,"DynamicsWebApi.updateAttribute","attributeDefinition"),i.guidParameterCheck(t.MetadataId,"DynamicsWebApi.updateAttribute","attributeDefinition.MetadataId"),n&&i.stringParameterCheck(n,"DynamicsWebApi.updateAttribute","attributeType");var a={collection:"EntityDefinitions",key:e,entity:t,navigationProperty:"Attributes",navigationPropertyKey:t.MetadataId,mergeLabels:r,metadataAttributeType:n};return this.updateRequest(a)},this.retrieveAttributes=function(e,t,n,r,a){i.keyParameterCheck(e,"DynamicsWebApi.retrieveAttributes","entityKey"),t&&i.stringParameterCheck(t,"DynamicsWebApi.retrieveAttributes","attributeType");var o={collection:"EntityDefinitions",key:e,navigationProperty:"Attributes",select:n,filter:r,expand:a,metadataAttributeType:t};return this.retrieveRequest(o)},this.retrieveAttribute=function(e,t,n,r,a){i.keyParameterCheck(e,"DynamicsWebApi.retrieveAttribute","entityKey"),i.keyParameterCheck(t,"DynamicsWebApi.retrieveAttribute","attributeKey"),n&&i.stringParameterCheck(n,"DynamicsWebApi.retrieveAttribute","attributeType");var o={collection:"EntityDefinitions",key:e,navigationProperty:"Attributes",select:r,expand:a,metadataAttributeType:n,navigationPropertyKey:t};return this.retrieveRequest(o)},this.createRelationship=function(e){i.parameterCheck(e,"DynamicsWebApi.createRelationship","relationshipDefinition");var t={collection:"RelationshipDefinitions",entity:e};return this.createRequest(t)},this.updateRelationship=function(e,t,n){i.parameterCheck(e,"DynamicsWebApi.updateRelationship","relationshipDefinition"),i.guidParameterCheck(e.MetadataId,"DynamicsWebApi.updateRelationship","relationshipDefinition.MetadataId");var r={collection:"RelationshipDefinitions",mergeLabels:n,key:e.MetadataId,entity:e,navigationProperty:t};return this.updateRequest(r)},this.deleteRelationship=function(e){i.keyParameterCheck(e,"DynamicsWebApi.deleteRelationship","metadataId");var t={collection:"RelationshipDefinitions",key:e};return this.deleteRequest(t)},this.retrieveRelationships=function(e,t,n){var r={collection:"RelationshipDefinitions",navigationProperty:e,select:t,filter:n};return this.retrieveMultipleRequest(r)},this.retrieveRelationship=function(e,t,n){i.keyParameterCheck(e,"DynamicsWebApi.retrieveRelationship","metadataId");var r={collection:"RelationshipDefinitions",navigationProperty:t,key:e,select:n};return this.retrieveRequest(r)},this.createGlobalOptionSet=function(e){i.parameterCheck(e,"DynamicsWebApi.createGlobalOptionSet","globalOptionSetDefinition");var t={collection:"GlobalOptionSetDefinitions",entity:e};return this.createRequest(t)},this.updateGlobalOptionSet=function(e,t){i.parameterCheck(e,"DynamicsWebApi.updateGlobalOptionSet","globalOptionSetDefinition"),i.guidParameterCheck(e.MetadataId,"DynamicsWebApi.updateGlobalOptionSet","globalOptionSetDefinition.MetadataId");var n={collection:"GlobalOptionSetDefinitions",mergeLabels:t,key:e.MetadataId,entity:e};return this.updateRequest(n)},this.deleteGlobalOptionSet=function(e){i.keyParameterCheck(e,"DynamicsWebApi.deleteGlobalOptionSet","globalOptionSetKey");var t={collection:"GlobalOptionSetDefinitions",key:e};return this.deleteRequest(t)},this.retrieveGlobalOptionSet=function(e,t,n){i.keyParameterCheck(e,"DynamicsWebApi.retrieveGlobalOptionSet","globalOptionSetKey");var r={collection:"GlobalOptionSetDefinitions",key:e,navigationProperty:t,select:n};return this.retrieveRequest(r)},this.retrieveGlobalOptionSets=function(e,t){var n={collection:"GlobalOptionSetDefinitions",navigationProperty:e,select:t};return this.retrieveMultipleRequest(n)},this.startBatch=function(){s=!0,t=r.generateUUID()},this.executeBatch=function(e){return e=e||{},i.parameterCheck(e,"DynamicsWebApi.executeBatch","request"),i.batchNotStarted(s),e.collection="$batch",s=!1,c("POST",e,"executeBatch").then((function(e){return e.data})).finally((function(){t=null}))},this.initializeInstance=function(e){return e||(e=n),new o(e)}}String.prototype.endsWith&&String.prototype.startsWith||n(200),o.prototype.utility={getCollectionName:a.getCollectionName},e.exports=o},535:e=>{function t(e,t,n){throw new Error(n?e+" requires the "+t+" parameter to be of type "+n:e+" requires the "+t+" parameter.")}var n={handleErrorResponse:function(e){throw new Error("Error: "+e.status+": "+e.message)},parameterCheck:function(e,n,r,i){null!=e&&""!=e||t(n,r,i)},stringParameterCheck:function(e,n,r){"string"!=typeof e&&t(n,r,"String")},arrayParameterCheck:function(e,n,r){e.constructor!==Array&&t(n,r,"Array")},stringOrArrayParameterCheck:function(e,n,r){e.constructor!==Array&&"string"!=typeof e&&t(n,r,"String or Array")},numberParameterCheck:function(e,n,r){if("number"!=typeof e){if("string"==typeof e&&e&&!isNaN(parseInt(e)))return;t(n,r,"Number")}},boolParameterCheck:function(e,n,r){"boolean"!=typeof e&&t(n,r,"Boolean")},guidParameterCheck:function(e,n,r){try{return/[0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12}/i.exec(e)[0]}catch(e){t(n,r,"GUID String")}},keyParameterCheck:function(e,r,i){try{n.stringParameterCheck(e,r,i);var a=/^{?([0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12})}?$/i.exec(e);if(a)return a[1];var o=e.split(",");if(o.length)for(var s=0;s<o.length;s++)o[s]=o[s].trim().replace('"',"'"),/^[\w\d\_]+\=('[^\'\r\n]+'|\d+)$/i.exec(o[s])[0];return o.join(",")}catch(e){t(r,i,"String representing GUID or Alternate Key")}},callbackParameterCheck:function(e,n,r){"function"!=typeof e&&t(n,r,"Function")},batchIncompatible:function(e,t){if(t)throw t=!1,new Error(e+" cannot be used in a BATCH request.")},batchNotStarted:function(e){if(!e)throw new Error("Batch operation has not been started. Please call a DynamicsWebApi.startBatch() function prior to calling DynamicsWebApi.executeBatch() to perform a batch request correctly.")},handleHttpError:function(e,t){var n=new Error;return Object.keys(e).forEach((function(t){n[t]=e[t]})),t&&Object.keys(t).forEach((function(e){n[e]=t[e]})),n}};e.exports=n},984:()=>{Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}},200:()=>{String.prototype.endsWith=function(e,t){var n=this.toString();("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>n.length)&&(t=n.length),t-=e.length;var r=n.lastIndexOf(e,t);return-1!==r&&r===t},String.prototype.startsWith=function(e,t){return t=t||0,this.substr(t,e.length)===e}},723:e=>{e.exports=function(e,t){var n;return"string"==typeof t&&(n=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:Z|[-+]\d{2}:\d{2})$/.exec(t))?new Date(Date.UTC(+n[1],+n[2]-1,+n[3],+n[4],+n[5],+n[6])):t}},49:(e,t,n)=>{var r=n(923),i=n(389),a=n(535),o=n(723);function s(e,t){var n=null;if(-1!==e.indexOf("@")){var i=e.split("@");switch(i[1]){case"odata.context":n="oDataContext";break;case"odata.count":n="oDataCount",t=null!=t?parseInt(t):0;break;case"odata.nextLink":n="oDataNextLink";break;case"odata.deltaLink":n="oDataDeltaLink";break;case r.Prefer.Annotations.FormattedValue:n=i[0]+"_Formatted";break;case r.Prefer.Annotations.AssociatedNavigationProperty:n=i[0]+"_NavigationProperty";break;case r.Prefer.Annotations.LookupLogicalName:n=i[0]+"_LogicalName"}}return[n,t]}function c(e,t){if(t){if(t.isRef&&null!=e["@odata.id"])return i.convertToReferenceObject(e);if(t.toCount)return s("@odata.count",e["@odata.count"])[1]||0}for(var n=Object.keys(e),a=0;a<n.length;a++){var o=n[a];if(null!=e[o])if(e[o].constructor===Array)for(var u=0;u<e[o].length;u++)e[o][u]=c(e[o][u]);else"object"==typeof e[o]&&c(e[o]);var l=s(o,e[o]);if(l[0]&&(e[l[0]]=l[1]),-1!==o.indexOf("_x002e_")){var p=o.split("_x002e_");if(e.hasOwnProperty(p[0])){if("object"!=typeof e[p[0]]||"object"==typeof e[p[0]]&&!e[p[0]].hasOwnProperty("_dwaType"))throw new Error("The alias name of the linked entity must be unique!")}else e[p[0]]={_dwaType:"alias"};e[p[0]][p[1]]=e[o],(l=s(p[1],e[o]))[0]&&(e[p[0]][l[0]]=l[1])}}return t&&t.hasOwnProperty("pageNumber")&&null!=e["@"+r.Prefer.Annotations.FetchXmlPagingCookie]&&(e.PagingInfo=i.getFetchXmlPagingCookie(e["@"+r.Prefer.Annotations.FetchXmlPagingCookie],t.pageNumber)),e}String.prototype.endsWith&&String.prototype.startsWith||n(200);var u=/^([^()<>@,;:\\"\/[\]?={} \t]+)\s?:\s?(.*)/;function l(e){var t,n,r,i={},a={position:0};do{r=a.position,n=p(e,a),null!==(t=u.exec(n))?i[t[1].toLowerCase()]=t[2]:a.position=r}while(n&&t);return i}function p(e,t){return function(e,t,n){var r=t.position||0,i=e.length;if(n){if(-1===(i=e.indexOf(n,r)))return null;t.position=i+n.length}else t.position=i;return e.substring(r,i)}(e,t,"\r\n")}function h(e,t,n){var r=e.substr(0,e.indexOf("\r\n")),i=e.split(r);i.shift(),i.pop(),n=n||0;for(var s=[],u=0;u<i.length;u++){var p=i[u];if(p.indexOf("--changesetresponse_")>-1){var m=(p=p.trim()).substring(p.indexOf("\r\n")+1).trim();s=s.concat(h(m,t,n))}else{var y=/HTTP\/?\s*[\d.]*\s+(\d{3})\s+([\w\s]*)$/gm.exec(p),f=parseInt(y[1]),d=y[2].trim(),b=p.substring(p.indexOf("{"),p.lastIndexOf("}")+1);if(b){var g=c(JSON.parse(b,o),t[n]);if(f>=400){var A=l(p.substring(p.indexOf(y[0])+y[0].length+1,p.indexOf("{")));s.push(a.handleHttpError(g,{status:f,statusText:d,statusMessage:d,headers:A}))}else s.push(g)}else if(/Content-Type: text\/plain/i.test(p)){var k=/\w+$/gi.exec(p.trim()),v=k&&k.length?k[0]:void 0;s.push(isNaN(v)?v:parseInt(v))}else if(t.length&&t[n]&&t[n].hasOwnProperty("valueIfEmpty"))s.push(t[n].valueIfEmpty);else{var D=/OData-EntityId.+/i.exec(p);if(D&&D.length){var C=/([0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12})\)$/i.exec(D[0]);s.push(C?C[1]:void 0)}else s.push(void 0)}}n++}return s}function m(e,t,n){var r,i=e;n.hasOwnProperty("parse")&&(i=JSON.parse(i).value,r=i,i=window.atob(r));var a={value:i};return t["x-ms-file-name"]&&(a.fileName=t["x-ms-file-name"]),t["x-ms-file-size"]&&(a.fileSize=parseInt(t["x-ms-file-size"])),y(t,"Location")&&(a.location=f(t,"Location")),a}function y(e,t){return e.hasOwnProperty(t)||e.hasOwnProperty(t.toLowerCase())}function f(e,t){return e[t]?e[t]:e[t.toLowerCase()]}e.exports=function(e,t,n){var r=void 0;if(e.length)if(e.indexOf("--batchresponse_")>-1){var i=h(e,n);r=1===n.length&&n[0].convertedToBatch?i[0]:i}else r=y(t,"Content-Disposition")?m(e,t,n[0]):c(JSON.parse(e,o),n[0]);else if(n.length&&n[0].hasOwnProperty("valueIfEmpty"))r=n[0].valueIfEmpty;else if(y(t,"OData-EntityId")){var a=f(t,"OData-EntityId"),s=/([0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12})\)$/i.exec(a);s&&(r=s[1])}else y(t,"Location")&&(r={location:f(t,"Location")},t["x-ms-chunk-size"]&&(r.chunkSize=parseInt(t["x-ms-chunk-size"])));return r}},364:e=>{e.exports=function(e){var t={};if(!e)return t;for(var n=e.split("\r\n"),r=0,i=n.length;r<i;r++){var a=n[r],o=a.indexOf(": ");o>0&&(t[a.substring(0,o)]=a.substring(o+2))}return t}},67:(e,t,n)=>{var r,i=n(389),a=n(359);function o(e){var t=i.getXrmInternal();if(!i.isNull(t)&&"function"==typeof t.getEntitySetName)return t.getEntitySetName(e)||e;var n=null;if(!i.isNull(r)&&(n=r[e],i.isNull(n)))for(var a in r)if(r[a]===e)return e;return n}function s(e){return e.Accept="application/json",e["OData-MaxVersion"]="4.0",e["OData-Version"]="4.0",e["Content-Type"]=e["Content-Range"]?"application/octet-stream":"application/json; charset=utf-8",e}function c(e,t){var n;if(e){if(e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array)return e;n=(n=JSON.stringify(e,(function(e,n){if(e.endsWith("@odata.bind")||e.endsWith("@odata.id")){if("string"==typeof n&&!n.startsWith("$")){if(/\(\{[\w\d-]+\}\)/g.test(n)&&(n=n.replace(/(.+)\(\{([\w\d-]+)\}\)/g,"$1($2)")),t.useEntityNames){var r=/([\w_]+)(\([\d\w-]+\))$/,a=r.exec(n);if(a.length>2){var s=o(a[1]);i.isNull(s)||(n=n.replace(r,s+"$2"))}}n.startsWith(t.webApiUrl)||(e.endsWith("@odata.bind")?n.startsWith("/")||(n="/"+n):n=t.webApiUrl+n.replace(/^\//,""))}}else(e.startsWith("oData")||e.endsWith("_Formatted")||e.endsWith("_NavigationProperty")||e.endsWith("_LogicalName"))&&(n=void 0);return n}))).replace(/[\u007F-\uFFFF]/g,(function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).substr(-4)}))}return n}var u={},l={};function p(e,t){l[e]?l[e].push(t):l[e]=[t]}function h(e,t,r,h,m,y,f,d,b,g,A,k){m=m||{},y=y||{},p(k=k||i.generateUUID(),y);var v,D=c(h,r);if("$batch"===t){var C=function(e,t){for(var n="dwa_batch_"+i.generateUUID(),r=[],s=null,u=1e5,l=0;l<e.length;l++){var p=e[l].request;t.useEntityNames&&(p.collection=o(p.collection)||p.collection);var h=a.convertRequest(p,"executeBatch",t),m=e[l].method,y="GET"===m;if(y&&s&&(r.push("\n--"+s+"--"),s=null,u=1e5),s||(r.push("\n--"+n),y||(s="changeset_"+i.generateUUID(),r.push("Content-Type: multipart/mixed;boundary="+s))),y||r.push("\n--"+s),r.push("Content-Type: application/http"),r.push("Content-Transfer-Encoding: binary"),!y){var f=h.headers.hasOwnProperty("Content-ID")?h.headers["Content-ID"]:++u;r.push("Content-ID: "+f)}for(var d in h.url.startsWith("$")?r.push("\n"+m+" "+h.url+" HTTP/1.1"):r.push("\n"+m+" "+t.webApiUrl+h.url+" HTTP/1.1"),y?r.push("Accept: application/json"):r.push("Content-Type: application/json"),h.headers)"Authorization"!==d&&"Content-ID"!==d&&r.push(d+": "+h.headers[d]);var b=p.data||p.entity;!y&&b&&r.push("\n"+c(b,t))}return s&&r.push("\n--"+s+"--"),r.push("\n--"+n+"--"),{boundary:n,body:r.join("\n")}}(u[k],r);D=C.body,delete u[k],(m=s(m))["Content-Type"]="multipart/mixed;boundary="+C.boundary}else m=s(m);if(y.convertedToBatch=!1,t.length>2e3){var P="dwa_batch_"+i.generateUUID(),W=[];for(var x in W.push("--"+P),W.push("Content-Type: application/http"),W.push("Content-Transfer-Encoding: binary\n"),W.push(e+" "+r.webApiUrl+t+" HTTP/1.1"),m)"Authorization"!==x&&(W.push(x+": "+m[x]),delete m[x]);W.push("\n--"+P+"--"),D=W.join("\n"),(m=s(m))["Content-Type"]="multipart/mixed;boundary="+P,t="$batch",e="POST",y.convertedToBatch=!0}r.impersonate&&!m.MSCRMCallerID&&(m.MSCRMCallerID=r.impersonate),r.impersonateAAD&&!m.CallerObjectId&&(m.CallerObjectId=r.impersonateAAD),v=n(105);var R=function(n){n&&(m||(m={}),m.Authorization="Bearer "+(n.hasOwnProperty("accessToken")?n.accessToken:n)),v({method:e,uri:r.webApiUrl+t,data:D,requestId:k,additionalHeaders:m,responseParams:l,successCallback:f,errorCallback:d,isAsync:g,timeout:A,requestId:k})};r.onTokenRefresh&&(!m||m&&!m.Authorization)?r.onTokenRefresh(R):R()}function m(e,t,n,s){if(function(e){return["EntityDefinitions","$metadata","RelationshipDefinitions","GlobalOptionSetDefinitions","ManagedPropertyDefinitions"].indexOf(e)>-1}(e)||i.isNull(e))n(e);else if(e=e.toLowerCase(),t.useEntityNames)try{!function(e,t,n,s){if(i.isNull(r)){var c=a.convertRequest({collection:"EntityDefinitions",select:["EntitySetName","LogicalName"],noCache:!0},"retrieveMultiple",t);h("GET",c.url,t,null,c.headers,null,(function(t){r={};for(var i=0;i<t.data.value.length;i++)r[t.data.value[i].LogicalName]=t.data.value[i].EntitySetName;n(o(e)||e)}),(function(e){s({message:"Unable to fetch EntityDefinitions. Error: "+e.message})}),0,c.async,t.timeout)}else n(o(e)||e)}(e,t,n,s)}catch(e){s({message:"Unable to fetch Collection Names. Error: "+e.message})}else n(e)}e.exports={sendRequest:h,makeRequest:function(e,t,n,r,o,s,c){t.isBatch?(p(t.requestId,o||{}),function(e,t){u[e]?u[e].push(t):u[e]=[t]}(t.requestId,{method:e,request:i.copyObject(t)}),delete t.isBatch,delete t.requestId,a.convertRequest(t,n,r)):m(t.collection,r,(function(i){t.collection=i;var u=a.convertRequest(t,n,r),l=t.requestId;delete t.requestId,h(e,u.url,r,t.data||t.entity,u.headers,o,s,c,t.isBatch,u.async,t.timeout||r.timeout,l)}),c)},getCollectionName:o}},105:(e,t,n)=>{var r=n(49),i=n(364),a=n(535);Array.isArray||n(984),e.exports=function(e){var t=e.method,n=e.uri,o=e.data,s=e.additionalHeaders,c=e.responseParams,u=e.successCallback,l=e.errorCallback,p=e.isAsync,h=e.requestId,m=new XMLHttpRequest;for(var y in m.open(t,n,p),s)m.setRequestHeader(y,s[y]);m.onreadystatechange=function(){if(4===m.readyState)switch(m.status){case 200:case 201:case 204:case 304:var e=i(m.getAllResponseHeaders()),t={data:r(m.responseText,e,c[h]),headers:e,status:m.status};delete c[h],m=null,u(t);break;case 206:u(!0);break;default:var n;try{var o=i(m.getAllResponseHeaders()),s=r(m.responseText,o,c[h]);if(Array.isArray(s)){l(s);break}n=s.error}catch(e){n=m.response.length>0?{message:m.response}:{message:"Unexpected Error"}}var p={status:m.status,statusText:m.statusText,headers:o};delete c[h],m=null,l(a.handleHttpError(n,p))}},e.timeout&&(m.timeout=e.timeout),m.onerror=function(){var e=i(m.getAllResponseHeaders());l(a.handleHttpError({status:m.status,statusText:m.statusText,message:m.responseText||"Network Error",headers:e})),delete c[h],m=null},m.ontimeout=function(){var e=i(m.getAllResponseHeaders());l(a.handleHttpError({status:m.status,statusText:m.statusText,message:m.responseText||"Request Timed Out",headers:e})),delete c[h],m=null},o?m.send(o):m.send()}},359:(e,t,n)=>{"use strict";n(923);var r=n(535),i=n(956);function a(e,t,n,o,s){var c={},u=[];if(o=null!=o?o:"&",e){if(e.navigationProperty&&(r.stringParameterCheck(e.navigationProperty,"DynamicsWebApi."+t,"request.navigationProperty"),n+="/"+e.navigationProperty,e.navigationPropertyKey&&(n+="("+r.keyParameterCheck(e.navigationPropertyKey,"DynamicsWebApi."+t,"request.navigationPropertyKey")+")"),"Attributes"===e.navigationProperty&&e.metadataAttributeType&&(r.stringParameterCheck(e.metadataAttributeType,"DynamicsWebApi."+t,"request.metadataAttributeType"),n+="/"+e.metadataAttributeType)),null!=e.select&&e.select.length&&(r.arrayParameterCheck(e.select,"DynamicsWebApi."+t,"request.select"),"retrieve"==t&&1==e.select.length&&e.select[0].endsWith("/$ref")?n+="/"+e.select[0]:(e.select[0].startsWith("/")&&"retrieve"==t&&(null==e.navigationProperty?n+=e.select.shift():e.select.shift()),e.select.length&&u.push("$select="+e.select.join(",")))),e.filter){r.stringParameterCheck(e.filter,"DynamicsWebApi."+t,"request.filter");for(var l,p=/[^"']{([\w\d]{8}[-]?(?:[\w\d]{4}[-]?){3}[\w\d]{12})}(?:[^"']|$)/g,h=e.filter;null!==(l=p.exec(h));){var m=l[0].endsWith(")")?")":" ";h=h.replace(l[0]," "+l[1]+m)}u.push("$filter="+encodeURIComponent(h))}e.fieldName&&(r.stringParameterCheck(e.fieldName,"DynamicsWebApi."+t,"request.fieldName"),n+="/"+e.fieldName),e.savedQuery&&u.push("savedQuery="+r.guidParameterCheck(e.savedQuery,"DynamicsWebApi."+t,"request.savedQuery")),e.userQuery&&u.push("userQuery="+r.guidParameterCheck(e.userQuery,"DynamicsWebApi."+t,"request.userQuery")),e.apply&&(r.stringParameterCheck(e.apply,"DynamicsWebApi."+t,"request.apply"),u.push("$apply="+e.apply)),e.count&&(r.boolParameterCheck(e.count,"DynamicsWebApi."+t,"request.count"),u.push("$count="+e.count)),e.top&&e.top>0&&(r.numberParameterCheck(e.top,"DynamicsWebApi."+t,"request.top"),u.push("$top="+e.top)),null!=e.orderBy&&e.orderBy.length&&(r.arrayParameterCheck(e.orderBy,"DynamicsWebApi."+t,"request.orderBy"),u.push("$orderby="+e.orderBy.join(","))),e.downloadSize&&(r.stringParameterCheck(e.downloadSize,"DynamicsWebApi."+t,"request.downloadSize"),u.push("size="+e.downloadSize)),e.fileName&&(r.stringParameterCheck(e.fileName,"DynamicsWebApi."+t,"request.fileName"),u.push("x-ms-file-name="+e.fileName));var y=i(e,t,s);if(y.length&&(c.Prefer=y),null!=e.ifmatch&&null!=e.ifnonematch)throw new Error("DynamicsWebApi."+t+". Either one of request.ifmatch or request.ifnonematch parameters should be used in a call, not both.");if(e.transferMode&&(c["x-ms-transfer-mode"]=e.transferMode),e.ifmatch&&(r.stringParameterCheck(e.ifmatch,"DynamicsWebApi."+t,"request.ifmatch"),c["If-Match"]=e.ifmatch),e.ifnonematch&&(r.stringParameterCheck(e.ifnonematch,"DynamicsWebApi."+t,"request.ifnonematch"),c["If-None-Match"]=e.ifnonematch),e.impersonate&&(r.stringParameterCheck(e.impersonate,"DynamicsWebApi."+t,"request.impersonate"),c.MSCRMCallerID=r.guidParameterCheck(e.impersonate,"DynamicsWebApi."+t,"request.impersonate")),e.impersonateAAD&&(r.stringParameterCheck(e.impersonateAAD,"DynamicsWebApi."+t,"request.impersonateAAD"),c.CallerObjectId=r.guidParameterCheck(e.impersonateAAD,"DynamicsWebApi."+t,"request.impersonateAAD")),e.token&&(r.stringParameterCheck(e.token,"DynamicsWebApi."+t,"request.token"),c.Authorization="Bearer "+e.token),e.duplicateDetection&&(r.boolParameterCheck(e.duplicateDetection,"DynamicsWebApi."+t,"request.duplicateDetection"),c["MSCRM.SuppressDuplicateDetection"]="false"),e.entity&&r.parameterCheck(e.entity,"DynamicsWebApi."+t,"request.entity"),e.data&&r.parameterCheck(e.data,"DynamicsWebApi."+t,"request.data"),e.contentRange&&(r.stringParameterCheck(e.contentRange,"DynamicsWebApi."+t,"request.contentRange"),c["Content-Range"]=e.contentRange),e.range&&(r.stringParameterCheck(e.range,"DynamicsWebApi."+t,"request.range"),c.Range=e.range),e.noCache&&(r.boolParameterCheck(e.noCache,"DynamicsWebApi."+t,"request.noCache"),c["Cache-Control"]="no-cache"),e.mergeLabels&&(r.boolParameterCheck(e.mergeLabels,"DynamicsWebApi."+t,"request.mergeLabels"),c["MSCRM.MergeLabels"]="true"),e.contentId&&(r.stringParameterCheck(e.contentId,"DynamicsWebApi."+t,"request.contentId"),e.contentId.startsWith("$")||(c["Content-ID"]=e.contentId)),e.isBatch&&r.boolParameterCheck(e.isBatch,"DynamicsWebApi."+t,"request.isBatch"),e.timeout&&r.numberParameterCheck(e.timeout,"DynamicsWebApi."+t,"request.timeout"),e.expand&&e.expand.length)if(r.stringOrArrayParameterCheck(e.expand,"DynamicsWebApi."+t,"request.expand"),"string"==typeof e.expand)u.push("$expand="+e.expand);else{for(var f=[],d=0;d<e.expand.length;d++)if(e.expand[d].property){var b=a(e.expand[d],t+" $expand",null,";").query;b&&b.length&&(b="("+b+")"),f.push(e.expand[d].property+b)}f.length&&u.push("$expand="+f.join(","))}}return{url:n,query:u.join(o),headers:c}}var o={convertRequestOptions:a,convertRequest:function(e,t,n){var i,o="";return e.url?(r.stringParameterCheck(e.url,"DynamicsWebApi."+t,"request.url"),o=e.url.replace(n.webApiUrl,""),i=a(e,t,o,"&",n)):(e._unboundRequest||e.collection||r.parameterCheck(e.collection,"DynamicsWebApi."+t,"request.collection"),e.collection&&(r.stringParameterCheck(e.collection,"DynamicsWebApi."+t,"request.collection"),o=e.collection,e.contentId&&(r.stringParameterCheck(e.contentId,"DynamicsWebApi."+t,"request.contentId"),e.contentId.startsWith("$")&&(o=e.contentId+"/"+o)),e.key?e.key=r.keyParameterCheck(e.key,"DynamicsWebApi."+t,"request.key"):e.id&&(e.key=r.guidParameterCheck(e.id,"DynamicsWebApi."+t,"request.id")),e.key&&(o+="("+e.key+")")),e._additionalUrl&&(o&&(o+="/"),o+=e._additionalUrl),i=a(e,t,o,"&",n),e.fetchXml?(r.stringParameterCheck(e.fetchXml,"DynamicsWebApi."+t,"request.fetchXml"),i.url+="?fetchXml="+encodeURIComponent(e.fetchXml)):i.query&&(i.url+="?"+i.query)),e.hasOwnProperty("async")&&null!=e.async?(r.boolParameterCheck(e.async,"DynamicsWebApi."+t,"request.async"),i.async=e.async):i.async=!0,{url:i.url,headers:i.headers,async:i.async}}};e.exports=o},389:(e,t,n)=>{var r=window.crypto;function i(e){return void 0===e||null==e}function a(){if("undefined"!=typeof GetGlobalContext)return GetGlobalContext();if("undefined"!=typeof Xrm){if(!i(Xrm.Utility)&&!i(Xrm.Utility.getGlobalContext))return Xrm.Utility.getGlobalContext();if(!i(Xrm.Page)&&!i(Xrm.Page.context))return Xrm.Page.context}throw new Error("Xrm Context is not available. In most cases, it can be resolved by adding a reference to a ClientGlobalContext.js.aspx. Please refer to MSDN documentation for more details.")}function o(){var e=a().getClientUrl();return e.match(/\/$/)&&(e=e.substring(0,e.length-1)),e}var s={buildFunctionParameters:n(390),getFetchXmlPagingCookie:n(458),convertToReferenceObject:n(875),isNull:i,generateUUID:function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^r.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)))},getXrmContext:a,getXrmInternal:function(){return"undefined"!=typeof Xrm?Xrm.Internal:null},getXrmUtility:function(){return"undefined"!=typeof Xrm?Xrm.Utility:null},getClientUrl:o,initWebApiUrl:function(e){return o()+"/api/data/v"+e+"/"},copyObject:function e(t){var n,r={};for(var i in t)t.hasOwnProperty(i)&&("object"==typeof(n=t[i])&&n&&"[object Date]"!==Object.prototype.toString.call(t[i])?Array.isArray(t[i])?r[i]=t[i].slice():r[i]=e(t[i]):r[i]=t[i]);return r},setFileChunk:function(e,t,n,r){var i,a=(r=r||0)+n>t.length?t.length%n:n;i=new Uint8Array(a);for(var o=0;o<a;o++)i[o]=t[r+o];e.data=i,e.contentRange="bytes "+r+"-"+(r+a-1)+"/"+t.length},convertToFileBuffer:function(e){for(var t=new Uint8Array(data.length),n=0;n<data.length;n++)t[n]=data.charCodeAt(n);return t}};e.exports=s},390:e=>{e.exports=function(e){if(e){for(var t=Object.keys(e),n="",r="",i=1;i<=t.length;i++){var a=t[i-1],o=e[a];null!==o&&("string"!=typeof o||o.startsWith("Microsoft.Dynamics.CRM")?"object"==typeof o&&(o=JSON.stringify(o)):o="'"+o+"'",i>1&&(n+=",",r+="&"),n+=a+"=@p"+i,r+="@p"+i+"="+o)}return"("+n+")?"+r}return"()"}},956:(e,t,n)=>{var r=n(923),i=n(535);e.exports=function(e,t,n){var a,o=e.returnRepresentation,s=e.includeAnnotations,c=e.maxPageSize,u=e.trackChanges;if(e.prefer&&e.prefer.length)for(var l in i.stringOrArrayParameterCheck(e.prefer,"DynamicsWebApi."+t,"request.prefer"),"string"==typeof(a=e.prefer)&&(a=a.split(",")),a){var p=a[l].trim();p===r.Prefer.ReturnRepresentation?o=!0:p.indexOf("odata.include-annotations=")>-1?s=p.replace("odata.include-annotations=","").replace(/"/g,""):p.startsWith("odata.maxpagesize=")?c=p.replace("odata.maxpagesize=","").replace(/"/g,""):p.indexOf("odata.track-changes")>-1&&(u=!0)}return a=[],n&&(null==o&&(o=n.returnRepresentation),s=s||n.includeAnnotations,c=c||n.maxPageSize),o&&(i.boolParameterCheck(o,"DynamicsWebApi."+t,"request.returnRepresentation"),a.push(r.Prefer.ReturnRepresentation)),s&&(i.stringParameterCheck(s,"DynamicsWebApi."+t,"request.includeAnnotations"),a.push('odata.include-annotations="'+s+'"')),c&&c>0&&(i.numberParameterCheck(c,"DynamicsWebApi."+t,"request.maxPageSize"),a.push("odata.maxpagesize="+c)),u&&(i.boolParameterCheck(u,"DynamicsWebApi."+t,"request.trackChanges"),a.push("odata.track-changes")),a.join(",")}},875:e=>{e.exports=function(e){var t=/\/(\w+)\(([0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12})/i.exec(e["@odata.id"]);return{id:t[2],collection:t[1],oDataContext:e["@odata.context"]}}},458:e=>{e.exports=function(e,t){e=e||"",t=t||1,e=unescape(unescape(e));var n=/pagingcookie="(<cookie page="(\d+)".+<\/cookie>)/.exec(e);if(null!=n){var r=parseInt(n[2]);return{cookie:n[1].replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"'").replace(/\'/g,"&quot;"),page:r,nextPage:r+1}}return{cookie:"",page:t,nextPage:t+1}}}},t={},function n(r){if(t[r])return t[r].exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}(530);var e,t}));