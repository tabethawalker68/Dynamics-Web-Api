/*! dynamics-web-api-callbacks v1.6.15 (c) 2020 Aleksandr Rogov */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("DynamicsWebApi",[],t):"object"==typeof exports?exports.DynamicsWebApi=t():e.DynamicsWebApi=t()}(self,(function(){return e={923:e=>{var t={Types:{ResponseBase:function(){this.oDataContext=""},Response:function(){t.Types.ResponseBase.call(this),this.value={}},ReferenceResponse:function(){t.Types.ResponseBase.call(this),this.id="",this.collection=""},MultipleResponse:function(){t.Types.ResponseBase.call(this),this.oDataNextLink="",this.oDataCount=0,this.value=[]},FetchXmlResponse:function(){t.Types.ResponseBase.call(this),this.value=[],this.PagingInfo={cookie:"",page:0,nextPage:1}}},Prefer:{ReturnRepresentation:"return=representation",Annotations:{AssociatedNavigationProperty:"Microsoft.Dynamics.CRM.associatednavigationproperty",LookupLogicalName:"Microsoft.Dynamics.CRM.lookuplogicalname",All:"*",FormattedValue:"OData.Community.Display.V1.FormattedValue",FetchXmlPagingCookie:"Microsoft.Dynamics.CRM.fetchxmlpagingcookie"}}};e.exports=t},228:(e,t,a)=>{a(923);var i=a(389),r=(a(359),a(535)),n=a(67);function c(e){var t,a={webApiVersion:"8.0",webApiUrl:"",impersonate:null,impersonateAAD:null,onTokenRefresh:null,includeAnnotations:null,maxPageSize:null,returnRepresentation:null},s=!1;e||(e=a),this.setConfig=function(e){var t=(e.webApiVersion||a.webApiVersion)!==a.webApiVersion;e.webApiVersion&&(r.stringParameterCheck(e.webApiVersion,"DynamicsWebApi.setConfig","config.webApiVersion"),a.webApiVersion=e.webApiVersion),e.webApiUrl?(r.stringParameterCheck(e.webApiUrl,"DynamicsWebApi.setConfig","config.webApiUrl"),a.webApiUrl=e.webApiUrl):a.webApiUrl&&!t||(a.webApiUrl=i.initWebApiUrl(a.webApiVersion)),e.impersonate&&(a.impersonate=r.guidParameterCheck(e.impersonate,"DynamicsWebApi.setConfig","config.impersonate")),e.impersonateAAD&&(a.impersonateAAD=r.guidParameterCheck(e.impersonateAAD,"DynamicsWebApi.setConfig","config.impersonateAAD")),e.onTokenRefresh&&(r.callbackParameterCheck(e.onTokenRefresh,"DynamicsWebApi.setConfig","config.onTokenRefresh"),a.onTokenRefresh=e.onTokenRefresh),e.includeAnnotations&&(r.stringParameterCheck(e.includeAnnotations,"DynamicsWebApi.setConfig","config.includeAnnotations"),a.includeAnnotations=e.includeAnnotations),e.maxPageSize&&(r.numberParameterCheck(e.maxPageSize,"DynamicsWebApi.setConfig","config.maxPageSize"),a.maxPageSize=e.maxPageSize),e.returnRepresentation&&(r.boolParameterCheck(e.returnRepresentation,"DynamicsWebApi.setConfig","config.returnRepresentation"),a.returnRepresentation=e.returnRepresentation),e.useEntityNames&&(r.boolParameterCheck(e.useEntityNames,"DynamicsWebApi.setConfig","config.useEntityNames"),a.useEntityNames=e.useEntityNames)},this.setConfig(e);var o=function(e,i,r,c,o,l){i.isBatch=s,i.requestId=t,n.makeRequest(e,i,r,a,l,c,o)};this.createRequest=function(e,t,a){r.parameterCheck(e,"DynamicsWebApi.create","request"),s||(r.callbackParameterCheck(t,"DynamicsWebApi.create","successCallback"),r.callbackParameterCheck(a,"DynamicsWebApi.create","errorCallback")),o("POST",e,"create",(function(e){t(e.data)}),a)},this.create=function(e,t,a,i,n,c){r.parameterCheck(e,"DynamicsWebApi.create","object"),r.stringParameterCheck(t,"DynamicsWebApi.create","collection"),n&&r.stringOrArrayParameterCheck(n,"DynamicsWebApi.create","prefer"),c&&r.arrayParameterCheck(c,"DynamicsWebApi.create","select");var s={collection:t,select:c,prefer:n,entity:e};this.createRequest(s,a,i)},this.updateRequest=function(e,t,a){r.parameterCheck(e,"DynamicsWebApi.update","request"),s||(r.callbackParameterCheck(t,"DynamicsWebApi.update","successCallback"),r.callbackParameterCheck(a,"DynamicsWebApi.update","errorCallback")),null==e.ifmatch&&(e.ifmatch="*");var i=e.ifmatch,n=/EntityDefinitions|RelationshipDefinitions|GlobalOptionSetDefinitions/.test(e.collection)?"PUT":"PATCH";o(n,e,"update",(function(e){t(e.data)}),(function(e){i&&412===e.status?t(!1):a(e)}),{valueIfEmpty:!0})},this.update=function(e,t,a,i,n,c,o){r.stringParameterCheck(e,"DynamicsWebApi.update","key"),e=r.keyParameterCheck(e,"DynamicsWebApi.update","key"),r.parameterCheck(a,"DynamicsWebApi.update","object"),r.stringParameterCheck(t,"DynamicsWebApi.update","collection"),s||(r.callbackParameterCheck(i,"DynamicsWebApi.update","successCallback"),r.callbackParameterCheck(n,"DynamicsWebApi.update","errorCallback")),c&&r.stringOrArrayParameterCheck(c,"DynamicsWebApi.update","prefer"),o&&r.arrayParameterCheck(o,"DynamicsWebApi.update","select");var l={collection:t,key:e,select:o,prefer:c,entity:a};this.updateRequest(l,i,n)},this.updateSingleProperty=function(e,t,a,i,n,c,l){r.stringParameterCheck(e,"DynamicsWebApi.updateSingleProperty","key"),e=r.keyParameterCheck(e,"DynamicsWebApi.updateSingleProperty","key"),r.parameterCheck(a,"DynamicsWebApi.updateSingleProperty","keyValuePair"),r.stringParameterCheck(t,"DynamicsWebApi.updateSingleProperty","collection"),s||(r.callbackParameterCheck(i,"DynamicsWebApi.updateSingleProperty","successCallback"),r.callbackParameterCheck(n,"DynamicsWebApi.updateSingleProperty","errorCallback")),c&&r.stringOrArrayParameterCheck(c,"DynamicsWebApi.updateSingleProperty","prefer"),l&&r.arrayParameterCheck(l,"DynamicsWebApi.updateSingleProperty","select");var u=Object.keys(a)[0],p=a[u];o("PUT",{collection:t,key:e,select:l,prefer:c,navigationProperty:u,data:{value:p}},"updateSingleProperty",(function(e){i(e.data)}),n)},this.deleteRequest=function(e,t,a){r.parameterCheck(e,"DynamicsWebApi.delete","request"),s||(r.callbackParameterCheck(t,"DynamicsWebApi.delete","successCallback"),r.callbackParameterCheck(a,"DynamicsWebApi.delete","errorCallback"));var i=e.ifmatch;o("DELETE",e,"delete",(function(e){t(e.data)}),(function(e){i&&412===e.status?t(!1):a(e)}),{valueIfEmpty:!0})},this.deleteRecord=function(e,t,a,i,n){r.stringParameterCheck(e,"DynamicsWebApi.delete","key"),e=r.keyParameterCheck(e,"DynamicsWebApi.delete","key"),r.stringParameterCheck(t,"DynamicsWebApi.delete","collection"),s||(r.callbackParameterCheck(a,"DynamicsWebApi.delete","successCallback"),r.callbackParameterCheck(i,"DynamicsWebApi.delete","errorCallback")),null!=n&&r.stringParameterCheck(n,"DynamicsWebApi.delete","propertyName"),o("DELETE",{key:e,collection:t,navigationProperty:n},"delete",(function(e){a()}),i)},this.retrieveRequest=function(e,t,a){r.parameterCheck(e,"DynamicsWebApi.retrieve","request"),s||(r.callbackParameterCheck(t,"DynamicsWebApi.retrieve","successCallback"),r.callbackParameterCheck(a,"DynamicsWebApi.retrieve","errorCallback"));var i=null!=e.select&&1===e.select.length&&e.select[0].endsWith("/$ref");o("GET",e,"retrieve",(function(e){t(e.data)}),a,{isRef:i})},this.retrieve=function(e,t,a,i,n,c){r.stringParameterCheck(e,"DynamicsWebApi.retrieve","key"),e=r.keyParameterCheck(e,"DynamicsWebApi.retrieve","key"),r.stringParameterCheck(t,"DynamicsWebApi.retrieve","collection"),s||(r.callbackParameterCheck(a,"DynamicsWebApi.retrieve","successCallback"),r.callbackParameterCheck(i,"DynamicsWebApi.retrieve","errorCallback")),n&&n.length&&r.arrayParameterCheck(n,"DynamicsWebApi.retrieve","select"),c&&c.length&&r.stringOrArrayParameterCheck(c,"DynamicsWebApi.retrieve","expand");var o={collection:t,key:e,select:n,expand:c};this.retrieveRequest(o,a,i)},this.upsertRequest=function(e,t,a){r.parameterCheck(e,"DynamicsWebApi.upsert","request"),r.parameterCheck(e.entity,"DynamicsWebApi.upsert","request.entity"),s||(r.callbackParameterCheck(t,"DynamicsWebApi.upsert","successCallback"),r.callbackParameterCheck(a,"DynamicsWebApi.upsert","errorCallback"));var i=e.ifnonematch,n=e.ifmatch;o("PATCH",e,"upsert",(function(e){t(e.data)}),(function(e){i&&412===e.status||n&&404===e.status?t():a(e)}))},this.upsert=function(e,t,a,i,n,c,o){r.stringParameterCheck(e,"DynamicsWebApi.upsert","key"),e=r.keyParameterCheck(e,"DynamicsWebApi.upsert","key"),r.parameterCheck(a,"DynamicsWebApi.upsert","object"),r.stringParameterCheck(t,"DynamicsWebApi.upsert","collection"),s||(r.callbackParameterCheck(i,"DynamicsWebApi.upsert","successCallback"),r.callbackParameterCheck(n,"DynamicsWebApi.upsert","errorCallback")),c&&r.stringOrArrayParameterCheck(c,"DynamicsWebApi.upsert","prefer"),o&&r.arrayParameterCheck(o,"DynamicsWebApi.upsert","select");var l={collection:t,key:e,select:o,prefer:c,entity:a};this.upsertRequest(l,i,n)},this.count=function(e,t,a,i){r.stringParameterCheck(e,"DynamicsWebApi.count","collection"),s||(r.callbackParameterCheck(t,"DynamicsWebApi.count","successCallback"),r.callbackParameterCheck(a,"DynamicsWebApi.count","errorCallback"));var n={collection:e};null==i||null!=i&&!i.length?n.navigationProperty="$count":(n.filter=i,n.count=!0),o("GET",n,"count",(function(e){t(e.data)}),a,{toCount:n.count})},this.countAll=function(e,t,a,i,n){r.batchIncompatible("DynamicsWebApi.countAll",s),this.retrieveAllRequest({collection:e,filter:i,select:n},(function(e){t(e&&e.value?e.value.length:0)}),a)},this.retrieveMultiple=function(e,t,a,i,r,n){this.retrieveMultipleRequest({collection:e,select:i,filter:r},t,a,n)},this.retrieveAll=function(e,t,a,i,n){r.batchIncompatible("DynamicsWebApi.retrieveAll",s),u({collection:e,select:i,filter:n},t,a)};var l=function(e,t,a,i){s||(r.callbackParameterCheck(t,"DynamicsWebApi.retrieveMultiple","successCallback"),r.callbackParameterCheck(a,"DynamicsWebApi.retrieveMultiple","errorCallback")),i&&(r.stringParameterCheck(i,"DynamicsWebApi.retrieveMultiple","oDataLink"),e.url=i),o("GET",e,"retrieveMultiple",(function(e){t(e.data)}),a)};this.retrieveMultipleRequest=l;var u=function(e,t,a,i,r){r=r||[],l(e,(function(i){r=r.concat(i.value);var n=i.oDataNextLink;if(n)u(e,t,a,n,r);else{var c={value:r};i.oDataDeltaLink&&(c["@odata.deltaLink"]=i.oDataDeltaLink,c.oDataDeltaLink=i.oDataDeltaLink),t(c)}}),a,i)};this.retrieveAllRequest=function(e,t,a){r.batchIncompatible("DynamicsWebApi.retrieveAllRequest",s),u(e,t,a)};var p=function(e,t,a,i,n,c,l,u){r.stringParameterCheck(e,"DynamicsWebApi.executeFetchXml","collection"),r.stringParameterCheck(t,"DynamicsWebApi.executeFetchXml","fetchXml"),s||(r.callbackParameterCheck(a,"DynamicsWebApi.executeFetchXml","successCallback"),r.callbackParameterCheck(i,"DynamicsWebApi.executeFetchXml","errorCallback")),c=c||1,r.numberParameterCheck(c,"DynamicsWebApi.executeFetchXml","pageNumber");var p='$1 page="'+c+'"';null!=l&&(r.stringParameterCheck(l,"DynamicsWebApi.executeFetchXml","pagingCookie"),p+=' paging-cookie="'+l+'"'),t=t.replace(/^(<fetch)/,p),o("GET",{collection:e,includeAnnotations:n,impersonate:u,fetchXml:t},"executeFetchXml",(function(e){a(e.data)}),i,{pageNumber:c})};this.fetch=p,this.executeFetchXml=p;var m=function(e,t,a,i,r,n,c,s,o){o=o||[],p(e,t,(function(n){o=o.concat(n.value),n.PagingInfo?m(e,t,a,i,r,n.PagingInfo.nextPage,n.PagingInfo.cookie,s,o):a({value:o})}),i,r,n,c,s)},h=function(e,t,a,i,n,c){r.batchIncompatible("DynamicsWebApi.executeFetchXmlAll",s),m(e,t,a,i,n,null,null,c)};this.fetchAll=h,this.executeFetchXmlAll=h;var y=function(e,t,a,r,n,c){return r=r||0,i.setFileChunk(e,t,a,r),o("PATCH",e,"uploadFile",(function(i){(r+=a)<=t.length&&y(e,t,a,r,n,c),n()}),c)};this.uploadFile=function(e,t,a){r.batchIncompatible("DynamicsWebApi.uploadFile",s),r.parameterCheck(e,"DynamicsWebApi.uploadFile","request"),r.callbackParameterCheck(t,"DynamicsWebApi.uploadFile","successCallback"),r.callbackParameterCheck(a,"DynamicsWebApi.uploadFile","errorCallback");var n=e.data;delete e.data;var c=i.copyObject(e);return c.transferMode="chunked",e.data=n,o("PATCH",c,"uploadFile",(function(i){return c.url=i.data.location,delete c.transferMode,delete c.fieldName,y(c,e.data,i.data.chunkSize,null,t,a)}),a)};var d=4194304,b=function(e,t,a,r,n,c){return t=t||0,a=a||0,r=r||"",e.range="bytes="+t+"-"+(t+d-1),e.downloadSize="full",o("GET",e,"downloadFile",(function(a){e.url=a.data.location,r+=a.data.value,(t+=d)<=a.data.fileSize&&b(e,t,a.data.fileSize,r,n,c),n({fileName:a.data.fileName,fileSize:a.data.fileSize,data:i.convertToFileBuffer(r)})}),c,{parse:!0})};this.downloadFile=function(e,t,a){r.batchIncompatible("DynamicsWebApi.downloadFile",s),r.parameterCheck(e,"DynamicsWebApi.downloadFile","request"),r.callbackParameterCheck(t,"DynamicsWebApi.downloadFile","successCallback"),r.callbackParameterCheck(a,"DynamicsWebApi.downloadFile","errorCallback");var n=i.copyObject(e);b(n,null,null,null,t,a)},this.associate=function(e,t,a,i,n,c,l,u){r.stringParameterCheck(e,"DynamicsWebApi.associate","collection"),r.stringParameterCheck(i,"DynamicsWebApi.associate","relatedCollection"),r.stringParameterCheck(a,"DynamicsWebApi.associate","relationshipName"),t=r.keyParameterCheck(t,"DynamicsWebApi.associate","primaryKey"),n=r.keyParameterCheck(n,"DynamicsWebApi.associate","relatedKey"),s||(r.callbackParameterCheck(c,"DynamicsWebApi.associate","successCallback"),r.callbackParameterCheck(l,"DynamicsWebApi.associate","errorCallback")),o("POST",{_additionalUrl:a+"/$ref",collection:e,key:t,impersonate:u,data:{"@odata.id":i+"("+n+")"}},"associate",(function(){c()}),l)},this.disassociate=function(e,t,a,i,n,c,l){r.stringParameterCheck(e,"DynamicsWebApi.disassociate","collection"),r.stringParameterCheck(a,"DynamicsWebApi.disassociate","relationshipName"),t=r.keyParameterCheck(t,"DynamicsWebApi.disassociate","primaryKey"),i=r.keyParameterCheck(i,"DynamicsWebApi.disassociate","relatedKey"),s||(r.callbackParameterCheck(n,"DynamicsWebApi.disassociate","successCallback"),r.callbackParameterCheck(c,"DynamicsWebApi.disassociate","errorCallback")),o("DELETE",{_additionalUrl:a+"("+i+")/$ref",collection:e,key:t,impersonate:l},"disassociate",(function(){n()}),c)},this.associateSingleValued=function(e,t,a,i,n,c,l,u){r.stringParameterCheck(e,"DynamicsWebApi.associateSingleValued","collection"),t=r.keyParameterCheck(t,"DynamicsWebApi.associateSingleValued","key"),n=r.keyParameterCheck(n,"DynamicsWebApi.associateSingleValued","relatedKey"),r.stringParameterCheck(a,"DynamicsWebApi.associateSingleValued","singleValuedNavigationPropertyName"),r.stringParameterCheck(i,"DynamicsWebApi.associateSingleValued","relatedCollection"),s||(r.callbackParameterCheck(c,"DynamicsWebApi.associateSingleValued","successCallback"),r.callbackParameterCheck(l,"DynamicsWebApi.associateSingleValued","errorCallback")),o("PUT",{_additionalUrl:a+"/$ref",collection:e,key:t,impersonate:u,data:{"@odata.id":i+"("+n+")"}},"associateSingleValued",(function(){c()}),l)},this.disassociateSingleValued=function(e,t,a,i,n,c){r.stringParameterCheck(e,"DynamicsWebApi.disassociateSingleValued","collection"),t=r.keyParameterCheck(t,"DynamicsWebApi.disassociateSingleValued","key"),r.stringParameterCheck(a,"DynamicsWebApi.disassociateSingleValued","singleValuedNavigationPropertyName"),s||(r.callbackParameterCheck(i,"DynamicsWebApi.disassociateSingleValued","successCallback"),r.callbackParameterCheck(n,"DynamicsWebApi.disassociateSingleValued","errorCallback")),o("DELETE",{_additionalUrl:a+"/$ref",key:t,collection:e,impersonate:c},"disassociateSingleValued",(function(){i()}),n)},this.executeUnboundFunction=function(e,t,a,i,r){f(e,i,null,null,t,a,r,!0)},this.executeBoundFunction=function(e,t,a,i,r,n,c){f(a,n,t,e,i,r,c)};var f=function(e,t,a,n,c,l,u,p){r.stringParameterCheck(e,"DynamicsWebApi.executeFunction","functionName"),s||(r.callbackParameterCheck(c,"DynamicsWebApi.executeFunction","successCallback"),r.callbackParameterCheck(l,"DynamicsWebApi.executeFunction","errorCallback"));var m={_additionalUrl:e+i.buildFunctionParameters(t),_unboundRequest:p,key:n,collection:a,impersonate:u};o("GET",m,"executeFunction",(function(e){c(e.data)}),l)};this.executeUnboundAction=function(e,t,a,i,r){k(e,t,null,null,a,i,r,!0)},this.executeBoundAction=function(e,t,a,i,r,n,c){k(a,i,t,e,r,n,c)};var k=function(e,t,a,i,n,c,l,u){r.stringParameterCheck(e,"DynamicsWebApi.executeAction","actionName"),s||(r.callbackParameterCheck(n,"DynamicsWebApi.executeAction","successCallback"),r.callbackParameterCheck(c,"DynamicsWebApi.executeAction","errorCallback")),o("POST",{_additionalUrl:e,_unboundRequest:u,collection:a,key:i,impersonate:l,data:t},"executeAction",(function(e){n(e.data)}),c)};this.createEntity=function(e,t,a){r.parameterCheck(e,"DynamicsWebApi.createEntity","entityDefinition");var i={collection:"EntityDefinitions",entity:e};this.createRequest(i,t,a)},this.updateEntity=function(e,t,a,i){r.parameterCheck(e,"DynamicsWebApi.updateEntity","entityDefinition"),r.guidParameterCheck(e.MetadataId,"DynamicsWebApi.updateEntity","entityDefinition.MetadataId");var n={collection:"EntityDefinitions",mergeLabels:i,key:e.MetadataId,entity:e};this.updateRequest(n,t,a)},this.retrieveEntity=function(e,t,a,i,n){r.keyParameterCheck(e,"DynamicsWebApi.retrieveEntity","entityKey");var c={collection:"EntityDefinitions",key:e,select:i,expand:n};this.retrieveRequest(c,t,a)},this.retrieveEntities=function(e,t,a,i){var r={collection:"EntityDefinitions",select:a,filter:i};this.retrieveRequest(r,e,t)},this.createAttribute=function(e,t,a,i){r.keyParameterCheck(e,"DynamicsWebApi.createAttribute","entityKey"),r.parameterCheck(t,"DynamicsWebApi.createAttribute","attributeDefinition");var n={collection:"EntityDefinitions",key:e,entity:t,navigationProperty:"Attributes"};this.createRequest(n,a,i)},this.updateAttribute=function(e,t,a,i,n,c){r.keyParameterCheck(e,"DynamicsWebApi.updateAttribute","entityKey"),r.parameterCheck(t,"DynamicsWebApi.updateAttribute","attributeDefinition"),r.guidParameterCheck(t.MetadataId,"DynamicsWebApi.updateAttribute","attributeDefinition.MetadataId"),n&&r.stringParameterCheck(n,"DynamicsWebApi.updateAttribute","attributeType");var s={collection:"EntityDefinitions",key:e,entity:t,navigationProperty:"Attributes",navigationPropertyKey:t.MetadataId,mergeLabels:c,metadataAttributeType:n};this.updateRequest(s,a,i)},this.retrieveAttributes=function(e,t,a,i,n,c,s){r.keyParameterCheck(e,"DynamicsWebApi.retrieveAttributes","entityKey"),i&&r.stringParameterCheck(i,"DynamicsWebApi.retrieveAttributes","attributeType");var o={collection:"EntityDefinitions",key:e,navigationProperty:"Attributes",select:n,filter:c,expand:s,metadataAttributeType:i};this.retrieveRequest(o,t,a)},this.retrieveAttribute=function(e,t,a,i,n,c,s){r.keyParameterCheck(e,"DynamicsWebApi.retrieveAttribute","entityKey"),r.keyParameterCheck(t,"DynamicsWebApi.retrieveAttribute","attributeKey"),n&&r.stringParameterCheck(n,"DynamicsWebApi.retrieveAttribute","attributeType");var o={collection:"EntityDefinitions",key:e,navigationProperty:"Attributes",select:c,expand:s,metadataAttributeType:n,navigationPropertyKey:t};this.retrieveRequest(o,a,i)},this.createRelationship=function(e,t,a){r.parameterCheck(e,"DynamicsWebApi.createRelationship","relationshipDefinition");var i={collection:"RelationshipDefinitions",entity:e};this.createRequest(i,t,a)},this.updateRelationship=function(e,t,a,i,n){r.parameterCheck(e,"DynamicsWebApi.updateRelationship","relationshipDefinition"),r.guidParameterCheck(e.MetadataId,"DynamicsWebApi.updateRelationship","relationshipDefinition.MetadataId");var c={collection:"RelationshipDefinitions",mergeLabels:n,key:e.MetadataId,entity:e,navigationProperty:i};this.updateRequest(c,t,a)},this.deleteRelationship=function(e,t,a){r.keyParameterCheck(e,"DynamicsWebApi.deleteRelationship","metadataId");var i={collection:"RelationshipDefinitions",key:e};this.deleteRequest(i,t,a)},this.retrieveRelationships=function(e,t,a,i,r){var n={collection:"RelationshipDefinitions",navigationProperty:a,select:i,filter:r};this.retrieveMultipleRequest(n,e,t)},this.retrieveRelationship=function(e,t,a,i,n){r.keyParameterCheck(e,"DynamicsWebApi.retrieveRelationship","metadataId");var c={collection:"RelationshipDefinitions",navigationProperty:i,key:e,select:n};this.retrieveRequest(c,t,a)},this.createGlobalOptionSet=function(e,t,a){r.parameterCheck(e,"DynamicsWebApi.createGlobalOptionSet","globalOptionSetDefinition");var i={collection:"GlobalOptionSetDefinitions",entity:e};this.createRequest(i,t,a)},this.updateGlobalOptionSet=function(e,t,a,i){r.parameterCheck(e,"DynamicsWebApi.updateGlobalOptionSet","globalOptionSetDefinition"),r.guidParameterCheck(e.MetadataId,"DynamicsWebApi.updateGlobalOptionSet","globalOptionSetDefinition.MetadataId");var n={collection:"GlobalOptionSetDefinitions",mergeLabels:i,key:e.MetadataId,entity:e};this.updateRequest(n,t,a)},this.deleteGlobalOptionSet=function(e,t,a){r.keyParameterCheck(e,"DynamicsWebApi.deleteGlobalOptionSet","globalOptionSetKey");var i={collection:"GlobalOptionSetDefinitions",key:e};this.deleteRequest(i,t,a)},this.retrieveGlobalOptionSet=function(e,t,a,i,n){r.keyParameterCheck(e,"DynamicsWebApi.retrieveGlobalOptionSet","globalOptionSetKey");var c={collection:"GlobalOptionSetDefinitions",key:e,navigationProperty:i,select:n};this.retrieveRequest(c,t,a)},this.retrieveGlobalOptionSets=function(e,t,a,i){var r={collection:"GlobalOptionSetDefinitions",navigationProperty:a,select:i};this.retrieveMultipleRequest(r,e,t)},this.startBatch=function(){s=!0,t=i.generateUUID()},this.executeBatch=function(e,a,i){i=i||{},r.batchNotStarted(s),r.callbackParameterCheck(e,"DynamicsWebApi.executeBatch","successCallback"),r.callbackParameterCheck(a,"DynamicsWebApi.executeBatch","errorCallback"),r.parameterCheck(i,"DynamicsWebApi.executeBatch","request"),s=!1,i.collection="$batch",o("POST",i,"executeBatch",(function(a){t=null,e(a.data)}),(function(e){t=null,a(e)}))},this.initializeInstance=function(e){return e||(e=a),new c(e)}}String.prototype.endsWith&&String.prototype.startsWith||a(200),c.prototype.utility={getCollectionName:n.getCollectionName},e.exports=c},535:e=>{function t(e,t,a){throw new Error(a?e+" requires the "+t+" parameter to be of type "+a:e+" requires the "+t+" parameter.")}var a={handleErrorResponse:function(e){throw new Error("Error: "+e.status+": "+e.message)},parameterCheck:function(e,a,i,r){null!=e&&""!=e||t(a,i,r)},stringParameterCheck:function(e,a,i){"string"!=typeof e&&t(a,i,"String")},arrayParameterCheck:function(e,a,i){e.constructor!==Array&&t(a,i,"Array")},stringOrArrayParameterCheck:function(e,a,i){e.constructor!==Array&&"string"!=typeof e&&t(a,i,"String or Array")},numberParameterCheck:function(e,a,i){if("number"!=typeof e){if("string"==typeof e&&e&&!isNaN(parseInt(e)))return;t(a,i,"Number")}},boolParameterCheck:function(e,a,i){"boolean"!=typeof e&&t(a,i,"Boolean")},guidParameterCheck:function(e,a,i){try{return/[0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12}/i.exec(e)[0]}catch(e){t(a,i,"GUID String")}},keyParameterCheck:function(e,i,r){try{a.stringParameterCheck(e,i,r);var n=/^{?([0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12})}?$/i.exec(e);if(n)return n[1];var c=e.split(",");if(c.length)for(var s=0;s<c.length;s++)c[s]=c[s].trim().replace('"',"'"),/^[\w\d\_]+\=('[^\'\r\n]+'|\d+)$/i.exec(c[s])[0];return c.join(",")}catch(e){t(i,r,"String representing GUID or Alternate Key")}},callbackParameterCheck:function(e,a,i){"function"!=typeof e&&t(a,i,"Function")},batchIncompatible:function(e,t){if(t)throw t=!1,new Error(e+" cannot be used in a BATCH request.")},batchNotStarted:function(e){if(!e)throw new Error("Batch operation has not been started. Please call a DynamicsWebApi.startBatch() function prior to calling DynamicsWebApi.executeBatch() to perform a batch request correctly.")},handleHttpError:function(e,t){var a=new Error;return Object.keys(e).forEach((function(t){a[t]=e[t]})),t&&Object.keys(t).forEach((function(e){a[e]=t[e]})),a}};e.exports=a},984:()=>{Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}},200:()=>{String.prototype.endsWith=function(e,t){var a=this.toString();("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>a.length)&&(t=a.length),t-=e.length;var i=a.lastIndexOf(e,t);return-1!==i&&i===t},String.prototype.startsWith=function(e,t){return t=t||0,this.substr(t,e.length)===e}},723:e=>{e.exports=function(e,t){var a;return"string"==typeof t&&(a=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:Z|[-+]\d{2}:\d{2})$/.exec(t))?new Date(Date.UTC(+a[1],+a[2]-1,+a[3],+a[4],+a[5],+a[6])):t}},49:(e,t,a)=>{var i=a(923),r=a(389),n=a(535),c=a(723);function s(e,t){var a=null;if(-1!==e.indexOf("@")){var r=e.split("@");switch(r[1]){case"odata.context":a="oDataContext";break;case"odata.count":a="oDataCount",t=null!=t?parseInt(t):0;break;case"odata.nextLink":a="oDataNextLink";break;case"odata.deltaLink":a="oDataDeltaLink";break;case i.Prefer.Annotations.FormattedValue:a=r[0]+"_Formatted";break;case i.Prefer.Annotations.AssociatedNavigationProperty:a=r[0]+"_NavigationProperty";break;case i.Prefer.Annotations.LookupLogicalName:a=r[0]+"_LogicalName"}}return[a,t]}function o(e,t){if(t){if(t.isRef&&null!=e["@odata.id"])return r.convertToReferenceObject(e);if(t.toCount)return s("@odata.count",e["@odata.count"])[1]||0}for(var a=Object.keys(e),n=0;n<a.length;n++){var c=a[n];if(null!=e[c])if(e[c].constructor===Array)for(var l=0;l<e[c].length;l++)e[c][l]=o(e[c][l]);else"object"==typeof e[c]&&o(e[c]);var u=s(c,e[c]);if(u[0]&&(e[u[0]]=u[1]),-1!==c.indexOf("_x002e_")){var p=c.split("_x002e_");if(e.hasOwnProperty(p[0])){if("object"!=typeof e[p[0]]||"object"==typeof e[p[0]]&&!e[p[0]].hasOwnProperty("_dwaType"))throw new Error("The alias name of the linked entity must be unique!")}else e[p[0]]={_dwaType:"alias"};e[p[0]][p[1]]=e[c],(u=s(p[1],e[c]))[0]&&(e[p[0]][u[0]]=u[1])}}return t&&t.hasOwnProperty("pageNumber")&&null!=e["@"+i.Prefer.Annotations.FetchXmlPagingCookie]&&(e.PagingInfo=r.getFetchXmlPagingCookie(e["@"+i.Prefer.Annotations.FetchXmlPagingCookie],t.pageNumber)),e}String.prototype.endsWith&&String.prototype.startsWith||a(200);var l=/^([^()<>@,;:\\"\/[\]?={} \t]+)\s?:\s?(.*)/;function u(e){var t,a,i,r={},n={position:0};do{i=n.position,a=p(e,n),null!==(t=l.exec(a))?r[t[1].toLowerCase()]=t[2]:n.position=i}while(a&&t);return r}function p(e,t){return function(e,t,a){var i=t.position||0,r=e.length;if(a){if(-1===(r=e.indexOf(a,i)))return null;t.position=r+a.length}else t.position=r;return e.substring(i,r)}(e,t,"\r\n")}function m(e,t,a){var i=e.substr(0,e.indexOf("\r\n")),r=e.split(i);r.shift(),r.pop(),a=a||0;for(var s=[],l=0;l<r.length;l++){var p=r[l];if(p.indexOf("--changesetresponse_")>-1){var h=(p=p.trim()).substring(p.indexOf("\r\n")+1).trim();s=s.concat(m(h,t,a))}else{var y=/HTTP\/?\s*[\d.]*\s+(\d{3})\s+([\w\s]*)$/gm.exec(p),d=parseInt(y[1]),b=y[2].trim(),f=p.substring(p.indexOf("{"),p.lastIndexOf("}")+1);if(f){var k=o(JSON.parse(f,c),t[a]);if(d>=400){var g=u(p.substring(p.indexOf(y[0])+y[0].length+1,p.indexOf("{")));s.push(n.handleHttpError(k,{status:d,statusText:b,statusMessage:b,headers:g}))}else s.push(k)}else if(/Content-Type: text\/plain/i.test(p)){var A=/\w+$/gi.exec(p.trim()),C=A&&A.length?A[0]:void 0;s.push(isNaN(C)?C:parseInt(C))}else if(t.length&&t[a]&&t[a].hasOwnProperty("valueIfEmpty"))s.push(t[a].valueIfEmpty);else{var D=/OData-EntityId.+/i.exec(p);if(D&&D.length){var P=/([0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12})\)$/i.exec(D[0]);s.push(P?P[1]:void 0)}else s.push(void 0)}}a++}return s}function h(e,t,a){var i,r=e;a.hasOwnProperty("parse")&&(r=JSON.parse(r).value,i=r,r=window.atob(i));var n={value:r};return t["x-ms-file-name"]&&(n.fileName=t["x-ms-file-name"]),t["x-ms-file-size"]&&(n.fileSize=parseInt(t["x-ms-file-size"])),y(t,"Location")&&(n.location=d(t,"Location")),n}function y(e,t){return e.hasOwnProperty(t)||e.hasOwnProperty(t.toLowerCase())}function d(e,t){return e[t]?e[t]:e[t.toLowerCase()]}e.exports=function(e,t,a){var i=void 0;if(e.length)if(e.indexOf("--batchresponse_")>-1){var r=m(e,a);i=1===a.length&&a[0].convertedToBatch?r[0]:r}else i=y(t,"Content-Disposition")?h(e,t,a[0]):o(JSON.parse(e,c),a[0]);else if(a.length&&a[0].hasOwnProperty("valueIfEmpty"))i=a[0].valueIfEmpty;else if(y(t,"OData-EntityId")){var n=d(t,"OData-EntityId"),s=/([0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12})\)$/i.exec(n);s&&(i=s[1])}else y(t,"Location")&&(i={location:d(t,"Location")},t["x-ms-chunk-size"]&&(i.chunkSize=parseInt(t["x-ms-chunk-size"])));return i}},364:e=>{e.exports=function(e){var t={};if(!e)return t;for(var a=e.split("\r\n"),i=0,r=a.length;i<r;i++){var n=a[i],c=n.indexOf(": ");c>0&&(t[n.substring(0,c)]=n.substring(c+2))}return t}},67:(e,t,a)=>{var i,r=a(389),n=a(359);function c(e){var t=r.getXrmInternal();if(!r.isNull(t)&&"function"==typeof t.getEntitySetName)return t.getEntitySetName(e)||e;var a=null;if(!r.isNull(i)&&(a=i[e],r.isNull(a)))for(var n in i)if(i[n]===e)return e;return a}function s(e){return e.Accept="application/json",e["OData-MaxVersion"]="4.0",e["OData-Version"]="4.0",e["Content-Type"]=e["Content-Range"]?"application/octet-stream":"application/json; charset=utf-8",e}function o(e,t){var a;if(e){if(e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array)return e;a=(a=JSON.stringify(e,(function(e,a){if(e.endsWith("@odata.bind")||e.endsWith("@odata.id")){if("string"==typeof a&&!a.startsWith("$")){if(/\(\{[\w\d-]+\}\)/g.test(a)&&(a=a.replace(/(.+)\(\{([\w\d-]+)\}\)/g,"$1($2)")),t.useEntityNames){var i=/([\w_]+)(\([\d\w-]+\))$/,n=i.exec(a);if(n.length>2){var s=c(n[1]);r.isNull(s)||(a=a.replace(i,s+"$2"))}}a.startsWith(t.webApiUrl)||(e.endsWith("@odata.bind")?a.startsWith("/")||(a="/"+a):a=t.webApiUrl+a.replace(/^\//,""))}}else(e.startsWith("oData")||e.endsWith("_Formatted")||e.endsWith("_NavigationProperty")||e.endsWith("_LogicalName"))&&(a=void 0);return a}))).replace(/[\u007F-\uFFFF]/g,(function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).substr(-4)}))}return a}var l={},u={};function p(e,t){u[e]?u[e].push(t):u[e]=[t]}function m(e,t,i,m,h,y,d,b,f,k,g,A){h=h||{},y=y||{},p(A=A||r.generateUUID(),y);var C,D=o(m,i);if("$batch"===t){var P=function(e,t){for(var a="dwa_batch_"+r.generateUUID(),i=[],s=null,l=1e5,u=0;u<e.length;u++){var p=e[u].request;t.useEntityNames&&(p.collection=c(p.collection)||p.collection);var m=n.convertRequest(p,"executeBatch",t),h=e[u].method,y="GET"===h;if(y&&s&&(i.push("\n--"+s+"--"),s=null,l=1e5),s||(i.push("\n--"+a),y||(s="changeset_"+r.generateUUID(),i.push("Content-Type: multipart/mixed;boundary="+s))),y||i.push("\n--"+s),i.push("Content-Type: application/http"),i.push("Content-Transfer-Encoding: binary"),!y){var d=m.headers.hasOwnProperty("Content-ID")?m.headers["Content-ID"]:++l;i.push("Content-ID: "+d)}for(var b in m.url.startsWith("$")?i.push("\n"+h+" "+m.url+" HTTP/1.1"):i.push("\n"+h+" "+t.webApiUrl+m.url+" HTTP/1.1"),y?i.push("Accept: application/json"):i.push("Content-Type: application/json"),m.headers)"Authorization"!==b&&"Content-ID"!==b&&i.push(b+": "+m.headers[b]);var f=p.data||p.entity;!y&&f&&i.push("\n"+o(f,t))}return s&&i.push("\n--"+s+"--"),i.push("\n--"+a+"--"),{boundary:a,body:i.join("\n")}}(l[A],i);D=P.body,delete l[A],(h=s(h))["Content-Type"]="multipart/mixed;boundary="+P.boundary}else h=s(h);if(y.convertedToBatch=!1,t.length>2e3){var v="dwa_batch_"+r.generateUUID(),W=[];for(var x in W.push("--"+v),W.push("Content-Type: application/http"),W.push("Content-Transfer-Encoding: binary\n"),W.push(e+" "+i.webApiUrl+t+" HTTP/1.1"),h)"Authorization"!==x&&(W.push(x+": "+h[x]),delete h[x]);W.push("\n--"+v+"--"),D=W.join("\n"),(h=s(h))["Content-Type"]="multipart/mixed;boundary="+v,t="$batch",e="POST",y.convertedToBatch=!0}i.impersonate&&!h.MSCRMCallerID&&(h.MSCRMCallerID=i.impersonate),i.impersonateAAD&&!h.CallerObjectId&&(h.CallerObjectId=i.impersonateAAD),C=a(105);var R=function(a){a&&(h||(h={}),h.Authorization="Bearer "+(a.hasOwnProperty("accessToken")?a.accessToken:a)),C({method:e,uri:i.webApiUrl+t,data:D,requestId:A,additionalHeaders:h,responseParams:u,successCallback:d,errorCallback:b,isAsync:k,timeout:g,requestId:A})};i.onTokenRefresh&&(!h||h&&!h.Authorization)?i.onTokenRefresh(R):R()}function h(e,t,a,s){if(function(e){return["EntityDefinitions","$metadata","RelationshipDefinitions","GlobalOptionSetDefinitions","ManagedPropertyDefinitions"].indexOf(e)>-1}(e)||r.isNull(e))a(e);else if(e=e.toLowerCase(),t.useEntityNames)try{!function(e,t,a,s){if(r.isNull(i)){var o=n.convertRequest({collection:"EntityDefinitions",select:["EntitySetName","LogicalName"],noCache:!0},"retrieveMultiple",t);m("GET",o.url,t,null,o.headers,null,(function(t){i={};for(var r=0;r<t.data.value.length;r++)i[t.data.value[r].LogicalName]=t.data.value[r].EntitySetName;a(c(e)||e)}),(function(e){s({message:"Unable to fetch EntityDefinitions. Error: "+e.message})}),0,o.async,t.timeout)}else a(c(e)||e)}(e,t,a,s)}catch(e){s({message:"Unable to fetch Collection Names. Error: "+e.message})}else a(e)}e.exports={sendRequest:m,makeRequest:function(e,t,a,i,c,s,o){t.isBatch?(p(t.requestId,c||{}),function(e,t){l[e]?l[e].push(t):l[e]=[t]}(t.requestId,{method:e,request:r.copyObject(t)}),delete t.isBatch,delete t.requestId,n.convertRequest(t,a,i)):h(t.collection,i,(function(r){t.collection=r;var l=n.convertRequest(t,a,i),u=t.requestId;delete t.requestId,m(e,l.url,i,t.data||t.entity,l.headers,c,s,o,t.isBatch,l.async,t.timeout||i.timeout,u)}),o)},getCollectionName:c}},105:(e,t,a)=>{var i=a(49),r=a(364),n=a(535);Array.isArray||a(984),e.exports=function(e){var t=e.method,a=e.uri,c=e.data,s=e.additionalHeaders,o=e.responseParams,l=e.successCallback,u=e.errorCallback,p=e.isAsync,m=e.requestId,h=new XMLHttpRequest;for(var y in h.open(t,a,p),s)h.setRequestHeader(y,s[y]);h.onreadystatechange=function(){if(4===h.readyState)switch(h.status){case 200:case 201:case 204:case 304:var e=r(h.getAllResponseHeaders()),t={data:i(h.responseText,e,o[m]),headers:e,status:h.status};delete o[m],h=null,l(t);break;case 206:l(!0);break;default:var a;try{var c=r(h.getAllResponseHeaders()),s=i(h.responseText,c,o[m]);if(Array.isArray(s)){u(s);break}a=s.error}catch(e){a=h.response.length>0?{message:h.response}:{message:"Unexpected Error"}}var p={status:h.status,statusText:h.statusText,headers:c};delete o[m],h=null,u(n.handleHttpError(a,p))}},e.timeout&&(h.timeout=e.timeout),h.onerror=function(){var e=r(h.getAllResponseHeaders());u(n.handleHttpError({status:h.status,statusText:h.statusText,message:h.responseText||"Network Error",headers:e})),delete o[m],h=null},h.ontimeout=function(){var e=r(h.getAllResponseHeaders());u(n.handleHttpError({status:h.status,statusText:h.statusText,message:h.responseText||"Request Timed Out",headers:e})),delete o[m],h=null},c?h.send(c):h.send()}},359:(e,t,a)=>{"use strict";a(923);var i=a(535),r=a(956);function n(e,t,a,c,s){var o={},l=[];if(c=null!=c?c:"&",e){if(e.navigationProperty&&(i.stringParameterCheck(e.navigationProperty,"DynamicsWebApi."+t,"request.navigationProperty"),a+="/"+e.navigationProperty,e.navigationPropertyKey&&(a+="("+i.keyParameterCheck(e.navigationPropertyKey,"DynamicsWebApi."+t,"request.navigationPropertyKey")+")"),"Attributes"===e.navigationProperty&&e.metadataAttributeType&&(i.stringParameterCheck(e.metadataAttributeType,"DynamicsWebApi."+t,"request.metadataAttributeType"),a+="/"+e.metadataAttributeType)),null!=e.select&&e.select.length&&(i.arrayParameterCheck(e.select,"DynamicsWebApi."+t,"request.select"),"retrieve"==t&&1==e.select.length&&e.select[0].endsWith("/$ref")?a+="/"+e.select[0]:(e.select[0].startsWith("/")&&"retrieve"==t&&(null==e.navigationProperty?a+=e.select.shift():e.select.shift()),e.select.length&&l.push("$select="+e.select.join(",")))),e.filter){i.stringParameterCheck(e.filter,"DynamicsWebApi."+t,"request.filter");for(var u,p=/[^"']{([\w\d]{8}[-]?(?:[\w\d]{4}[-]?){3}[\w\d]{12})}(?:[^"']|$)/g,m=e.filter;null!==(u=p.exec(m));){var h=u[0].endsWith(")")?")":" ";m=m.replace(u[0]," "+u[1]+h)}l.push("$filter="+encodeURIComponent(m))}e.fieldName&&(i.stringParameterCheck(e.fieldName,"DynamicsWebApi."+t,"request.fieldName"),a+="/"+e.fieldName),e.savedQuery&&l.push("savedQuery="+i.guidParameterCheck(e.savedQuery,"DynamicsWebApi."+t,"request.savedQuery")),e.userQuery&&l.push("userQuery="+i.guidParameterCheck(e.userQuery,"DynamicsWebApi."+t,"request.userQuery")),e.apply&&(i.stringParameterCheck(e.apply,"DynamicsWebApi."+t,"request.apply"),l.push("$apply="+e.apply)),e.count&&(i.boolParameterCheck(e.count,"DynamicsWebApi."+t,"request.count"),l.push("$count="+e.count)),e.top&&e.top>0&&(i.numberParameterCheck(e.top,"DynamicsWebApi."+t,"request.top"),l.push("$top="+e.top)),null!=e.orderBy&&e.orderBy.length&&(i.arrayParameterCheck(e.orderBy,"DynamicsWebApi."+t,"request.orderBy"),l.push("$orderby="+e.orderBy.join(","))),e.downloadSize&&(i.stringParameterCheck(e.downloadSize,"DynamicsWebApi."+t,"request.downloadSize"),l.push("size="+e.downloadSize)),e.fileName&&(i.stringParameterCheck(e.fileName,"DynamicsWebApi."+t,"request.fileName"),l.push("x-ms-file-name="+e.fileName));var y=r(e,t,s);if(y.length&&(o.Prefer=y),null!=e.ifmatch&&null!=e.ifnonematch)throw new Error("DynamicsWebApi."+t+". Either one of request.ifmatch or request.ifnonematch parameters should be used in a call, not both.");if(e.transferMode&&(o["x-ms-transfer-mode"]=e.transferMode),e.ifmatch&&(i.stringParameterCheck(e.ifmatch,"DynamicsWebApi."+t,"request.ifmatch"),o["If-Match"]=e.ifmatch),e.ifnonematch&&(i.stringParameterCheck(e.ifnonematch,"DynamicsWebApi."+t,"request.ifnonematch"),o["If-None-Match"]=e.ifnonematch),e.impersonate&&(i.stringParameterCheck(e.impersonate,"DynamicsWebApi."+t,"request.impersonate"),o.MSCRMCallerID=i.guidParameterCheck(e.impersonate,"DynamicsWebApi."+t,"request.impersonate")),e.impersonateAAD&&(i.stringParameterCheck(e.impersonateAAD,"DynamicsWebApi."+t,"request.impersonateAAD"),o.CallerObjectId=i.guidParameterCheck(e.impersonateAAD,"DynamicsWebApi."+t,"request.impersonateAAD")),e.token&&(i.stringParameterCheck(e.token,"DynamicsWebApi."+t,"request.token"),o.Authorization="Bearer "+e.token),e.duplicateDetection&&(i.boolParameterCheck(e.duplicateDetection,"DynamicsWebApi."+t,"request.duplicateDetection"),o["MSCRM.SuppressDuplicateDetection"]="false"),e.entity&&i.parameterCheck(e.entity,"DynamicsWebApi."+t,"request.entity"),e.data&&i.parameterCheck(e.data,"DynamicsWebApi."+t,"request.data"),e.contentRange&&(i.stringParameterCheck(e.contentRange,"DynamicsWebApi."+t,"request.contentRange"),o["Content-Range"]=e.contentRange),e.range&&(i.stringParameterCheck(e.range,"DynamicsWebApi."+t,"request.range"),o.Range=e.range),e.noCache&&(i.boolParameterCheck(e.noCache,"DynamicsWebApi."+t,"request.noCache"),o["Cache-Control"]="no-cache"),e.mergeLabels&&(i.boolParameterCheck(e.mergeLabels,"DynamicsWebApi."+t,"request.mergeLabels"),o["MSCRM.MergeLabels"]="true"),e.contentId&&(i.stringParameterCheck(e.contentId,"DynamicsWebApi."+t,"request.contentId"),e.contentId.startsWith("$")||(o["Content-ID"]=e.contentId)),e.isBatch&&i.boolParameterCheck(e.isBatch,"DynamicsWebApi."+t,"request.isBatch"),e.timeout&&i.numberParameterCheck(e.timeout,"DynamicsWebApi."+t,"request.timeout"),e.expand&&e.expand.length)if(i.stringOrArrayParameterCheck(e.expand,"DynamicsWebApi."+t,"request.expand"),"string"==typeof e.expand)l.push("$expand="+e.expand);else{for(var d=[],b=0;b<e.expand.length;b++)if(e.expand[b].property){var f=n(e.expand[b],t+" $expand",null,";").query;f&&f.length&&(f="("+f+")"),d.push(e.expand[b].property+f)}d.length&&l.push("$expand="+d.join(","))}}return{url:a,query:l.join(c),headers:o}}var c={convertRequestOptions:n,convertRequest:function(e,t,a){var r,c="";return e.url?(i.stringParameterCheck(e.url,"DynamicsWebApi."+t,"request.url"),c=e.url.replace(a.webApiUrl,""),r=n(e,t,c,"&",a)):(e._unboundRequest||e.collection||i.parameterCheck(e.collection,"DynamicsWebApi."+t,"request.collection"),e.collection&&(i.stringParameterCheck(e.collection,"DynamicsWebApi."+t,"request.collection"),c=e.collection,e.contentId&&(i.stringParameterCheck(e.contentId,"DynamicsWebApi."+t,"request.contentId"),e.contentId.startsWith("$")&&(c=e.contentId+"/"+c)),e.key?e.key=i.keyParameterCheck(e.key,"DynamicsWebApi."+t,"request.key"):e.id&&(e.key=i.guidParameterCheck(e.id,"DynamicsWebApi."+t,"request.id")),e.key&&(c+="("+e.key+")")),e._additionalUrl&&(c&&(c+="/"),c+=e._additionalUrl),r=n(e,t,c,"&",a),e.fetchXml?(i.stringParameterCheck(e.fetchXml,"DynamicsWebApi."+t,"request.fetchXml"),r.url+="?fetchXml="+encodeURIComponent(e.fetchXml)):r.query&&(r.url+="?"+r.query)),e.hasOwnProperty("async")&&null!=e.async?(i.boolParameterCheck(e.async,"DynamicsWebApi."+t,"request.async"),r.async=e.async):r.async=!0,{url:r.url,headers:r.headers,async:r.async}}};e.exports=c},389:(e,t,a)=>{var i=window.crypto;function r(e){return void 0===e||null==e}function n(){if("undefined"!=typeof GetGlobalContext)return GetGlobalContext();if("undefined"!=typeof Xrm){if(!r(Xrm.Utility)&&!r(Xrm.Utility.getGlobalContext))return Xrm.Utility.getGlobalContext();if(!r(Xrm.Page)&&!r(Xrm.Page.context))return Xrm.Page.context}throw new Error("Xrm Context is not available. In most cases, it can be resolved by adding a reference to a ClientGlobalContext.js.aspx. Please refer to MSDN documentation for more details.")}function c(){var e=n().getClientUrl();return e.match(/\/$/)&&(e=e.substring(0,e.length-1)),e}var s={buildFunctionParameters:a(390),getFetchXmlPagingCookie:a(458),convertToReferenceObject:a(875),isNull:r,generateUUID:function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^i.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)))},getXrmContext:n,getXrmInternal:function(){return"undefined"!=typeof Xrm?Xrm.Internal:null},getXrmUtility:function(){return"undefined"!=typeof Xrm?Xrm.Utility:null},getClientUrl:c,initWebApiUrl:function(e){return c()+"/api/data/v"+e+"/"},copyObject:function e(t){var a,i={};for(var r in t)t.hasOwnProperty(r)&&("object"==typeof(a=t[r])&&a&&"[object Date]"!==Object.prototype.toString.call(t[r])?Array.isArray(t[r])?i[r]=t[r].slice():i[r]=e(t[r]):i[r]=t[r]);return i},setFileChunk:function(e,t,a,i){var r,n=(i=i||0)+a>t.length?t.length%a:a;r=new Uint8Array(n);for(var c=0;c<n;c++)r[c]=t[i+c];e.data=r,e.contentRange="bytes "+i+"-"+(i+n-1)+"/"+t.length},convertToFileBuffer:function(e){for(var t=new Uint8Array(data.length),a=0;a<data.length;a++)t[a]=data.charCodeAt(a);return t}};e.exports=s},390:e=>{e.exports=function(e){if(e){for(var t=Object.keys(e),a="",i="",r=1;r<=t.length;r++){var n=t[r-1],c=e[n];null!==c&&("string"!=typeof c||c.startsWith("Microsoft.Dynamics.CRM")?"object"==typeof c&&(c=JSON.stringify(c)):c="'"+c+"'",r>1&&(a+=",",i+="&"),a+=n+"=@p"+r,i+="@p"+r+"="+c)}return"("+a+")?"+i}return"()"}},956:(e,t,a)=>{var i=a(923),r=a(535);e.exports=function(e,t,a){var n,c=e.returnRepresentation,s=e.includeAnnotations,o=e.maxPageSize,l=e.trackChanges;if(e.prefer&&e.prefer.length)for(var u in r.stringOrArrayParameterCheck(e.prefer,"DynamicsWebApi."+t,"request.prefer"),"string"==typeof(n=e.prefer)&&(n=n.split(",")),n){var p=n[u].trim();p===i.Prefer.ReturnRepresentation?c=!0:p.indexOf("odata.include-annotations=")>-1?s=p.replace("odata.include-annotations=","").replace(/"/g,""):p.startsWith("odata.maxpagesize=")?o=p.replace("odata.maxpagesize=","").replace(/"/g,""):p.indexOf("odata.track-changes")>-1&&(l=!0)}return n=[],a&&(null==c&&(c=a.returnRepresentation),s=s||a.includeAnnotations,o=o||a.maxPageSize),c&&(r.boolParameterCheck(c,"DynamicsWebApi."+t,"request.returnRepresentation"),n.push(i.Prefer.ReturnRepresentation)),s&&(r.stringParameterCheck(s,"DynamicsWebApi."+t,"request.includeAnnotations"),n.push('odata.include-annotations="'+s+'"')),o&&o>0&&(r.numberParameterCheck(o,"DynamicsWebApi."+t,"request.maxPageSize"),n.push("odata.maxpagesize="+o)),l&&(r.boolParameterCheck(l,"DynamicsWebApi."+t,"request.trackChanges"),n.push("odata.track-changes")),n.join(",")}},875:e=>{e.exports=function(e){var t=/\/(\w+)\(([0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12})/i.exec(e["@odata.id"]);return{id:t[2],collection:t[1],oDataContext:e["@odata.context"]}}},458:e=>{e.exports=function(e,t){e=e||"",t=t||1,e=unescape(unescape(e));var a=/pagingcookie="(<cookie page="(\d+)".+<\/cookie>)/.exec(e);if(null!=a){var i=parseInt(a[2]);return{cookie:a[1].replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"'").replace(/\'/g,"&quot;"),page:i,nextPage:i+1}}return{cookie:"",page:t,nextPage:t+1}}}},t={},function a(i){if(t[i])return t[i].exports;var r=t[i]={exports:{}};return e[i](r,r.exports,a),r.exports}(228);var e,t}));