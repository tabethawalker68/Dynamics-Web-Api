/*! dynamics-web-api-callbacks v1.6.13 (c) 2020 Aleksandr Rogov */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("DynamicsWebApi",[],t):"object"==typeof exports?exports.DynamicsWebApi=t():e.DynamicsWebApi=t()}(this,function(){return function(e){function t(i){if(a[i])return a[i].exports;var n=a[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var a={};return t.m=e,t.c=a,t.i=function(e){return e},t.d=function(e,a,i){t.o(e,a)||Object.defineProperty(e,a,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(a,"a",a),a},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=6)}([function(e,t){function a(e,t,a){throw new Error(a?e+" requires the "+t+" parameter to be of type "+a:e+" requires the "+t+" parameter.")}var i={handleErrorResponse:function(e){throw new Error("Error: "+e.status+": "+e.message)},parameterCheck:function(e,t,i,n){void 0!==e&&null!==e&&""!=e||a(t,i,n)},stringParameterCheck:function(e,t,i){"string"!=typeof e&&a(t,i,"String")},arrayParameterCheck:function(e,t,i){e.constructor!==Array&&a(t,i,"Array")},stringOrArrayParameterCheck:function(e,t,i){e.constructor!==Array&&"string"!=typeof e&&a(t,i,"String or Array")},numberParameterCheck:function(e,t,i){if("number"!=typeof e){if("string"==typeof e&&e&&!isNaN(parseInt(e)))return;a(t,i,"Number")}},boolParameterCheck:function(e,t,i){"boolean"!=typeof e&&a(t,i,"Boolean")},guidParameterCheck:function(e,t,i){try{return/[0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12}/i.exec(e)[0]}catch(e){a(t,i,"GUID String")}},keyParameterCheck:function(e,t,n){try{i.stringParameterCheck(e,t,n);var r=/^{?([0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12})}?$/i.exec(e);if(r)return r[1];var c=e.split(",");if(c.length)for(var s=0;s<c.length;s++)c[s]=c[s].trim().replace('"',"'"),/^[\w\d\_]+\=('[^\'\r\n]+'|\d+)$/i.exec(c[s])[0];return c.join(",")}catch(e){a(t,n,"String representing GUID or Alternate Key")}},callbackParameterCheck:function(e,t,i){"function"!=typeof e&&a(t,i,"Function")},batchIncompatible:function(e,t){if(t)throw t=!1,new Error(e+" cannot be used in a BATCH request.")},batchNotStarted:function(e){if(!e)throw new Error("Batch operation has not been started. Please call a DynamicsWebApi.startBatch() function prior to calling DynamicsWebApi.executeBatch() to perform a batch request correctly.")},handleHttpError:function(e,t){var a=new Error;return Object.keys(e).forEach(function(t){a[t]=e[t]}),t&&Object.keys(t).forEach(function(e){a[e]=t[e]}),a}};e.exports=i},function(e,t){var a={Types:{ResponseBase:function(){this.oDataContext=""},Response:function(){a.Types.ResponseBase.call(this),this.value={}},ReferenceResponse:function(){a.Types.ResponseBase.call(this),this.id="",this.collection=""},MultipleResponse:function(){a.Types.ResponseBase.call(this),this.oDataNextLink="",this.oDataCount=0,this.value=[]},FetchXmlResponse:function(){a.Types.ResponseBase.call(this),this.value=[],this.PagingInfo={cookie:"",page:0,nextPage:1}}},Prefer:{ReturnRepresentation:"return=representation",Annotations:{AssociatedNavigationProperty:"Microsoft.Dynamics.CRM.associatednavigationproperty",LookupLogicalName:"Microsoft.Dynamics.CRM.lookuplogicalname",All:"*",FormattedValue:"OData.Community.Display.V1.FormattedValue",FetchXmlPagingCookie:"Microsoft.Dynamics.CRM.fetchxmlpagingcookie"}}};e.exports=a},function(e,t,a){function i(e){return void 0===e||null==e}function n(){var e=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var a=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?a:3&a|8).toString(16)})}function r(){if("undefined"!=typeof GetGlobalContext)return GetGlobalContext();if("undefined"!=typeof Xrm){if(!i(Xrm.Utility)&&!i(Xrm.Utility.getGlobalContext))return Xrm.Utility.getGlobalContext();if(!i(Xrm.Page)&&!i(Xrm.Page.context))return Xrm.Page.context}throw new Error("Xrm Context is not available. In most cases, it can be resolved by adding a reference to a ClientGlobalContext.js.aspx. Please refer to MSDN documentation for more details.")}function c(){var e=r(),t=e.getClientUrl();return t.match(/\/$/)&&(t=t.substring(0,t.length-1)),t}function s(e){return c()+"/api/data/v"+e+"/"}function o(){return"undefined"!=typeof Xrm?Xrm.Internal:null}function l(){return"undefined"!=typeof Xrm?Xrm.Utility:null}function u(e){return"object"==typeof e&&!!e}function p(e){var t={};for(var a in e)e.hasOwnProperty(a)&&(u(e[a])&&"[object Date]"!==Object.prototype.toString.call(e[a])?Array.isArray(e[a])?t[a]=e[a].slice():t[a]=p(e[a]):t[a]=e[a]);return t}var m={buildFunctionParameters:a(12),getFetchXmlPagingCookie:a(15),convertToReferenceObject:a(14),isNull:i,generateUUID:n,getXrmContext:r,getXrmInternal:o,getXrmUtility:l,getClientUrl:c,initWebApiUrl:s,copyObject:p};e.exports=m},function(e,t){String.prototype.endsWith=function(e,t){var a=this.toString();("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>a.length)&&(t=a.length),t-=e.length;var i=a.lastIndexOf(e,t);return-1!==i&&i===t},String.prototype.startsWith=function(e,t){return t=t||0,this.substr(t,e.length)===e}},function(e,t,a){"use strict";function i(e,t,a,n,s){var o={},l=[];if(n=null!=n?n:"&",e){if(e.navigationProperty){if(r.stringParameterCheck(e.navigationProperty,"DynamicsWebApi."+t,"request.navigationProperty"),a+="/"+e.navigationProperty,e.navigationPropertyKey){a+="("+r.keyParameterCheck(e.navigationPropertyKey,"DynamicsWebApi."+t,"request.navigationPropertyKey")+")"}"Attributes"===e.navigationProperty&&e.metadataAttributeType&&(r.stringParameterCheck(e.metadataAttributeType,"DynamicsWebApi."+t,"request.metadataAttributeType"),a+="/"+e.metadataAttributeType)}if(null!=e.select&&e.select.length&&(r.arrayParameterCheck(e.select,"DynamicsWebApi."+t,"request.select"),"retrieve"==t&&1==e.select.length&&e.select[0].endsWith("/$ref")?a+="/"+e.select[0]:(e.select[0].startsWith("/")&&"retrieve"==t&&(null==e.navigationProperty?a+=e.select.shift():e.select.shift()),e.select.length&&l.push("$select="+e.select.join(",")))),e.filter){r.stringParameterCheck(e.filter,"DynamicsWebApi."+t,"request.filter");for(var u,p=/[^"']{([\w\d]{8}[-]?(?:[\w\d]{4}[-]?){3}[\w\d]{12})}(?:[^"']|$)/g,m=e.filter;null!==(u=p.exec(m));){var h=u[0].endsWith(")")?")":" ";m=m.replace(u[0]," "+u[1]+h)}l.push("$filter="+encodeURIComponent(m))}e.savedQuery&&l.push("savedQuery="+r.guidParameterCheck(e.savedQuery,"DynamicsWebApi."+t,"request.savedQuery")),e.userQuery&&l.push("userQuery="+r.guidParameterCheck(e.userQuery,"DynamicsWebApi."+t,"request.userQuery")),e.apply&&(r.stringParameterCheck(e.apply,"DynamicsWebApi."+t,"request.apply"),l.push("$apply="+e.apply)),e.count&&(r.boolParameterCheck(e.count,"DynamicsWebApi."+t,"request.count"),l.push("$count="+e.count)),e.top&&e.top>0&&(r.numberParameterCheck(e.top,"DynamicsWebApi."+t,"request.top"),l.push("$top="+e.top)),null!=e.orderBy&&e.orderBy.length&&(r.arrayParameterCheck(e.orderBy,"DynamicsWebApi."+t,"request.orderBy"),l.push("$orderby="+e.orderBy.join(",")));var y=c(e,t,s);if(y.length&&(o.Prefer=y),null!=e.ifmatch&&null!=e.ifnonematch)throw new Error("DynamicsWebApi."+t+". Either one of request.ifmatch or request.ifnonematch parameters should be used in a call, not both.");if(e.ifmatch&&(r.stringParameterCheck(e.ifmatch,"DynamicsWebApi."+t,"request.ifmatch"),o["If-Match"]=e.ifmatch),e.ifnonematch&&(r.stringParameterCheck(e.ifnonematch,"DynamicsWebApi."+t,"request.ifnonematch"),o["If-None-Match"]=e.ifnonematch),e.impersonate&&(r.stringParameterCheck(e.impersonate,"DynamicsWebApi."+t,"request.impersonate"),o.MSCRMCallerID=r.guidParameterCheck(e.impersonate,"DynamicsWebApi."+t,"request.impersonate")),e.impersonateAAD&&(r.stringParameterCheck(e.impersonateAAD,"DynamicsWebApi."+t,"request.impersonateAAD"),o.CallerObjectId=r.guidParameterCheck(e.impersonateAAD,"DynamicsWebApi."+t,"request.impersonateAAD")),e.token&&(r.stringParameterCheck(e.token,"DynamicsWebApi."+t,"request.token"),o.Authorization="Bearer "+e.token),e.duplicateDetection&&(r.boolParameterCheck(e.duplicateDetection,"DynamicsWebApi."+t,"request.duplicateDetection"),o["MSCRM.SuppressDuplicateDetection"]="false"),e.entity&&r.parameterCheck(e.entity,"DynamicsWebApi."+t,"request.entity"),e.data&&r.parameterCheck(e.data,"DynamicsWebApi."+t,"request.data"),e.noCache&&(r.boolParameterCheck(e.noCache,"DynamicsWebApi."+t,"request.noCache"),o["Cache-Control"]="no-cache"),e.mergeLabels&&(r.boolParameterCheck(e.mergeLabels,"DynamicsWebApi."+t,"request.mergeLabels"),o["MSCRM.MergeLabels"]="true"),e.contentId&&(r.stringParameterCheck(e.contentId,"DynamicsWebApi."+t,"request.contentId"),e.contentId.startsWith("$")||(o["Content-ID"]=e.contentId)),e.isBatch&&r.boolParameterCheck(e.isBatch,"DynamicsWebApi."+t,"request.isBatch"),e.timeout&&r.numberParameterCheck(e.timeout,"DynamicsWebApi."+t,"request.timeout"),e.expand&&e.expand.length)if(r.stringOrArrayParameterCheck(e.expand,"DynamicsWebApi."+t,"request.expand"),"string"==typeof e.expand)l.push("$expand="+e.expand);else{for(var f=[],b=0;b<e.expand.length;b++)if(e.expand[b].property){var d=i(e.expand[b],t+" $expand",null,";"),k=d.query;k&&k.length&&(k="("+k+")"),f.push(e.expand[b].property+k)}f.length&&l.push("$expand="+f.join(","))}}return{url:a,query:l.join(n),headers:o}}function n(e,t,a){var n,c="";return e.url?(r.stringParameterCheck(e.url,"DynamicsWebApi."+t,"request.url"),c=e.url.replace(a.webApiUrl,""),n=i(e,t,c,"&",a)):(e._unboundRequest||e.collection||r.parameterCheck(e.collection,"DynamicsWebApi."+t,"request.collection"),e.collection&&(r.stringParameterCheck(e.collection,"DynamicsWebApi."+t,"request.collection"),c=e.collection,e.contentId&&(r.stringParameterCheck(e.contentId,"DynamicsWebApi."+t,"request.contentId"),e.contentId.startsWith("$")&&(c=e.contentId+"/"+c)),e.key?e.key=r.keyParameterCheck(e.key,"DynamicsWebApi."+t,"request.key"):e.id&&(e.key=r.guidParameterCheck(e.id,"DynamicsWebApi."+t,"request.id")),e.key&&(c+="("+e.key+")")),e._additionalUrl&&(c&&(c+="/"),c+=e._additionalUrl),n=i(e,t,c,"&",a),e.fetchXml?(r.stringParameterCheck(e.fetchXml,"DynamicsWebApi."+t,"request.fetchXml"),n.url+="?fetchXml="+encodeURIComponent(e.fetchXml)):n.query&&(n.url+="?"+n.query)),e.hasOwnProperty("async")&&null!=e.async?(r.boolParameterCheck(e.async,"DynamicsWebApi."+t,"request.async"),n.async=e.async):n.async=!0,{url:n.url,headers:n.headers,async:n.async}}var r=(a(1),a(0)),c=a(13),s={convertRequestOptions:i,convertRequest:n};e.exports=s},function(e,t,a){function i(e){var t=m.getXrmInternal();if(!m.isNull(t)&&"function"==typeof t.getEntitySetName)return t.getEntitySetName(e)||e;var a=null;if(!m.isNull(p)&&(a=p[e],m.isNull(a)))for(var i in p)if(p[i]===e)return e;return a}function n(e){return e.Accept="application/json",e["OData-MaxVersion"]="4.0",e["OData-Version"]="4.0",e["Content-Type"]="application/json; charset=utf-8",e}function r(e,t){var a;return e&&(a=JSON.stringify(e,function(e,a){if(e.endsWith("@odata.bind")||e.endsWith("@odata.id")){if("string"==typeof a&&!a.startsWith("$")){if(/\(\{[\w\d-]+\}\)/g.test(a)&&(a=a.replace(/(.+)\(\{([\w\d-]+)\}\)/g,"$1($2)")),t.useEntityNames){var n=/([\w_]+)(\([\d\w-]+\))$/,r=n.exec(a);if(r.length>2){var c=i(r[1]);m.isNull(c)||(a=a.replace(n,c+"$2"))}}a.startsWith(t.webApiUrl)||(e.endsWith("@odata.bind")?a.startsWith("/")||(a="/"+a):a=t.webApiUrl+a.replace(/^\//,""))}}else(e.startsWith("oData")||e.endsWith("_Formatted")||e.endsWith("_NavigationProperty")||e.endsWith("_LogicalName"))&&(a=void 0);return a}),a=a.replace(/[\u007F-\uFFFF]/g,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).substr(-4)})),a}function c(e,t,i,c,s,o,l,u,p,h,d){s=s||{},o=o||{},f.push(o);var k=r(c,i);if("$batch"===t){var g=b(y,i);k=g.body,y.length=0,s=n(s),s["Content-Type"]="multipart/mixed;boundary="+g.boundary}else s=n(s);if(o.convertedToBatch=!1,t.length>2e3){var A="dwa_batch_"+m.generateUUID(),C=[];C.push("--"+A),C.push("Content-Type: application/http"),C.push("Content-Transfer-Encoding: binary\n"),C.push(e+" "+i.webApiUrl+t+" HTTP/1.1");for(var D in s)"Authorization"!==D&&(C.push(D+": "+s[D]),delete s[D]);C.push("\n--"+A+"--"),k=C.join("\n"),s=n(s),s["Content-Type"]="multipart/mixed;boundary="+A,t="$batch",e="POST",o.convertedToBatch=!0}i.impersonate&&!s.MSCRMCallerID&&(s.MSCRMCallerID=i.impersonate),i.impersonateAAD&&!s.CallerObjectId&&(s.CallerObjectId=i.impersonateAAD);var P;P=a(11);var v=function(a){a&&(s||(s={}),s.Authorization="Bearer "+(a.hasOwnProperty("accessToken")?a.accessToken:a)),P({method:e,uri:i.webApiUrl+t,data:k,additionalHeaders:s,responseParams:f,successCallback:l,errorCallback:u,isAsync:h,timeout:d})};i.onTokenRefresh&&(!s||s&&!s.Authorization)?i.onTokenRefresh(v):v()}function s(e,t,a,n){if(m.isNull(p)){var r=function(t){p={};for(var n=0;n<t.data.value.length;n++)p[t.data.value[n].LogicalName]=t.data.value[n].EntitySetName;a(i(e)||e)},s=function(e){n({message:"Unable to fetch EntityDefinitions. Error: "+e.message})},o=h.convertRequest({collection:"EntityDefinitions",select:["EntitySetName","LogicalName"],noCache:!0},"retrieveMultiple",t);c("GET",o.url,t,null,o.headers,null,r,s,!1,o.async,t.timeout)}else a(i(e)||e)}function o(e){return["EntityDefinitions","$metadata","RelationshipDefinitions","GlobalOptionSetDefinitions","ManagedPropertyDefinitions"].indexOf(e)>-1}function l(e,t,a,i){if(o(e)||m.isNull(e))return void a(e);if(e=e.toLowerCase(),!t.useEntityNames)return void a(e);try{s(e,t,a,i)}catch(e){i({message:"Unable to fetch Collection Names. Error: "+e.message})}}function u(e,t,a,i,n,r,s){t.isBatch?(f.push(n||{}),y.push({method:e,request:m.copyObject(t)}),h.convertRequest(t,a,i)):l(t.collection,i,function(o){t.collection=o;var l=h.convertRequest(t,a,i);c(e,l.url,i,t.data||t.entity,l.headers,n,r,s,t.isBatch,l.async,t.timeout||i.timeout)},s)}var p,m=a(2),h=a(4),y=[],f=[],b=function(e,t){for(var a="dwa_batch_"+m.generateUUID(),n=[],c=null,s=1e5,o=0;o<e.length;o++){var l=e[o].request;t.useEntityNames&&(l.collection=i(l.collection)||l.collection);var u=h.convertRequest(l,"executeBatch",t),p=e[o].method,y="GET"===p;if(y&&c&&(n.push("\n--"+c+"--"),c=null,s=1e5),c||(n.push("\n--"+a),y||(c="changeset_"+m.generateUUID(),n.push("Content-Type: multipart/mixed;boundary="+c))),y||n.push("\n--"+c),n.push("Content-Type: application/http"),n.push("Content-Transfer-Encoding: binary"),!y){var f=u.headers.hasOwnProperty("Content-ID")?u.headers["Content-ID"]:++s;n.push("Content-ID: "+f)}u.url.startsWith("$")?n.push("\n"+p+" "+u.url+" HTTP/1.1"):n.push("\n"+p+" "+t.webApiUrl+u.url+" HTTP/1.1"),y?n.push("Accept: application/json"):n.push("Content-Type: application/json");for(var b in u.headers)"Authorization"!==b&&"Content-ID"!==b&&n.push(b+": "+u.headers[b]);var d=l.data||l.entity;!y&&d&&n.push("\n"+r(d,t))}return c&&n.push("\n--"+c+"--"),n.push("\n--"+a+"--"),{boundary:a,body:n.join("\n")}};e.exports={sendRequest:c,makeRequest:u,getCollectionName:i}},function(e,t,a){function i(e){var t={webApiVersion:"8.0",webApiUrl:"",impersonate:null,impersonateAAD:null,onTokenRefresh:null,includeAnnotations:null,maxPageSize:null,returnRepresentation:null},a=!1;e||(e=t),this.setConfig=function(e){var a=(e.webApiVersion||t.webApiVersion)!==t.webApiVersion;e.webApiVersion&&(r.stringParameterCheck(e.webApiVersion,"DynamicsWebApi.setConfig","config.webApiVersion"),t.webApiVersion=e.webApiVersion),e.webApiUrl?(r.stringParameterCheck(e.webApiUrl,"DynamicsWebApi.setConfig","config.webApiUrl"),t.webApiUrl=e.webApiUrl):t.webApiUrl&&!a||(t.webApiUrl=n.initWebApiUrl(t.webApiVersion)),e.impersonate&&(t.impersonate=r.guidParameterCheck(e.impersonate,"DynamicsWebApi.setConfig","config.impersonate")),e.impersonateAAD&&(t.impersonateAAD=r.guidParameterCheck(e.impersonateAAD,"DynamicsWebApi.setConfig","config.impersonateAAD")),e.onTokenRefresh&&(r.callbackParameterCheck(e.onTokenRefresh,"DynamicsWebApi.setConfig","config.onTokenRefresh"),t.onTokenRefresh=e.onTokenRefresh),e.includeAnnotations&&(r.stringParameterCheck(e.includeAnnotations,"DynamicsWebApi.setConfig","config.includeAnnotations"),t.includeAnnotations=e.includeAnnotations),e.maxPageSize&&(r.numberParameterCheck(e.maxPageSize,"DynamicsWebApi.setConfig","config.maxPageSize"),t.maxPageSize=e.maxPageSize),e.returnRepresentation&&(r.boolParameterCheck(e.returnRepresentation,"DynamicsWebApi.setConfig","config.returnRepresentation"),t.returnRepresentation=e.returnRepresentation),e.useEntityNames&&(r.boolParameterCheck(e.useEntityNames,"DynamicsWebApi.setConfig","config.useEntityNames"),t.useEntityNames=e.useEntityNames)},this.setConfig(e);var s=function(e,i,n,r,s,o){i.isBatch=a,c.makeRequest(e,i,n,t,o,r,s)};this.createRequest=function(e,t,i){r.parameterCheck(e,"DynamicsWebApi.create","request"),a||(r.callbackParameterCheck(t,"DynamicsWebApi.create","successCallback"),r.callbackParameterCheck(i,"DynamicsWebApi.create","errorCallback")),s("POST",e,"create",function(e){t(e.data)},i)},this.create=function(e,t,a,i,n,c){r.parameterCheck(e,"DynamicsWebApi.create","object"),r.stringParameterCheck(t,"DynamicsWebApi.create","collection"),n&&r.stringOrArrayParameterCheck(n,"DynamicsWebApi.create","prefer"),c&&r.arrayParameterCheck(c,"DynamicsWebApi.create","select");var s={collection:t,select:c,prefer:n,entity:e};this.createRequest(s,a,i)},this.updateRequest=function(e,t,i){r.parameterCheck(e,"DynamicsWebApi.update","request"),a||(r.callbackParameterCheck(t,"DynamicsWebApi.update","successCallback"),r.callbackParameterCheck(i,"DynamicsWebApi.update","errorCallback")),null==e.ifmatch&&(e.ifmatch="*");var n=function(e){t(e.data)},c=e.ifmatch,o=function(e){c&&412===e.status?t(!1):i(e)},l=/EntityDefinitions|RelationshipDefinitions|GlobalOptionSetDefinitions/.test(e.collection)?"PUT":"PATCH";s(l,e,"update",n,o,{valueIfEmpty:!0})},this.update=function(e,t,i,n,c,s,o){r.stringParameterCheck(e,"DynamicsWebApi.update","key"),e=r.keyParameterCheck(e,"DynamicsWebApi.update","key"),r.parameterCheck(i,"DynamicsWebApi.update","object"),r.stringParameterCheck(t,"DynamicsWebApi.update","collection"),a||(r.callbackParameterCheck(n,"DynamicsWebApi.update","successCallback"),r.callbackParameterCheck(c,"DynamicsWebApi.update","errorCallback")),s&&r.stringOrArrayParameterCheck(s,"DynamicsWebApi.update","prefer"),o&&r.arrayParameterCheck(o,"DynamicsWebApi.update","select");var l={collection:t,key:e,select:o,prefer:s,entity:i};this.updateRequest(l,n,c)},this.updateSingleProperty=function(e,t,i,n,c,o,l){r.stringParameterCheck(e,"DynamicsWebApi.updateSingleProperty","key"),e=r.keyParameterCheck(e,"DynamicsWebApi.updateSingleProperty","key"),r.parameterCheck(i,"DynamicsWebApi.updateSingleProperty","keyValuePair"),r.stringParameterCheck(t,"DynamicsWebApi.updateSingleProperty","collection"),a||(r.callbackParameterCheck(n,"DynamicsWebApi.updateSingleProperty","successCallback"),r.callbackParameterCheck(c,"DynamicsWebApi.updateSingleProperty","errorCallback")),o&&r.stringOrArrayParameterCheck(o,"DynamicsWebApi.updateSingleProperty","prefer"),l&&r.arrayParameterCheck(l,"DynamicsWebApi.updateSingleProperty","select");var u=Object.keys(i)[0],p=i[u];s("PUT",{collection:t,key:e,select:l,prefer:o,navigationProperty:u,data:{value:p}},"updateSingleProperty",function(e){n(e.data)},c)},this.deleteRequest=function(e,t,i){r.parameterCheck(e,"DynamicsWebApi.delete","request"),a||(r.callbackParameterCheck(t,"DynamicsWebApi.delete","successCallback"),r.callbackParameterCheck(i,"DynamicsWebApi.delete","errorCallback"));var n=function(e){t(e.data)},c=e.ifmatch;s("DELETE",e,"delete",n,function(e){c&&412===e.status?t(!1):i(e)},{valueIfEmpty:!0})},this.deleteRecord=function(e,t,i,n,c){r.stringParameterCheck(e,"DynamicsWebApi.delete","key"),e=r.keyParameterCheck(e,"DynamicsWebApi.delete","key"),r.stringParameterCheck(t,"DynamicsWebApi.delete","collection"),a||(r.callbackParameterCheck(i,"DynamicsWebApi.delete","successCallback"),r.callbackParameterCheck(n,"DynamicsWebApi.delete","errorCallback")),null!=c&&r.stringParameterCheck(c,"DynamicsWebApi.delete","propertyName"),s("DELETE",{key:e,collection:t,navigationProperty:c},"delete",function(e){i()},n)},this.retrieveRequest=function(e,t,i){r.parameterCheck(e,"DynamicsWebApi.retrieve","request"),a||(r.callbackParameterCheck(t,"DynamicsWebApi.retrieve","successCallback"),r.callbackParameterCheck(i,"DynamicsWebApi.retrieve","errorCallback"));var n=function(e){t(e.data)},c=null!=e.select&&1===e.select.length&&e.select[0].endsWith("/$ref");s("GET",e,"retrieve",n,i,{isRef:c})},this.retrieve=function(e,t,i,n,c,s){r.stringParameterCheck(e,"DynamicsWebApi.retrieve","key"),e=r.keyParameterCheck(e,"DynamicsWebApi.retrieve","key"),r.stringParameterCheck(t,"DynamicsWebApi.retrieve","collection"),a||(r.callbackParameterCheck(i,"DynamicsWebApi.retrieve","successCallback"),r.callbackParameterCheck(n,"DynamicsWebApi.retrieve","errorCallback")),c&&c.length&&r.arrayParameterCheck(c,"DynamicsWebApi.retrieve","select"),s&&s.length&&r.stringOrArrayParameterCheck(s,"DynamicsWebApi.retrieve","expand");var o={collection:t,key:e,select:c,expand:s};this.retrieveRequest(o,i,n)},this.upsertRequest=function(e,t,i){r.parameterCheck(e,"DynamicsWebApi.upsert","request"),r.parameterCheck(e.entity,"DynamicsWebApi.upsert","request.entity"),a||(r.callbackParameterCheck(t,"DynamicsWebApi.upsert","successCallback"),r.callbackParameterCheck(i,"DynamicsWebApi.upsert","errorCallback"));var n=e.ifnonematch,c=e.ifmatch;s("PATCH",e,"upsert",function(e){t(e.data)},function(e){n&&412===e.status?t():c&&404===e.status?t():i(e)})},this.upsert=function(e,t,i,n,c,s,o){r.stringParameterCheck(e,"DynamicsWebApi.upsert","key"),e=r.keyParameterCheck(e,"DynamicsWebApi.upsert","key"),r.parameterCheck(i,"DynamicsWebApi.upsert","object"),r.stringParameterCheck(t,"DynamicsWebApi.upsert","collection"),a||(r.callbackParameterCheck(n,"DynamicsWebApi.upsert","successCallback"),r.callbackParameterCheck(c,"DynamicsWebApi.upsert","errorCallback")),s&&r.stringOrArrayParameterCheck(s,"DynamicsWebApi.upsert","prefer"),o&&r.arrayParameterCheck(o,"DynamicsWebApi.upsert","select");var l={collection:t,key:e,select:o,prefer:s,entity:i};this.upsertRequest(l,n,c)},this.count=function(e,t,i,n){r.stringParameterCheck(e,"DynamicsWebApi.count","collection"),a||(r.callbackParameterCheck(t,"DynamicsWebApi.count","successCallback"),r.callbackParameterCheck(i,"DynamicsWebApi.count","errorCallback"));var c={collection:e};null==n||null!=n&&!n.length?c.navigationProperty="$count":(c.filter=n,c.count=!0),s("GET",c,"count",function(e){t(e.data)},i,{toCount:c.count})},this.countAll=function(e,t,i,n,c){r.batchIncompatible("DynamicsWebApi.countAll",a),this.retrieveAllRequest({collection:e,filter:n,select:c},function(e){t(e&&e.value?e.value.length:0)},i)},this.retrieveMultiple=function(e,t,a,i,n,r){this.retrieveMultipleRequest({collection:e,select:i,filter:n},t,a,r)},this.retrieveAll=function(e,t,i,n,c){r.batchIncompatible("DynamicsWebApi.retrieveAll",a),l({collection:e,select:n,filter:c},t,i)};var o=function(e,t,i,n){a||(r.callbackParameterCheck(t,"DynamicsWebApi.retrieveMultiple","successCallback"),r.callbackParameterCheck(i,"DynamicsWebApi.retrieveMultiple","errorCallback")),n&&(r.stringParameterCheck(n,"DynamicsWebApi.retrieveMultiple","oDataLink"),e.url=n),s("GET",e,"retrieveMultiple",function(e){t(e.data)},i)};this.retrieveMultipleRequest=o;var l=function(e,t,a,i,n){n=n||[],o(e,function(i){n=n.concat(i.value);var r=i.oDataNextLink;if(r)l(e,t,a,r,n);else{var c={value:n};i.oDataDeltaLink&&(c["@odata.deltaLink"]=i.oDataDeltaLink,c.oDataDeltaLink=i.oDataDeltaLink),t(c)}},a,i)};this.retrieveAllRequest=function(e,t,i){r.batchIncompatible("DynamicsWebApi.retrieveAllRequest",a),l(e,t,i)};var u=function(e,t,i,n,c,o,l,u){r.stringParameterCheck(e,"DynamicsWebApi.executeFetchXml","collection"),r.stringParameterCheck(t,"DynamicsWebApi.executeFetchXml","fetchXml"),a||(r.callbackParameterCheck(i,"DynamicsWebApi.executeFetchXml","successCallback"),r.callbackParameterCheck(n,"DynamicsWebApi.executeFetchXml","errorCallback")),o=o||1,r.numberParameterCheck(o,"DynamicsWebApi.executeFetchXml","pageNumber");var p='$1 page="'+o+'"';null!=l&&(r.stringParameterCheck(l,"DynamicsWebApi.executeFetchXml","pagingCookie"),p+=' paging-cookie="'+l+'"'),t=t.replace(/^(<fetch)/,p),s("GET",{collection:e,includeAnnotations:c,impersonate:u,fetchXml:t},"executeFetchXml",function(e){i(e.data)},n,{pageNumber:o})};this.fetch=u,this.executeFetchXml=u;var p=function(e,t,a,i,n,r,c,s,o){o=o||[],u(e,t,function(r){o=o.concat(r.value),r.PagingInfo?p(e,t,a,i,n,r.PagingInfo.nextPage,r.PagingInfo.cookie,s,o):a({value:o})},i,n,r,c,s)},m=function(e,t,i,n,c,s){r.batchIncompatible("DynamicsWebApi.executeFetchXmlAll",a),p(e,t,i,n,c,null,null,s)};this.fetchAll=m,this.executeFetchXmlAll=m,this.associate=function(e,t,i,n,c,o,l,u){r.stringParameterCheck(e,"DynamicsWebApi.associate","collection"),r.stringParameterCheck(n,"DynamicsWebApi.associate","relatedCollection"),r.stringParameterCheck(i,"DynamicsWebApi.associate","relationshipName"),t=r.keyParameterCheck(t,"DynamicsWebApi.associate","primaryKey"),c=r.keyParameterCheck(c,"DynamicsWebApi.associate","relatedKey"),a||(r.callbackParameterCheck(o,"DynamicsWebApi.associate","successCallback"),r.callbackParameterCheck(l,"DynamicsWebApi.associate","errorCallback")),s("POST",{_additionalUrl:i+"/$ref",collection:e,key:t,impersonate:u,data:{"@odata.id":n+"("+c+")"}},"associate",function(){o()},l)},this.disassociate=function(e,t,i,n,c,o,l){r.stringParameterCheck(e,"DynamicsWebApi.disassociate","collection"),r.stringParameterCheck(i,"DynamicsWebApi.disassociate","relationshipName"),t=r.keyParameterCheck(t,"DynamicsWebApi.disassociate","primaryKey"),n=r.keyParameterCheck(n,"DynamicsWebApi.disassociate","relatedKey"),a||(r.callbackParameterCheck(c,"DynamicsWebApi.disassociate","successCallback"),r.callbackParameterCheck(o,"DynamicsWebApi.disassociate","errorCallback")),s("DELETE",{_additionalUrl:i+"("+n+")/$ref",collection:e,key:t,impersonate:l},"disassociate",function(){c()},o)},this.associateSingleValued=function(e,t,i,n,c,o,l,u){r.stringParameterCheck(e,"DynamicsWebApi.associateSingleValued","collection"),t=r.keyParameterCheck(t,"DynamicsWebApi.associateSingleValued","key"),c=r.keyParameterCheck(c,"DynamicsWebApi.associateSingleValued","relatedKey"),r.stringParameterCheck(i,"DynamicsWebApi.associateSingleValued","singleValuedNavigationPropertyName"),r.stringParameterCheck(n,"DynamicsWebApi.associateSingleValued","relatedCollection"),a||(r.callbackParameterCheck(o,"DynamicsWebApi.associateSingleValued","successCallback"),r.callbackParameterCheck(l,"DynamicsWebApi.associateSingleValued","errorCallback")),s("PUT",{_additionalUrl:i+"/$ref",collection:e,key:t,impersonate:u,data:{"@odata.id":n+"("+c+")"}},"associateSingleValued",function(){o()},l)},this.disassociateSingleValued=function(e,t,i,n,c,o){r.stringParameterCheck(e,"DynamicsWebApi.disassociateSingleValued","collection"),t=r.keyParameterCheck(t,"DynamicsWebApi.disassociateSingleValued","key"),r.stringParameterCheck(i,"DynamicsWebApi.disassociateSingleValued","singleValuedNavigationPropertyName"),a||(r.callbackParameterCheck(n,"DynamicsWebApi.disassociateSingleValued","successCallback"),r.callbackParameterCheck(c,"DynamicsWebApi.disassociateSingleValued","errorCallback")),s("DELETE",{_additionalUrl:i+"/$ref",key:t,collection:e,impersonate:o},"disassociateSingleValued",function(){n()},c)},this.executeUnboundFunction=function(e,t,a,i,n){h(e,i,null,null,t,a,n,!0)},this.executeBoundFunction=function(e,t,a,i,n,r,c){h(a,r,t,e,i,n,c)};var h=function(e,t,i,c,o,l,u,p){r.stringParameterCheck(e,"DynamicsWebApi.executeFunction","functionName"),a||(r.callbackParameterCheck(o,"DynamicsWebApi.executeFunction","successCallback"),r.callbackParameterCheck(l,"DynamicsWebApi.executeFunction","errorCallback"));var m={_additionalUrl:e+n.buildFunctionParameters(t),_unboundRequest:p,key:c,collection:i,impersonate:u};s("GET",m,"executeFunction",function(e){o(e.data)},l)};this.executeUnboundAction=function(e,t,a,i,n){y(e,t,null,null,a,i,n,!0)},this.executeBoundAction=function(e,t,a,i,n,r,c){y(a,i,t,e,n,r,c)};var y=function(e,t,i,n,c,o,l,u){r.stringParameterCheck(e,"DynamicsWebApi.executeAction","actionName"),a||(r.callbackParameterCheck(c,"DynamicsWebApi.executeAction","successCallback"),r.callbackParameterCheck(o,"DynamicsWebApi.executeAction","errorCallback")),s("POST",{_additionalUrl:e,_unboundRequest:u,collection:i,key:n,impersonate:l,data:t},"executeAction",function(e){c(e.data)},o)};this.createEntity=function(e,t,a){r.parameterCheck(e,"DynamicsWebApi.createEntity","entityDefinition");var i={collection:"EntityDefinitions",entity:e};this.createRequest(i,t,a)},this.updateEntity=function(e,t,a,i){r.parameterCheck(e,"DynamicsWebApi.updateEntity","entityDefinition"),r.guidParameterCheck(e.MetadataId,"DynamicsWebApi.updateEntity","entityDefinition.MetadataId");var n={collection:"EntityDefinitions",mergeLabels:i,key:e.MetadataId,entity:e};this.updateRequest(n,t,a)},this.retrieveEntity=function(e,t,a,i,n){r.keyParameterCheck(e,"DynamicsWebApi.retrieveEntity","entityKey");var c={collection:"EntityDefinitions",key:e,select:i,expand:n};this.retrieveRequest(c,t,a)},this.retrieveEntities=function(e,t,a,i){var n={collection:"EntityDefinitions",select:a,filter:i};this.retrieveRequest(n,e,t)},this.createAttribute=function(e,t,a,i){r.keyParameterCheck(e,"DynamicsWebApi.createAttribute","entityKey"),r.parameterCheck(t,"DynamicsWebApi.createAttribute","attributeDefinition");var n={collection:"EntityDefinitions",key:e,entity:t,navigationProperty:"Attributes"};this.createRequest(n,a,i)},this.updateAttribute=function(e,t,a,i,n,c){r.keyParameterCheck(e,"DynamicsWebApi.updateAttribute","entityKey"),r.parameterCheck(t,"DynamicsWebApi.updateAttribute","attributeDefinition"),r.guidParameterCheck(t.MetadataId,"DynamicsWebApi.updateAttribute","attributeDefinition.MetadataId"),n&&r.stringParameterCheck(n,"DynamicsWebApi.updateAttribute","attributeType");var s={collection:"EntityDefinitions",key:e,entity:t,navigationProperty:"Attributes",navigationPropertyKey:t.MetadataId,mergeLabels:c,metadataAttributeType:n};this.updateRequest(s,a,i)},this.retrieveAttributes=function(e,t,a,i,n,c,s){r.keyParameterCheck(e,"DynamicsWebApi.retrieveAttributes","entityKey"),i&&r.stringParameterCheck(i,"DynamicsWebApi.retrieveAttributes","attributeType");var o={collection:"EntityDefinitions",key:e,navigationProperty:"Attributes",select:n,filter:c,expand:s,metadataAttributeType:i};this.retrieveRequest(o,t,a)},this.retrieveAttribute=function(e,t,a,i,n,c,s){r.keyParameterCheck(e,"DynamicsWebApi.retrieveAttribute","entityKey"),r.keyParameterCheck(t,"DynamicsWebApi.retrieveAttribute","attributeKey"),n&&r.stringParameterCheck(n,"DynamicsWebApi.retrieveAttribute","attributeType");var o={collection:"EntityDefinitions",key:e,navigationProperty:"Attributes",select:c,expand:s,metadataAttributeType:n,navigationPropertyKey:t};this.retrieveRequest(o,a,i)},this.createRelationship=function(e,t,a){r.parameterCheck(e,"DynamicsWebApi.createRelationship","relationshipDefinition");var i={collection:"RelationshipDefinitions",entity:e};this.createRequest(i,t,a)},this.updateRelationship=function(e,t,a,i,n){r.parameterCheck(e,"DynamicsWebApi.updateRelationship","relationshipDefinition"),r.guidParameterCheck(e.MetadataId,"DynamicsWebApi.updateRelationship","relationshipDefinition.MetadataId");var c={collection:"RelationshipDefinitions",mergeLabels:n,key:e.MetadataId,entity:e,navigationProperty:i};this.updateRequest(c,t,a)},this.deleteRelationship=function(e,t,a){r.keyParameterCheck(e,"DynamicsWebApi.deleteRelationship","metadataId");var i={collection:"RelationshipDefinitions",key:e};this.deleteRequest(i,t,a)},this.retrieveRelationships=function(e,t,a,i,n){var r={collection:"RelationshipDefinitions",navigationProperty:a,select:i,filter:n};this.retrieveMultipleRequest(r,e,t)},this.retrieveRelationship=function(e,t,a,i,n){r.keyParameterCheck(e,"DynamicsWebApi.retrieveRelationship","metadataId");var c={collection:"RelationshipDefinitions",navigationProperty:i,key:e,select:n};this.retrieveRequest(c,t,a)},this.createGlobalOptionSet=function(e,t,a){r.parameterCheck(e,"DynamicsWebApi.createGlobalOptionSet","globalOptionSetDefinition");var i={collection:"GlobalOptionSetDefinitions",entity:e};this.createRequest(i,t,a)},this.updateGlobalOptionSet=function(e,t,a,i){r.parameterCheck(e,"DynamicsWebApi.updateGlobalOptionSet","globalOptionSetDefinition"),r.guidParameterCheck(e.MetadataId,"DynamicsWebApi.updateGlobalOptionSet","globalOptionSetDefinition.MetadataId");var n={collection:"GlobalOptionSetDefinitions",mergeLabels:i,key:e.MetadataId,entity:e};this.updateRequest(n,t,a)},this.deleteGlobalOptionSet=function(e,t,a){r.keyParameterCheck(e,"DynamicsWebApi.deleteGlobalOptionSet","globalOptionSetKey");var i={collection:"GlobalOptionSetDefinitions",key:e};this.deleteRequest(i,t,a)},this.retrieveGlobalOptionSet=function(e,t,a,i,n){r.keyParameterCheck(e,"DynamicsWebApi.retrieveGlobalOptionSet","globalOptionSetKey");var c={collection:"GlobalOptionSetDefinitions",key:e,navigationProperty:i,select:n};this.retrieveRequest(c,t,a)},this.retrieveGlobalOptionSets=function(e,t,a,i){var n={collection:"GlobalOptionSetDefinitions",navigationProperty:a,select:i};this.retrieveMultipleRequest(n,e,t)},this.startBatch=function(){a=!0},this.executeBatch=function(e,t,i){i=i||{},r.batchNotStarted(a),r.callbackParameterCheck(e,"DynamicsWebApi.executeBatch","successCallback"),r.callbackParameterCheck(t,"DynamicsWebApi.executeBatch","errorCallback"),r.parameterCheck(i,"DynamicsWebApi.executeBatch","request"),a=!1;var n=function(t){e(t.data)};i.collection="$batch",s("POST",i,"executeBatch",n,t)},this.initializeInstance=function(e){return e||(e=t),new i(e)}}var n=(a(1),a(2)),r=(a(4),a(0)),c=a(5);String.prototype.endsWith&&String.prototype.startsWith||a(3),i.prototype.utility={getCollectionName:c.getCollectionName},e.exports=i},function(e,t){Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t){e.exports=function(e,t){var a;return"string"==typeof t&&(a=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:Z|[-+]\d{2}:\d{2})$/.exec(t))?new Date(Date.UTC(+a[1],+a[2]-1,+a[3],+a[4],+a[5],+a[6])):t}},function(e,t,a){function i(e,t){var a=null;if(-1!==e.indexOf("@")){var i=e.split("@");switch(i[1]){case"odata.context":a="oDataContext";break;case"odata.count":a="oDataCount",t=null!=t?parseInt(t):0;break;case"odata.nextLink":a="oDataNextLink";break;case"odata.deltaLink":a="oDataDeltaLink";break;case l.Prefer.Annotations.FormattedValue:a=i[0]+"_Formatted";break;case l.Prefer.Annotations.AssociatedNavigationProperty:a=i[0]+"_NavigationProperty";break;case l.Prefer.Annotations.LookupLogicalName:a=i[0]+"_LogicalName"}}return[a,t]}function n(e,t){if(t){if(t.isRef&&null!=e["@odata.id"])return u.convertToReferenceObject(e);if(t.toCount)return i("@odata.count",e["@odata.count"])[1]||0}for(var a=Object.keys(e),r=0;r<a.length;r++){var c=a[r];if(null!=e[c])if(e[c].constructor===Array)for(var s=0;s<e[c].length;s++)e[c][s]=n(e[c][s]);else"object"==typeof e[c]&&n(e[c]);var o=i(c,e[c]);if(o[0]&&(e[o[0]]=o[1]),-1!==c.indexOf("_x002e_")){var p=c.split("_x002e_");if(e.hasOwnProperty(p[0])){if("object"!=typeof e[p[0]]||"object"==typeof e[p[0]]&&!e[p[0]].hasOwnProperty("_dwaType"))throw new Error("The alias name of the linked entity must be unique!")}else e[p[0]]={_dwaType:"alias"};e[p[0]][p[1]]=e[c],o=i(p[1],e[c]),o[0]&&(e[p[0]][o[0]]=o[1])}}return t&&t.hasOwnProperty("pageNumber")&&null!=e["@"+l.Prefer.Annotations.FetchXmlPagingCookie]&&(e.PagingInfo=u.getFetchXmlPagingCookie(e["@"+l.Prefer.Annotations.FetchXmlPagingCookie],t.pageNumber)),e}function r(e){var t,a,i,n={},r={position:0};do{i=r.position,a=c(e,r),t=h.exec(a),null!==t?n[t[1].toLowerCase()]=t[2]:r.position=i}while(a&&t);return n}function c(e,t){return s(e,t,"\r\n")}function s(e,t,a){var i=t.position||0,n=e.length;if(a){if(-1===(n=e.indexOf(a,i)))return null;t.position=n+a.length}else t.position=n;return e.substring(i,n)}function o(e,t,a){var i=e.substr(0,e.indexOf("\r\n")),c=e.split(i);c.shift(),c.pop(),a=a||0;for(var s=[],l=0;l<c.length;l++){var u=c[l];if(u.indexOf("--changesetresponse_")>-1){u=u.trim();var h=u.substring(u.indexOf("\r\n")+1).trim();s=s.concat(o(h,t,a))}else{var y=/HTTP\/?\s*[\d.]*\s+(\d{3})\s+([\w\s]*)$/gm.exec(u),f=parseInt(y[1]),b=y[2].trim(),d=u.substring(u.indexOf("{"),u.lastIndexOf("}")+1);if(d){var k=n(JSON.parse(d,m),t[a]);if(f>=400){var g=r(u.substring(u.indexOf(y[0])+y[0].length+1,u.indexOf("{")));s.push(p.handleHttpError(k,{status:f,statusText:b,statusMessage:b,headers:g}))}else s.push(k)}else if(/Content-Type: text\/plain/i.test(u)){var A=/\w+$/gi.exec(u.trim()),C=A&&A.length?A[0]:void 0;s.push(isNaN(C)?C:parseInt(C))}else if(t.length&&t[a]&&t[a].hasOwnProperty("valueIfEmpty"))s.push(t[a].valueIfEmpty);else{var D=/OData-EntityId.+/i.exec(u);if(D&&D.length){var P=/([0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12})\)$/i.exec(D[0]);s.push(P?P[1]:void 0)}else s.push(void 0)}}a++}return s}var l=a(1),u=a(2),p=a(0),m=a(8);String.prototype.endsWith&&String.prototype.startsWith||a(3);var h=/^([^()<>@,;:\\"\/[\]?={} \t]+)\s?:\s?(.*)/;e.exports=function(e,t,a){var i=void 0;if(e.length)if(e.indexOf("--batchresponse_")>-1){var r=o(e,a);i=1===a.length&&a[0].convertedToBatch?r[0]:r}else i=n(JSON.parse(e,m),a[0]);else if(a.length&&a[0].hasOwnProperty("valueIfEmpty"))i=a[0].valueIfEmpty;else if(t["OData-EntityId"]||t["odata-entityid"]){var c=t["OData-EntityId"]?t["OData-EntityId"]:t["odata-entityid"],s=/([0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12})\)$/i.exec(c);s&&(i=s[1])}return a.length=0,i}},function(e,t){e.exports=function(e){var t={};if(!e)return t;for(var a=e.split("\r\n"),i=0,n=a.length;i<n;i++){var r=a[i],c=r.indexOf(": ");c>0&&(t[r.substring(0,c)]=r.substring(c+2))}return t}},function(e,t,a){var i=a(9),n=a(10),r=a(0);Array.isArray||a(7);var c=function(e){var t=e.method,a=e.uri,c=e.data,s=e.additionalHeaders,o=e.responseParams,l=e.successCallback,u=e.errorCallback,p=e.isAsync,m=new XMLHttpRequest;m.open(t,a,p);for(var h in s)m.setRequestHeader(h,s[h]);m.onreadystatechange=function(){if(4===m.readyState){switch(m.status){case 200:case 201:case 204:case 304:var e=n(m.getAllResponseHeaders()),t=i(m.responseText,e,o),a={data:t,headers:e,status:m.status};l(a);break;default:var c;try{var s=n(m.getAllResponseHeaders()),p=i(m.responseText,s,o);if(Array.isArray(p)){u(p);break}c=p.error}catch(e){c=m.response.length>0?{message:m.response}:{message:"Unexpected Error"}}u(r.handleHttpError(c,{status:m.status,statusText:m.statusText,headers:s}))}m=null,o.length=0}},e.timeout&&(m.timeout=e.timeout),m.onerror=function(){var e=n(m.getAllResponseHeaders());u(r.handleHttpError({status:m.status,statusText:m.statusText,message:m.responseText||"Network Error",headers:e})),o.length=0,m=null},m.ontimeout=function(){var e=n(m.getAllResponseHeaders());u(r.handleHttpError({status:m.status,statusText:m.statusText,message:m.responseText||"Request Timed Out",headers:e})),o.length=0,m=null},c?m.send(c):m.send()};e.exports=c},function(e,t){e.exports=function(e){if(e){for(var t=Object.keys(e),a="",i="",n=1;n<=t.length;n++){var r=t[n-1],c=e[r];null!==c&&("string"!=typeof c||c.startsWith("Microsoft.Dynamics.CRM")?"object"==typeof c&&(c=JSON.stringify(c)):c="'"+c+"'",n>1&&(a+=",",i+="&"),a+=r+"=@p"+n,i+="@p"+n+"="+c)}return"("+a+")?"+i}return"()"}},function(e,t,a){var i=a(1),n=a(0);e.exports=function(e,t,a){var r,c=e.returnRepresentation,s=e.includeAnnotations,o=e.maxPageSize,l=e.trackChanges;if(e.prefer&&e.prefer.length){n.stringOrArrayParameterCheck(e.prefer,"DynamicsWebApi."+t,"request.prefer"),r=e.prefer,"string"==typeof r&&(r=r.split(","));for(var u in r){var p=r[u].trim();p===i.Prefer.ReturnRepresentation?c=!0:p.indexOf("odata.include-annotations=")>-1?s=p.replace("odata.include-annotations=","").replace(/"/g,""):p.startsWith("odata.maxpagesize=")?o=p.replace("odata.maxpagesize=","").replace(/"/g,""):p.indexOf("odata.track-changes")>-1&&(l=!0)}}return r=[],a&&(null==c&&(c=a.returnRepresentation),s=s||a.includeAnnotations,o=o||a.maxPageSize),c&&(n.boolParameterCheck(c,"DynamicsWebApi."+t,"request.returnRepresentation"),r.push(i.Prefer.ReturnRepresentation)),s&&(n.stringParameterCheck(s,"DynamicsWebApi."+t,"request.includeAnnotations"),r.push('odata.include-annotations="'+s+'"')),o&&o>0&&(n.numberParameterCheck(o,"DynamicsWebApi."+t,"request.maxPageSize"),r.push("odata.maxpagesize="+o)),l&&(n.boolParameterCheck(l,"DynamicsWebApi."+t,"request.trackChanges"),r.push("odata.track-changes")),r.join(",")}},function(e,t){e.exports=function(e){var t=/\/(\w+)\(([0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12})/i.exec(e["@odata.id"]);return{id:t[2],collection:t[1],oDataContext:e["@odata.context"]}}},function(e,t){e.exports=function(e,t){e=e||"",t=t||1,e=unescape(unescape(e));var a=/pagingcookie="(<cookie page="(\d+)".+<\/cookie>)/.exec(e);if(null!=a){var i=parseInt(a[2]);return{cookie:a[1].replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"'").replace(/\'/g,"&quot;"),page:i,nextPage:i+1}}return{cookie:"",page:t,nextPage:t+1}}}])});