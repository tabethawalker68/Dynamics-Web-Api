/*! dynamics-web-api-callbacks v1.2.4 (c) 2017 Aleksandr Rogov */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.DynamicsWebApi=t():e.DynamicsWebApi=t()}(this,function(){return function(e){function t(r){if(a[r])return a[r].exports;var i=a[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var a={};return t.m=e,t.c=a,t.i=function(e){return e},t.d=function(e,a,r){t.o(e,a)||Object.defineProperty(e,a,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(a,"a",a),a},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=13)}([function(e,t){var a={Types:{ResponseBase:function(){this.oDataContext=""},Response:function(){a.Types.ResponseBase.call(this),this.value={}},ReferenceResponse:function(){a.Types.ResponseBase.call(this),this.id="",this.collection=""},MultipleResponse:function(){a.Types.ResponseBase.call(this),this.oDataNextLink="",this.oDataCount=0,this.value=[]},FetchXmlResponse:function(){a.Types.ResponseBase.call(this),this.value=[],this.PagingInfo={cookie:"",page:0,nextPage:1}}},Prefer:{ReturnRepresentation:"return=representation",Annotations:{AssociatedNavigationProperty:"Microsoft.Dynamics.CRM.associatednavigationproperty",LookupLogicalName:"Microsoft.Dynamics.CRM.lookuplogicalname",All:"*",FormattedValue:"OData.Community.Display.V1.FormattedValue",FetchXmlPagingCookie:"Microsoft.Dynamics.CRM.fetchxmlpagingcookie"}}};e.exports=a},function(e,t){function a(e,t,a){throw new Error(a?e+" requires the "+t+" parameter to be of type "+a:e+" requires the "+t+" parameter.")}var r={handleErrorResponse:function(e){throw new Error("Error: "+e.status+": "+e.message)},parameterCheck:function(e,t,r,i){void 0!==e&&null!==e&&""!=e||a(t,r,i)},stringParameterCheck:function(e,t,r){"string"!=typeof e&&a(t,r,"String")},arrayParameterCheck:function(e,t,r){e.constructor!==Array&&a(t,r,"Array")},stringOrArrayParameterCheck:function(e,t,r){e.constructor!==Array&&"string"!=typeof e&&a(t,r,"String or Array")},numberParameterCheck:function(e,t,r){if("number"!=typeof e){if("string"==typeof e&&e&&!isNaN(parseInt(e)))return;a(t,r,"Number")}},boolParameterCheck:function(e,t,r){"boolean"!=typeof e&&a(t,r,"Boolean")},guidParameterCheck:function(e,t,r){try{return/[0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12}/i.exec(e)[0]}catch(e){a(t,r,"GUID String")}},callbackParameterCheck:function(e,t,r){"function"!=typeof e&&a(t,r,"Function")}};e.exports=r},function(e,t){String.prototype.endsWith=function(e,t){var a=this.toString();("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>a.length)&&(t=a.length),t-=e.length;var r=a.lastIndexOf(e,t);return r!==-1&&r===t},String.prototype.startsWith=function(e,t){return t=t||0,this.substr(t,e.length)===e}},function(e,t,a){a(0);e.exports=function(e,t,r,i,n,c,s){r.impersonate&&(!n||n&&!n.MSCRMCallerID)&&(n||(n={}),n.MSCRMCallerID=r.impersonate);var o;i&&(o=JSON.stringify(i,function(e,t){return e.endsWith("@odata.bind")&&"string"==typeof t&&!t.startsWith(r.webApiUrl)&&(t=r.webApiUrl+t),t}));var l;"undefined"!=typeof XMLHttpRequest&&(l=a(8));var u=function(a){a&&(n||(n={}),n.Authorization="Bearer "+a.accessToken),l(e,r.webApiUrl+t,o,n,c,s)};r.onTokenRefresh&&(!n||n&&!n.Authorization)?r.onTokenRefresh(u):u()}},function(e,t,a){function r(e,t,a,i,s){var o={},l=[];if(i=null!=i?i:"&",e){e.navigationProperty&&(n.stringParameterCheck(e.navigationProperty,"DynamicsWebApi."+t,"request.navigationProperty"),a+="/"+e.navigationProperty),null!=e.select&&e.select.length&&(n.arrayParameterCheck(e.select,"DynamicsWebApi."+t,"request.select"),"retrieve"==t&&1==e.select.length&&e.select[0].endsWith("/$ref")?a+="/"+e.select[0]:(e.select[0].startsWith("/")&&"retrieve"==t&&(null==e.navigationProperty?a+=e.select.shift():e.select.shift()),e.select.length&&l.push("$select="+e.select.join(",")))),e.filter&&(n.stringParameterCheck(e.filter,"DynamicsWebApi."+t,"request.filter"),l.push("$filter="+e.filter)),e.savedQuery&&l.push("savedQuery="+n.guidParameterCheck(e.savedQuery,"DynamicsWebApi."+t,"request.savedQuery")),e.userQuery&&l.push("userQuery="+n.guidParameterCheck(e.userQuery,"DynamicsWebApi."+t,"request.userQuery")),e.count&&(n.boolParameterCheck(e.count,"DynamicsWebApi."+t,"request.count"),l.push("$count="+e.count)),e.top&&e.top>0&&(n.numberParameterCheck(e.top,"DynamicsWebApi."+t,"request.top"),l.push("$top="+e.top)),null!=e.orderBy&&e.orderBy.length&&(n.arrayParameterCheck(e.orderBy,"DynamicsWebApi."+t,"request.orderBy"),l.push("$orderby="+e.orderBy.join(",")));var u=c(e,t,s);if(u.length&&(o.Prefer=u),null!=e.ifmatch&&null!=e.ifnonematch)throw new Error("DynamicsWebApi."+t+". Either one of request.ifmatch or request.ifnonematch parameters should be used in a call, not both.");if(e.ifmatch&&(n.stringParameterCheck(e.ifmatch,"DynamicsWebApi."+t,"request.ifmatch"),o["If-Match"]=e.ifmatch),e.ifnonematch&&(n.stringParameterCheck(e.ifnonematch,"DynamicsWebApi."+t,"request.ifnonematch"),o["If-None-Match"]=e.ifnonematch),e.impersonate&&(n.stringParameterCheck(e.impersonate,"DynamicsWebApi."+t,"request.impersonate"),o.MSCRMCallerID=n.guidParameterCheck(e.impersonate,"DynamicsWebApi."+t,"request.impersonate")),e.token&&(n.stringParameterCheck(e.token,"DynamicsWebApi."+t,"request.token"),o.Authorization="Bearer "+e.token),e.expand&&e.expand.length)if(n.stringOrArrayParameterCheck(e.expand,"DynamicsWebApi."+t,"request.expand"),"string"==typeof e.expand)l.push("$expand="+encodeURI(e.expand));else{for(var p=[],m=0;m<e.expand.length;m++)if(e.expand[m].property){var h=r(e.expand[m],t+" $expand",null,";"),d=h.query;d&&d.length&&(d="("+d+")"),p.push(e.expand[m].property+d)}p.length&&l.push("$expand="+encodeURI(p.join(",")))}}return{url:a,query:l.join(i),headers:o}}function i(e,t,a){e.collection?n.stringParameterCheck(e.collection,"DynamicsWebApi."+t,"request.collection"):n.parameterCheck(e.collection,"DynamicsWebApi."+t,"request.collection");var i=e.collection.toLowerCase();e.id&&(e.id=n.guidParameterCheck(e.id,"DynamicsWebApi."+t,"request.id"),i+="("+e.id+")");var c=r(e,t,i,"&",a);return c.query&&(c.url+="?"+encodeURI(c.query)),{url:c.url,headers:c.headers}}var n=(a(0),a(1)),c=a(10),s={convertRequestOptions:r,convertRequest:i};e.exports=s},function(e,t,a){var r={buildFunctionParameters:a(9),getFetchXmlPagingCookie:a(12),convertToReferenceObject:a(11)};e.exports=r},function(e,t){e.exports=function(e,t){return"string"==typeof t&&/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}Z$/.exec(t)?new Date(t):t}},function(e,t){e.exports=function(e){var t={};if(!e)return t;for(var a=e.split("\r\n"),r=0,i=a.length;r<i;r++){var n=a[r],c=n.indexOf(": ");c>0&&(t[n.substring(0,c)]=n.substring(c+2))}return t}},function(e,t,a){var r=a(6),i=a(7),n=function(e,t,a,n,c,s){var o=new XMLHttpRequest;if(o.open(e,t,!0),o.setRequestHeader("OData-MaxVersion","4.0"),o.setRequestHeader("OData-Version","4.0"),o.setRequestHeader("Accept","application/json"),o.setRequestHeader("Content-Type","application/json; charset=utf-8"),null!=n)for(var l in n)o.setRequestHeader(l,n[l]);o.onreadystatechange=function(){if(4===o.readyState){switch(o.status){case 200:case 201:case 204:case 304:var e=null;o.responseText&&(e=JSON.parse(o.responseText,r));c({data:e,headers:i(o.getAllResponseHeaders()),status:o.status});break;default:var t;try{t=JSON.parse(o.response).error}catch(e){t=o.response.length>0?{message:o.response}:{message:"Unexpected Error"}}t.status=o.status,s(t)}o=null}},o.onerror=function(){s({message:"Network Error"}),o=null},o.ontimeout=function(e){s({message:"Request Timed Out"}),o=null},a?o.send(a):o.send()};e.exports=n},function(e,t){e.exports=function(e){if(e){for(var t=Object.keys(e),a="",r="",i=1;i<=t.length;i++){var n=t[i-1],c=e[n];i>1&&(a+=",",r+="&"),a+=n+"=@p"+i,r+="@p"+i+"="+("string"==typeof c?"'"+c+"'":c)}return"("+a+")?"+r}return"()"}},function(e,t,a){var r=a(0),i=a(1);e.exports=function(e,t,a){var n=e.returnRepresentation,c=e.includeAnnotations,s=e.maxPageSize;if(e.prefer&&e.prefer.length){i.stringOrArrayParameterCheck(e.prefer,"DynamicsWebApi."+t,"request.prefer");var o=e.prefer;"string"==typeof o&&(o=o.split(","));for(var l in o){var u=o[l].trim();u===r.Prefer.ReturnRepresentation?n=!0:u.startsWith("odata.include-annotations=")?c=u.replace("odata.include-annotations=","").replace(/"/g,""):u.startsWith("odata.maxpagesize=")&&(s=u.replace("odata.maxpagesize=","").replace(/"/g,""))}}a&&(null==n&&(n=a.returnRepresentation),c=c?c:a.includeAnnotations,s=s?s:a.maxPageSize);var o=[];return n&&(i.boolParameterCheck(n,"DynamicsWebApi."+t,"request.returnRepresentation"),o.push(r.Prefer.ReturnRepresentation)),c&&(i.stringParameterCheck(c,"DynamicsWebApi."+t,"request.includeAnnotations"),o.push('odata.include-annotations="'+c+'"')),s&&s>0&&(i.numberParameterCheck(s,"DynamicsWebApi."+t,"request.maxPageSize"),o.push("odata.maxpagesize="+s)),o.join(",")}},function(e,t){e.exports=function(e){var t=/\/(\w+)\(([0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12})/i.exec(e["@odata.id"]);return{id:t[2],collection:t[1],oDataContext:e["@odata.context"]}}},function(e,t){e.exports=function(e,t){e=e?e:"",t=t?t:1,e=unescape(unescape(e));var a=/pagingcookie="(<cookie page="(\d+)".+<\/cookie>)/.exec(e);if(null!=a){var r=parseInt(a[2]);return{cookie:a[1].replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"'").replace(/\'/g,"&quot;"),page:r,nextPage:r+1}}return{cookie:"",page:t,nextPage:t+1}}},function(e,t,a){function r(e){var t={webApiVersion:"8.0",webApiUrl:"",impersonate:null,onTokenRefresh:null,includeAnnotations:null,maxPageSize:null,returnRepresentation:null};e||(e=t);var a=function(){if("undefined"!=typeof GetGlobalContext)return GetGlobalContext();if("undefined"!=typeof Xrm)return Xrm.Page.context;throw new Error("Xrm Context is not available.")},o=function(){var e=a();if(e){var t=e.getClientUrl();return t.match(/\/$/)&&(t=t.substring(0,t.length-1)),t}return""},l=function(){return o()+"/api/data/v"+t.webApiVersion+"/"};this.setConfig=function(e){e.webApiVersion&&(c.stringParameterCheck(e.webApiVersion,"DynamicsWebApi.setConfig","config.webApiVersion"),t.webApiVersion=e.webApiVersion),e.webApiUrl?(c.stringParameterCheck(e.webApiUrl,"DynamicsWebApi.setConfig","config.webApiUrl"),t.webApiUrl=e.webApiUrl):t.webApiUrl=l(),e.impersonate&&(t.impersonate=c.guidParameterCheck(e.impersonate,"DynamicsWebApi.setConfig","config.impersonate")),e.onTokenRefresh&&(c.callbackParameterCheck(e.onTokenRefresh,"DynamicsWebApi.setConfig","config.onTokenRefresh"),t.onTokenRefresh=e.onTokenRefresh),e.includeAnnotations&&(c.stringParameterCheck(e.includeAnnotations,"DynamicsWebApi.setConfig","config.includeAnnotations"),t.includeAnnotations=e.includeAnnotations),e.maxPageSize&&(c.numberParameterCheck(e.maxPageSize,"DynamicsWebApi.setConfig","config.maxPageSize"),t.maxPageSize=e.maxPageSize),e.returnRepresentation&&(c.boolParameterCheck(e.returnRepresentation,"DynamicsWebApi.setConfig","config.returnRepresentation"),t.returnRepresentation=e.returnRepresentation)},this.setConfig(e);var u=function(e,a,r,i,n,c){s(e,a,t,r,i,n,c)};this.create=function(e,a,r,i,s,o){c.parameterCheck(e,"DynamicsWebApi.create","object"),c.stringParameterCheck(a,"DynamicsWebApi.create","collection"),c.callbackParameterCheck(r,"DynamicsWebApi.create","successCallback"),c.callbackParameterCheck(i,"DynamicsWebApi.create","errorCallback"),s&&c.stringOrArrayParameterCheck(s,"DynamicsWebApi.create","prefer"),o&&c.arrayParameterCheck(o,"DynamicsWebApi.create","select");var l={collection:a,select:o,prefer:s},p=n.convertRequest(l,"create",t),m=function(e){if(e.data)r(e.data);else{var t=e.headers["OData-EntityId"]?e.headers["OData-EntityId"]:e.headers["odata-entityid"];r(/[0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12}/i.exec(t)[0])}};u("POST",p.url,e,p.headers,m,i)},this.updateRequest=function(e,a,r){c.parameterCheck(e,"DynamicsWebApi.update","request"),c.parameterCheck(e.entity,"DynamicsWebApi.update","request.entity"),c.callbackParameterCheck(a,"DynamicsWebApi.update","successCallback"),c.callbackParameterCheck(r,"DynamicsWebApi.update","errorCallback");var i=n.convertRequest(e,"update",t);null==e.ifmatch&&(i.headers["If-Match"]="*");var s=function(e){a(e.data?e.data:!0)},o=e.ifmatch,l=function(e){o&&412==e.status?a(!1):r(e)};u("PATCH",i.url,e.entity,i.headers,s,l)},this.update=function(e,t,a,r,i,n,s){c.stringParameterCheck(e,"DynamicsWebApi.update","id"),e=c.guidParameterCheck(e,"DynamicsWebApi.update","id"),c.parameterCheck(a,"DynamicsWebApi.update","object"),c.stringParameterCheck(t,"DynamicsWebApi.update","collection"),c.callbackParameterCheck(r,"DynamicsWebApi.update","successCallback"),c.callbackParameterCheck(i,"DynamicsWebApi.update","errorCallback"),n&&c.stringOrArrayParameterCheck(n,"DynamicsWebApi.update","prefer"),s&&c.arrayParameterCheck(s,"DynamicsWebApi.update","select");var o={collection:t,id:e,select:s,prefer:n,entity:a};this.updateRequest(o,r,i)},this.updateSingleProperty=function(e,a,r,i,s,o,l){c.stringParameterCheck(e,"DynamicsWebApi.updateSingleProperty","id"),e=c.guidParameterCheck(e,"DynamicsWebApi.updateSingleProperty","id"),c.parameterCheck(r,"DynamicsWebApi.updateSingleProperty","keyValuePair"),c.stringParameterCheck(a,"DynamicsWebApi.updateSingleProperty","collection"),c.callbackParameterCheck(i,"DynamicsWebApi.updateSingleProperty","successCallback"),c.callbackParameterCheck(s,"DynamicsWebApi.updateSingleProperty","errorCallback"),o&&c.stringOrArrayParameterCheck(o,"DynamicsWebApi.updateSingleProperty","prefer"),l&&c.arrayParameterCheck(l,"DynamicsWebApi.updateSingleProperty","select");var p=Object.keys(r)[0],m=r[p],h={collection:a,id:e,select:l,prefer:o,navigationProperty:p},d=n.convertRequest(h,"updateSingleProperty",t),b=function(e){e.data?i(e.data):i()};u("PUT",d.url,{value:m},d.headers,b,s)},this.deleteRequest=function(e,a,r){c.parameterCheck(e,"DynamicsWebApi.delete","request"),c.callbackParameterCheck(a,"DynamicsWebApi.delete","successCallback"),c.callbackParameterCheck(r,"DynamicsWebApi.delete","errorCallback");var i=n.convertRequest(e,"delete",t),s=function(){a(!0)},o=e.ifmatch,l=function(e){o&&412==e.status?a(!1):r(e)};u("DELETE",i.url,null,i.headers,s,l)},this.deleteRecord=function(e,t,a,r,i){c.stringParameterCheck(e,"DynamicsWebApi.delete","id"),e=c.guidParameterCheck(e,"DynamicsWebApi.delete","id"),c.stringParameterCheck(t,"DynamicsWebApi.delete","collection"),c.callbackParameterCheck(a,"DynamicsWebApi.delete","successCallback"),c.callbackParameterCheck(r,"DynamicsWebApi.delete","errorCallback"),null!=i&&c.stringParameterCheck(i,"DynamicsWebApi.delete","propertyName");var n=t.toLowerCase()+"("+e+")";null!=i&&(n+="/"+i),u("DELETE",n,null,null,function(e){a()},r)},this.retrieveRequest=function(e,a,r){c.parameterCheck(e,"DynamicsWebApi.retrieve","request"),c.callbackParameterCheck(a,"DynamicsWebApi.retrieve","successCallback"),c.callbackParameterCheck(r,"DynamicsWebApi.retrieve","errorCallback");var s=n.convertRequest(e,"retrieve",t),o=e.select,l=function(e){a(null!=o&&1==o.length&&o[0].endsWith("/$ref")&&null!=e.data["@odata.id"]?i.convertToReferenceObject(e.data):e.data)};u("GET",s.url,null,s.headers,l,r)},this.retrieve=function(e,t,a,r,i,n){c.stringParameterCheck(e,"DynamicsWebApi.retrieve","id"),e=c.guidParameterCheck(e,"DynamicsWebApi.retrieve","id"),c.stringParameterCheck(t,"DynamicsWebApi.retrieve","collection"),c.callbackParameterCheck(a,"DynamicsWebApi.retrieve","successCallback"),c.callbackParameterCheck(r,"DynamicsWebApi.retrieve","errorCallback"),i&&i.length&&c.arrayParameterCheck(i,"DynamicsWebApi.retrieve","select"),n&&n.length&&c.stringOrArrayParameterCheck(n,"DynamicsWebApi.retrieve","expand");var s={collection:t,id:e,select:i,expand:n};this.retrieveRequest(s,a,r)},this.upsertRequest=function(e,a,r){c.parameterCheck(e,"DynamicsWebApi.upsert","request"),c.parameterCheck(e.entity,"DynamicsWebApi.upsert","request.entity"),c.callbackParameterCheck(a,"DynamicsWebApi.upsert","successCallback"),c.callbackParameterCheck(r,"DynamicsWebApi.upsert","errorCallback");var i=n.convertRequest(e,"upsert",t),s=e.ifnonematch,o=e.ifmatch,l=function(e){if(e.headers["OData-EntityId"]||e.headers["odata-entityid"]){var t=e.headers["OData-EntityId"]?e.headers["OData-EntityId"]:e.headers["odata-entityid"];a(/[0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12}/i.exec(t)[0])}else e.data?a(e.data):a()},p=function(e){s&&412==e.status?a():o&&404==e.status?a():r(e)};u("PATCH",i.url,e.entity,i.headers,l,p)},this.upsert=function(e,t,a,r,i,n,s){c.stringParameterCheck(e,"DynamicsWebApi.upsert","id"),e=c.guidParameterCheck(e,"DynamicsWebApi.upsert","id"),c.parameterCheck(a,"DynamicsWebApi.upsert","object"),c.stringParameterCheck(t,"DynamicsWebApi.upsert","collection"),c.callbackParameterCheck(r,"DynamicsWebApi.upsert","successCallback"),c.callbackParameterCheck(i,"DynamicsWebApi.upsert","errorCallback"),n&&c.stringOrArrayParameterCheck(n,"DynamicsWebApi.upsert","prefer"),s&&c.arrayParameterCheck(s,"DynamicsWebApi.upsert","select");var o={collection:t,id:e,select:s,prefer:n,entity:a};this.upsertRequest(o,r,i)},this.count=function(e,t,a,r){if(null!=r&&(null==r||r.length))return this.retrieveMultipleRequest({collection:e,filter:r,count:!0},function(e){t(e.oDataCount?e.oDataCount:0)},a);c.stringParameterCheck(e,"DynamicsWebApi.count","collection"),c.callbackParameterCheck(t,"DynamicsWebApi.count","successCallback"),c.callbackParameterCheck(a,"DynamicsWebApi.count","errorCallback");var i=function(e){t(e.data?parseInt(e.data):0)};u("GET",e.toLowerCase()+"/$count",null,null,i,a)},this.countAll=function(e,t,a,r,i){return this.retrieveAllRequest({collection:e,filter:r,select:i},function(e){t(e&&e.value?e.value.length:0)},a)},this.retrieveMultiple=function(e,t,a,r,i,n){return this.retrieveMultipleRequest({collection:e,select:r,filter:i},t,a,n)};var p=function(e,a,r,i){c.callbackParameterCheck(a,"DynamicsWebApi.retrieveMultiple","successCallback"),c.callbackParameterCheck(r,"DynamicsWebApi.retrieveMultiple","errorCallback"),i&&!e.collection&&(e.collection="any");var s=n.convertRequest(e,"retrieveMultiple",t);i&&(c.stringParameterCheck(i,"DynamicsWebApi.retrieveMultiple","nextPageLink"),s.url=i.replace(t.webApiUrl,""));var o=e.count,l=function(e){null!=e.data["@odata.nextLink"]&&(e.data.oDataNextLink=e.data["@odata.nextLink"]),o&&(e.data.oDataCount=null!=e.data["@odata.count"]?parseInt(e.data["@odata.count"]):0),null!=e.data["@odata.context"]&&(e.data.oDataContext=e.data["@odata.context"]),a(e.data)};u("GET",s.url,null,s.headers,l,r)};this.retrieveMultipleRequest=p;var m=function(e,t,a,r,i){var i=i||[];p(e,function(r){i=i.concat(r.value),r.oDataNextLink?m(e,t,a,r.oDataNextLink,i):t({value:i})},a,r)};this.retrieveAllRequest=function(e,t,a){m(e,t,a)},this.executeFetchXml=function(e,a,r,s,o,l,p,m){c.stringParameterCheck(e,"DynamicsWebApi.executeFetchXml","collection"),c.stringParameterCheck(a,"DynamicsWebApi.executeFetchXml","fetchXml"),c.callbackParameterCheck(r,"DynamicsWebApi.executeFetchXml","successCallback"),c.callbackParameterCheck(s,"DynamicsWebApi.executeFetchXml","errorCallback"),null==l&&(l=1),c.numberParameterCheck(l,"DynamicsWebApi.executeFetchXml","pageNumber");var h='$1 page="'+l+'"';null!=p&&(c.stringParameterCheck(p,"DynamicsWebApi.executeFetchXml","pagingCookie"),h+=' paging-cookie="'+p+'"'),a=a.replace(/^(<fetch[\w\d\s'"=]+)/,h),o&&c.stringParameterCheck(o,"DynamicsWebApi.executeFetchXml","includeAnnotations"),m&&(m=c.guidParameterCheck(m,"DynamicsWebApi.executeFetchXml","impersonateUserId"));var d={collection:e,includeAnnotations:o,impersonate:m},b=n.convertRequest(d,"executeFetchXml",t),y=encodeURIComponent(a),f=function(e){null!=e.data["@Microsoft.Dynamics.CRM.fetchxmlpagingcookie"]&&(e.data.PagingInfo=i.getFetchXmlPagingCookie(e.data["@Microsoft.Dynamics.CRM.fetchxmlpagingcookie"],l)),null!=e.data["@odata.context"]&&(e.data.oDataContext=e.data["@odata.context"]),r(e.data)};u("GET",b.url+"?fetchXml="+y,null,b.headers,f,s)},this.associate=function(e,a,r,i,n,s,o,l){c.stringParameterCheck(e,"DynamicsWebApi.associate","primarycollection"),c.stringParameterCheck(i,"DynamicsWebApi.associate","relatedcollection"),c.stringParameterCheck(r,"DynamicsWebApi.associate","relationshipName"),a=c.guidParameterCheck(a,"DynamicsWebApi.associate","primaryId"),n=c.guidParameterCheck(n,"DynamicsWebApi.associate","relatedId"),c.callbackParameterCheck(s,"DynamicsWebApi.associate","successCallback"),c.callbackParameterCheck(o,"DynamicsWebApi.associate","errorCallback");var p=function(){s()},m={};null!=l&&(l=c.guidParameterCheck(l,"DynamicsWebApi.associate","impersonateUserId"),m.MSCRMCallerID=l),u("POST",e+"("+a+")/"+r+"/$ref",{"@odata.id":t.webApiUrl+i+"("+n+")"},m,p,o)},this.disassociate=function(e,t,a,r,i,n,s){c.stringParameterCheck(e,"DynamicsWebApi.disassociate","primarycollection"),c.stringParameterCheck(a,"DynamicsWebApi.disassociate","relationshipName"),t=c.guidParameterCheck(t,"DynamicsWebApi.disassociate","primaryId"),r=c.guidParameterCheck(r,"DynamicsWebApi.disassociate","relatedId"),c.callbackParameterCheck(i,"DynamicsWebApi.disassociate","successCallback"),c.callbackParameterCheck(n,"DynamicsWebApi.disassociate","errorCallback");var o=function(){i()},l={};null!=s&&(s=c.guidParameterCheck(s,"DynamicsWebApi.associate","impersonateUserId"),l.MSCRMCallerID=s),u("DELETE",e+"("+t+")/"+a+"("+r+")/$ref",null,l,o,n)},this.associateSingleValued=function(e,a,r,i,n,s,o,l){c.stringParameterCheck(e,"DynamicsWebApi.associateSingleValued","collection"),a=c.guidParameterCheck(a,"DynamicsWebApi.associateSingleValued","id"),n=c.guidParameterCheck(n,"DynamicsWebApi.associateSingleValued","relatedId"),c.stringParameterCheck(r,"DynamicsWebApi.associateSingleValued","singleValuedNavigationPropertyName"),c.stringParameterCheck(i,"DynamicsWebApi.associateSingleValued","relatedcollection"),c.callbackParameterCheck(s,"DynamicsWebApi.associateSingleValued","successCallback"),c.callbackParameterCheck(o,"DynamicsWebApi.associateSingleValued","errorCallback");var p=function(){s()},m={};null!=l&&(l=c.guidParameterCheck(l,"DynamicsWebApi.associate","impersonateUserId"),m.MSCRMCallerID=l),u("PUT",e+"("+a+")/"+r+"/$ref",{"@odata.id":t.webApiUrl+i+"("+n+")"},m,p,o)},this.disassociateSingleValued=function(e,t,a,r,i,n){c.stringParameterCheck(e,"DynamicsWebApi.disassociateSingleValued","collection"),t=c.guidParameterCheck(t,"DynamicsWebApi.disassociateSingleValued","id"),c.stringParameterCheck(a,"DynamicsWebApi.disassociateSingleValued","singleValuedNavigationPropertyName"),c.callbackParameterCheck(r,"DynamicsWebApi.disassociateSingleValued","successCallback"),c.callbackParameterCheck(i,"DynamicsWebApi.disassociateSingleValued","errorCallback");var s={};null!=n&&(n=c.guidParameterCheck(n,"DynamicsWebApi.associate","impersonateUserId"),s.MSCRMCallerID=n),u("DELETE",e+"("+t+")/"+a+"/$ref",null,s,function(){r()},i)},this.executeUnboundFunction=function(e,t,a,r,i){return h(e,r,null,null,t,a,i)},this.executeBoundFunction=function(e,t,a,r,i,n,c){return h(a,n,t,e,r,i,c)};var h=function(e,t,a,r,n,s,o){c.stringParameterCheck(e,"DynamicsWebApi.executeFunction","functionName"),c.callbackParameterCheck(n,"DynamicsWebApi.executeFunction","successCallback"),c.callbackParameterCheck(s,"DynamicsWebApi.executeFunction","errorCallback");var l=e+i.buildFunctionParameters(t);null!=a&&(c.stringParameterCheck(a,"DynamicsWebApi.executeFunction","collection"),r=c.guidParameterCheck(r,"DynamicsWebApi.executeFunction","id"),l=a+"("+r+")/"+l);var p={};null!=o&&(p.MSCRMCallerID=c.guidParameterCheck(o,"DynamicsWebApi.associate","impersonateUserId")),u("GET",l,null,p,function(e){e.data?n(e.data):n()},s)};this.executeUnboundAction=function(e,t,a,r,i){return d(e,t,null,null,a,r,i)},this.executeBoundAction=function(e,t,a,r,i,n,c){return d(a,r,t,e,i,n,c)};var d=function(e,t,a,r,i,n,s){c.stringParameterCheck(e,"DynamicsWebApi.executeAction","actionName"),c.callbackParameterCheck(i,"DynamicsWebApi.executeAction","successCallback"),c.callbackParameterCheck(n,"DynamicsWebApi.executeAction","errorCallback");var o=e;null!=a&&(c.stringParameterCheck(a,"DynamicsWebApi.executeAction","collection"),r=c.guidParameterCheck(r,"DynamicsWebApi.executeAction","id"),o=a+"("+r+")/"+o);var l={};null!=s&&(s=c.guidParameterCheck(s,"DynamicsWebApi.associate","impersonateUserId"),l.MSCRMCallerID=s),u("POST",o,t,l,function(e){e.data?i(e.data):i()},n)};this.initializeInstance=function(e){return e||(e=t),new r(e)}}var i=(a(0),a(5)),n=a(4),c=a(1),s=a(3);String.prototype.endsWith&&String.prototype.startsWith||a(2),e.exports=r}])});